!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Halicarnassus=e():t.Halicarnassus=e()}(this,function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=7)}([function(t,e,i){"use strict";i.r(e),function(t){i.d(e,"flush",function(){return s}),i.d(e,"hydrate",function(){return a}),i.d(e,"cx",function(){return c}),i.d(e,"merge",function(){return h}),i.d(e,"getRegisteredStyles",function(){return l}),i.d(e,"injectGlobal",function(){return u}),i.d(e,"keyframes",function(){return _}),i.d(e,"css",function(){return d}),i.d(e,"sheet",function(){return p}),i.d(e,"caches",function(){return f});var n=i(6),r=void 0!==t?t:{},o=Object(n.a)(r),s=o.flush,a=o.hydrate,c=o.cx,h=o.merge,l=o.getRegisteredStyles,u=o.injectGlobal,_=o.keyframes,d=o.css,p=o.sheet,f=o.caches}.call(this,i(15))},function(t,e,i){"use strict";t.exports=i(8)},function(t,e,i){"use strict";e.a=function(t){var e={};return function(i){return void 0===e[i]&&(e[i]=t(i)),e[i]}}},function(t,e,i){"use strict";i.r(e);var n=i(1),r=i.n(n),o=i(0),s=i(5),a=i.n(s),c=i(2),h=Object(c.a)(RegExp.prototype.test.bind(/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|accept|acceptCharset|accessKey|action|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|default|defer|dir|disabled|download|draggable|encType|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|itemProp|itemScope|itemType|itemID|itemRef|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class)|(on[A-Z].*)|((data|aria)-.*))$/i));var l,u="__EMOTION_THEMING__",_=((l={})[u]=a.a.object,l);var d=h,p=function(t){return"theme"!==t&&"innerRef"!==t},f=function(){return!0},g=function(t,e){for(var i=2,n=arguments.length;i<n;i++){var r=arguments[i],o=void 0;for(o in r)t(o)&&(e[o]=r[o])}return e};var v=function(t,e){var i=function(n,r){var o,s,a,c;void 0!==r&&(o=r.e,s=r.label,a=r.target,c=n.__emotion_forwardProp&&r.shouldForwardProp?function(t){return n.__emotion_forwardProp(t)&&r.shouldForwardProp(t)}:r.shouldForwardProp);var h=n.__emotion_real===n,l=void 0===o&&h&&n.__emotion_base||n;return"function"!=typeof c&&(c="string"==typeof l&&l.charAt(0)===l.charAt(0).toLowerCase()?d:p),function(){var d=arguments,p=h&&void 0!==n.__emotion_styles?n.__emotion_styles.slice(0):[];if(void 0!==s&&p.push("label:"+s+";"),void 0===o)if(null==d[0]||void 0===d[0].raw)p.push.apply(p,d);else{p.push(d[0][0]);for(var v=d.length,m=1;m<v;m++)p.push(d[m],d[0][m])}var y=function(i){function n(){return i.apply(this,arguments)||this}!function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}(n,i);var r=n.prototype;return r.componentWillMount=function(){void 0!==this.context[u]&&(this.unsubscribe=this.context[u].subscribe(function(t){this.setState({theme:t})}.bind(this)))},r.componentWillUnmount=function(){void 0!==this.unsubscribe&&this.context[u].unsubscribe(this.unsubscribe)},r.render=function(){var i=this.props,n=this.state;this.mergedProps=g(f,{},i,{theme:null!==n&&n.theme||i.theme||{}});var r="",s=[];return i.className&&(r+=void 0===o?t.getRegisteredStyles(s,i.className):i.className+" "),r+=void 0===o?t.css.apply(this,p.concat(s)):o,void 0!==a&&(r+=" "+a),e.createElement(l,g(c,{},i,{className:r,ref:i.innerRef}))},n}(e.Component);return y.displayName=void 0!==s?s:"Styled("+("string"==typeof l?l:l.displayName||l.name||"Component")+")",void 0!==n.defaultProps&&(y.defaultProps=n.defaultProps),y.contextTypes=_,y.__emotion_styles=p,y.__emotion_base=l,y.__emotion_real=y,y.__emotion_forwardProp=c,Object.defineProperty(y,"toString",{enumerable:!1,value:function(){return"."+a}}),y.withComponent=function(t,e){return i(t,void 0!==e?g(f,{},r,e):r).apply(void 0,p)},y}};return i};i.d(e,"flush",function(){return o.flush}),i.d(e,"hydrate",function(){return o.hydrate}),i.d(e,"cx",function(){return o.cx}),i.d(e,"merge",function(){return o.merge}),i.d(e,"getRegisteredStyles",function(){return o.getRegisteredStyles}),i.d(e,"injectGlobal",function(){return o.injectGlobal}),i.d(e,"keyframes",function(){return o.keyframes}),i.d(e,"css",function(){return o.css}),i.d(e,"sheet",function(){return o.sheet}),i.d(e,"caches",function(){return o.caches});var m=v(o,r.a);e.default=m},function(t,e,i){t.exports=function(){"use strict";return function(t){function e(e){if(e)try{t(e+"}")}catch(t){}}return function(i,n,r,o,s,a,c,h,l,u){switch(i){case 1:if(0===l&&64===n.charCodeAt(0))return t(n+";"),"";break;case 2:if(0===h)return n+"/*|*/";break;case 3:switch(h){case 102:case 112:return t(r[0]+n),"";default:return n+(0===u?"/*|*/":"")}case-2:n.split("/*|*/}").forEach(e)}}}}()},function(t,e,i){t.exports=i(16)()},function(t,e,i){"use strict";var n=i(2),r={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};var o=function(t){for(var e,i=t.length,n=i^i,r=0;i>=4;)e=1540483477*(65535&(e=255&t.charCodeAt(r)|(255&t.charCodeAt(++r))<<8|(255&t.charCodeAt(++r))<<16|(255&t.charCodeAt(++r))<<24))+((1540483477*(e>>>16)&65535)<<16),n=1540483477*(65535&n)+((1540483477*(n>>>16)&65535)<<16)^(e=1540483477*(65535&(e^=e>>>24))+((1540483477*(e>>>16)&65535)<<16)),i-=4,++r;switch(i){case 3:n^=(255&t.charCodeAt(r+2))<<16;case 2:n^=(255&t.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&t.charCodeAt(r)))+((1540483477*(n>>>16)&65535)<<16)}return n=1540483477*(65535&(n^=n>>>13))+((1540483477*(n>>>16)&65535)<<16),((n^=n>>>15)>>>0).toString(36)},s=function t(e){function i(t,e,i){var r=e.trim().split(f);e=r;var o=r.length,s=t.length;switch(s){case 0:case 1:var a=0;for(t=0===s?"":t[0]+" ";a<o;++a)e[a]=n(t,e[a],i).trim();break;default:var c=a=0;for(e=[];a<o;++a)for(var h=0;h<s;++h)e[c++]=n(t[h]+" ",r[a],i).trim()}return e}function n(t,e,i){var n=e.charCodeAt(0);switch(33>n&&(n=(e=e.trim()).charCodeAt(0)),n){case 38:return e.replace(g,"$1"+t.trim());case 58:return t.trim()+e.replace(g,"$1"+t.trim());default:if(0<1*i&&0<e.indexOf("\f"))return e.replace(g,(58===t.charCodeAt(0)?"":"$1")+t.trim())}return t+e}function r(t,e,i,n){var s=t+";",a=2*e+3*i+4*n;if(944===a){t=s.indexOf(":",9)+1;var c=s.substring(t,s.length-1).trim();return c=s.substring(0,t).trim()+c+";",1===I||2===I&&o(c,1)?"-webkit-"+c+c:c}if(0===I||2===I&&!o(s,1))return s;switch(a){case 1015:return 97===s.charCodeAt(10)?"-webkit-"+s+s:s;case 951:return 116===s.charCodeAt(3)?"-webkit-"+s+s:s;case 963:return 110===s.charCodeAt(5)?"-webkit-"+s+s:s;case 1009:if(100!==s.charCodeAt(4))break;case 969:case 942:return"-webkit-"+s+s;case 978:return"-webkit-"+s+"-moz-"+s+s;case 1019:case 983:return"-webkit-"+s+"-moz-"+s+"-ms-"+s+s;case 883:if(45===s.charCodeAt(8))return"-webkit-"+s+s;if(0<s.indexOf("image-set(",11))return s.replace(w,"$1-webkit-$2")+s;break;case 932:if(45===s.charCodeAt(4))switch(s.charCodeAt(5)){case 103:return"-webkit-box-"+s.replace("-grow","")+"-webkit-"+s+"-ms-"+s.replace("grow","positive")+s;case 115:return"-webkit-"+s+"-ms-"+s.replace("shrink","negative")+s;case 98:return"-webkit-"+s+"-ms-"+s.replace("basis","preferred-size")+s}return"-webkit-"+s+"-ms-"+s+s;case 964:return"-webkit-"+s+"-ms-flex-"+s+s;case 1023:if(99!==s.charCodeAt(8))break;return"-webkit-box-pack"+(c=s.substring(s.indexOf(":",15)).replace("flex-","").replace("space-between","justify"))+"-webkit-"+s+"-ms-flex-pack"+c+s;case 1005:return d.test(s)?s.replace(_,":-webkit-")+s.replace(_,":-moz-")+s:s;case 1e3:switch(e=(c=s.substring(13).trim()).indexOf("-")+1,c.charCodeAt(0)+c.charCodeAt(e)){case 226:c=s.replace(b,"tb");break;case 232:c=s.replace(b,"tb-rl");break;case 220:c=s.replace(b,"lr");break;default:return s}return"-webkit-"+s+"-ms-"+c+s;case 1017:if(-1===s.indexOf("sticky",9))break;case 975:switch(e=(s=t).length-10,a=(c=(33===s.charCodeAt(e)?s.substring(0,e):s).substring(t.indexOf(":",7)+1).trim()).charCodeAt(0)+(0|c.charCodeAt(7))){case 203:if(111>c.charCodeAt(8))break;case 115:s=s.replace(c,"-webkit-"+c)+";"+s;break;case 207:case 102:s=s.replace(c,"-webkit-"+(102<a?"inline-":"")+"box")+";"+s.replace(c,"-webkit-"+c)+";"+s.replace(c,"-ms-"+c+"box")+";"+s}return s+";";case 938:if(45===s.charCodeAt(5))switch(s.charCodeAt(6)){case 105:return"-webkit-"+s+"-webkit-box-"+(c=s.replace("-items",""))+"-ms-flex-"+c+s;case 115:return"-webkit-"+s+"-ms-flex-item-"+s.replace(O,"")+s;default:return"-webkit-"+s+"-ms-flex-line-pack"+s.replace("align-content","").replace(O,"")+s}break;case 973:case 989:if(45!==s.charCodeAt(3)||122===s.charCodeAt(4))break;case 931:case 953:if(!0===T.test(t))return 115===(c=t.substring(t.indexOf(":")+1)).charCodeAt(0)?r(t.replace("stretch","fill-available"),e,i,n).replace(":fill-available",":stretch"):s.replace(c,"-webkit-"+c)+s.replace(c,"-moz-"+c.replace("fill-",""))+s;break;case 962:if(s="-webkit-"+s+(102===s.charCodeAt(5)?"-ms-"+s:"")+s,211===i+n&&105===s.charCodeAt(13)&&0<s.indexOf("transform",10))return s.substring(0,s.indexOf(";",27)+1).replace(p,"$1-webkit-$2")+s}return s}function o(t,e){var i=t.indexOf(1===e?":":"{"),n=t.substring(0,3!==e?i:10);return i=t.substring(i+1,t.length-1),A(2!==e?n:n.replace(C,"$1"),i,e)}function s(t,e){var i=r(e,e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2));return i!==e+";"?i.replace(x," or ($1)").substring(4):"("+e+")"}function a(t,e,i,n,r,o,s,a,c,l){for(var u,_=0,d=e;_<S;++_)switch(u=L[_].call(h,t,d,i,n,r,o,s,a,c,l)){case void 0:case!1:case!0:case null:break;default:d=u}if(d!==e)return d}function c(t){return void 0!==(t=t.prefix)&&(A=null,t?"function"!=typeof t?I=1:(I=2,A=t):I=0),c}function h(e,n){if(void 0!==this&&this.constructor===h)return t(e);var c=e;if(33>c.charCodeAt(0)&&(c=c.trim()),c=[c],0<S){var _=a(-1,n,c,c,M,R,0,0,0,0);void 0!==_&&"string"==typeof _&&(n=_)}var d=function t(e,n,c,h,_){for(var d,p,f,g,b,x=0,O=0,C=0,T=0,w=0,L=0,A=f=d=0,k=0,F=0,U=0,N=0,B=c.length,W=B-1,z="",G="",K="",H="";k<B;){if(p=c.charCodeAt(k),k===W&&0!==O+T+C+x&&(0!==O&&(p=47===O?10:47),T=C=x=0,B++,W++),0===O+T+C+x){if(k===W&&(0<F&&(z=z.replace(u,"")),0<z.trim().length)){switch(p){case 32:case 9:case 59:case 13:case 10:break;default:z+=c.charAt(k)}p=59}switch(p){case 123:for(d=(z=z.trim()).charCodeAt(0),f=1,N=++k;k<B;){switch(p=c.charCodeAt(k)){case 123:f++;break;case 125:f--;break;case 47:switch(p=c.charCodeAt(k+1)){case 42:case 47:t:{for(A=k+1;A<W;++A)switch(c.charCodeAt(A)){case 47:if(42===p&&42===c.charCodeAt(A-1)&&k+2!==A){k=A+1;break t}break;case 10:if(47===p){k=A+1;break t}}k=A}}break;case 91:p++;case 40:p++;case 34:case 39:for(;k++<W&&c.charCodeAt(k)!==p;);}if(0===f)break;k++}switch(f=c.substring(N,k),0===d&&(d=(z=z.replace(l,"").trim()).charCodeAt(0)),d){case 64:switch(0<F&&(z=z.replace(u,"")),p=z.charCodeAt(1)){case 100:case 109:case 115:case 45:F=n;break;default:F=D}if(N=(f=t(n,F,f,p,_+1)).length,0<S&&(b=a(3,f,F=i(D,z,U),n,M,R,N,p,_,h),z=F.join(""),void 0!==b&&0===(N=(f=b.trim()).length)&&(p=0,f="")),0<N)switch(p){case 115:z=z.replace(E,s);case 100:case 109:case 45:f=z+"{"+f+"}";break;case 107:f=(z=z.replace(v,"$1 $2"))+"{"+f+"}",f=1===I||2===I&&o("@"+f,3)?"@-webkit-"+f+"@"+f:"@"+f;break;default:f=z+f,112===h&&(G+=f,f="")}else f="";break;default:f=t(n,i(n,z,U),f,h,_+1)}K+=f,f=U=F=A=d=0,z="",p=c.charCodeAt(++k);break;case 125:case 59:if(1<(N=(z=(0<F?z.replace(u,""):z).trim()).length))switch(0===A&&(d=z.charCodeAt(0),45===d||96<d&&123>d)&&(N=(z=z.replace(" ",":")).length),0<S&&void 0!==(b=a(1,z,n,e,M,R,G.length,h,_,h))&&0===(N=(z=b.trim()).length)&&(z="\0\0"),d=z.charCodeAt(0),p=z.charCodeAt(1),d){case 0:break;case 64:if(105===p||99===p){H+=z+c.charAt(k);break}default:58!==z.charCodeAt(N-1)&&(G+=r(z,d,p,z.charCodeAt(2)))}U=F=A=d=0,z="",p=c.charCodeAt(++k)}}switch(p){case 13:case 10:47===O?O=0:0===1+d&&107!==h&&0<z.length&&(F=1,z+="\0"),0<S*j&&a(0,z,n,e,M,R,G.length,h,_,h),R=1,M++;break;case 59:case 125:if(0===O+T+C+x){R++;break}default:switch(R++,g=c.charAt(k),p){case 9:case 32:if(0===T+x+O)switch(w){case 44:case 58:case 9:case 32:g="";break;default:32!==p&&(g=" ")}break;case 0:g="\\0";break;case 12:g="\\f";break;case 11:g="\\v";break;case 38:0===T+O+x&&(F=U=1,g="\f"+g);break;case 108:if(0===T+O+x+P&&0<A)switch(k-A){case 2:112===w&&58===c.charCodeAt(k-3)&&(P=w);case 8:111===L&&(P=L)}break;case 58:0===T+O+x&&(A=k);break;case 44:0===O+C+T+x&&(F=1,g+="\r");break;case 34:case 39:0===O&&(T=T===p?0:0===T?p:T);break;case 91:0===T+O+C&&x++;break;case 93:0===T+O+C&&x--;break;case 41:0===T+O+x&&C--;break;case 40:if(0===T+O+x){if(0===d)switch(2*w+3*L){case 533:break;default:d=1}C++}break;case 64:0===O+C+T+x+A+f&&(f=1);break;case 42:case 47:if(!(0<T+x+C))switch(O){case 0:switch(2*p+3*c.charCodeAt(k+1)){case 235:O=47;break;case 220:N=k,O=42}break;case 42:47===p&&42===w&&N+2!==k&&(33===c.charCodeAt(N+2)&&(G+=c.substring(N,k+1)),g="",O=0)}}0===O&&(z+=g)}L=w,w=p,k++}if(0<(N=G.length)){if(F=n,0<S&&void 0!==(b=a(2,G,F,e,M,R,N,h,_,h))&&0===(G=b).length)return H+G+K;if(G=F.join(",")+"{"+G+"}",0!=I*P){switch(2!==I||o(G,2)||(P=0),P){case 111:G=G.replace(y,":-moz-$1")+G;break;case 112:G=G.replace(m,"::-webkit-input-$1")+G.replace(m,"::-moz-$1")+G.replace(m,":-ms-input-$1")+G}P=0}}return H+G+K}(D,c,n,0,0);return 0<S&&void 0!==(_=a(-2,d,c,c,M,R,d.length,0,0,0))&&(d=_),P=0,R=M=1,d}var l=/^\0+/g,u=/[\0\r\f]/g,_=/: */g,d=/zoo|gra/,p=/([,: ])(transform)/g,f=/,\r+?/g,g=/([\t\r\n ])*\f?&/g,v=/@(k\w+)\s*(\S*)\s*/,m=/::(place)/g,y=/:(read-only)/g,b=/[svh]\w+-[tblr]{2}/,E=/\(\s*(.*)\s*\)/g,x=/([\s\S]*?);/g,O=/-self|flex-/g,C=/[^]*?(:[rp][el]a[\w-]+)[^]*/,T=/stretch|:\s*\w+\-(?:conte|avail)/,w=/([^-])(image-set\()/,R=1,M=1,P=0,I=1,D=[],L=[],S=0,A=null,j=0;return h.use=function t(e){switch(e){case void 0:case null:S=L.length=0;break;default:switch(e.constructor){case Array:for(var i=0,n=e.length;i<n;++i)t(e[i]);break;case Function:L[S++]=e;break;case Boolean:j=0|!!e}}return t},h.set=c,void 0!==e&&c(e),h},a=i(4),c=i.n(a),h=/[A-Z]|^ms/g,l=Object(n.a)(function(t){return t.replace(h,"-$&").toLowerCase()}),u=function(t,e){return null==e||"boolean"==typeof e?"":1===r[t]||45===t.charCodeAt(1)||isNaN(e)||0===e?e:e+"px"},_=function t(e){for(var i=e.length,n=0,r="";n<i;n++){var o=e[n];if(null!=o){var s=void 0;switch(typeof o){case"boolean":break;case"function":0,s=t([o()]);break;case"object":if(Array.isArray(o))s=t(o);else for(var a in s="",o)o[a]&&a&&(s&&(s+=" "),s+=a);break;default:s=o}s&&(r&&(r+=" "),r+=s)}}return r},d="undefined"!=typeof document;function p(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key||""),void 0!==t.nonce&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),(void 0!==t.container?t.container:document.head).appendChild(e),e}var f=function(){function t(t){this.isSpeedy=!0,this.tags=[],this.ctr=0,this.opts=t}var e=t.prototype;return e.inject=function(){if(this.injected)throw new Error("already injected!");this.tags[0]=p(this.opts),this.injected=!0},e.speedy=function(t){if(0!==this.ctr)throw new Error("cannot change speedy now");this.isSpeedy=!!t},e.insert=function(t,e){if(this.isSpeedy){var i=function(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}(this.tags[this.tags.length-1]);try{i.insertRule(t,i.cssRules.length)}catch(t){0}}else{var n=p(this.opts);this.tags.push(n),n.appendChild(document.createTextNode(t+(e||"")))}this.ctr++,this.ctr%65e3==0&&this.tags.push(p(this.opts))},e.flush=function(){this.tags.forEach(function(t){return t.parentNode.removeChild(t)}),this.tags=[],this.ctr=0,this.injected=!1},t}();e.a=function(t,e){if(void 0!==t.__SECRET_EMOTION__)return t.__SECRET_EMOTION__;void 0===e&&(e={});var i,n,r=e.key||"css",a=c()(function(t){i+=t,d&&p.insert(t,v)});void 0!==e.prefix&&(n={prefix:e.prefix});var h={registered:{},inserted:{},nonce:e.nonce,key:r},p=new f(e);d&&p.inject();var g=new s(n);g.use(e.stylisPlugins)(a);var v="";function m(t,e){if(null==t)return"";switch(typeof t){case"boolean":return"";case"function":if(void 0!==t.__emotion_styles){var i=t.toString();return i}return m.call(this,void 0===this?t():t(this.mergedProps,this.context),e);case"object":return function(t){if(E.has(t))return E.get(t);var e="";return Array.isArray(t)?t.forEach(function(t){e+=m.call(this,t,!1)},this):Object.keys(t).forEach(function(i){"object"!=typeof t[i]?void 0!==h.registered[t[i]]?e+=i+"{"+h.registered[t[i]]+"}":e+=l(i)+":"+u(i,t[i])+";":Array.isArray(t[i])&&"string"==typeof t[i][0]&&void 0===h.registered[t[i][0]]?t[i].forEach(function(t){e+=l(i)+":"+u(i,t)+";"}):e+=i+"{"+m.call(this,t[i],!1)+"}"},this),E.set(t,e),e}.call(this,t);default:var n=h.registered[t];return!1===e&&void 0!==n?n:t}}var y,b,E=new WeakMap,x=/label:\s*([^\s;\n{]+)\s*;/g,O=function(t){var e=!0,i="",n="";null==t||void 0===t.raw?(e=!1,i+=m.call(this,t,!1)):i+=t[0];for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];return s.forEach(function(n,r){i+=m.call(this,n,46===i.charCodeAt(i.length-1)),!0===e&&void 0!==t[r+1]&&(i+=t[r+1])},this),b=i,i=i.replace(x,function(t,e){return n+="-"+e,""}),y=function(t,e){return o(t+e)+e}(i,n),i};function C(t,e){void 0===h.inserted[y]&&(i="",g(t,e),h.inserted[y]=i)}var T=function(){var t=O.apply(this,arguments),e=r+"-"+y;return void 0===h.registered[e]&&(h.registered[e]=b),C("."+e,t),e};function w(t,e){var i="";return e.split(" ").forEach(function(e){void 0!==h.registered[e]?t.push(e):i+=e+" "}),i}function R(t,e){var i=[],n=w(i,t);return i.length<2?t:n+T(i,e)}function M(t){h.inserted[t]=!0}if(d){var P=document.querySelectorAll("[data-emotion-"+r+"]");Array.prototype.forEach.call(P,function(t){p.tags[0].parentNode.insertBefore(t,p.tags[0]),t.getAttribute("data-emotion-"+r).split(" ").forEach(M)})}var I={flush:function(){d&&(p.flush(),p.inject()),h.inserted={},h.registered={}},hydrate:function(t){t.forEach(M)},cx:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return R(_(e))},merge:R,getRegisteredStyles:w,injectGlobal:function(){C("",O.apply(this,arguments))},keyframes:function(){var t=O.apply(this,arguments),e="animation-"+y;return C("","@keyframes "+e+"{"+t+"}"),e},css:T,sheet:p,caches:h};return t.__SECRET_EMOTION__=I,I}},function(t,e,i){"use strict";var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(r,o){function s(t){try{c(n.next(t))}catch(t){o(t)}}function a(t){try{c(n.throw(t))}catch(t){o(t)}}function c(t){t.done?r(t.value):new i(function(e){e(t.value)}).then(s,a)}c((n=n.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});const r=i(1),o=i(13),s=i(14),a=i(19),c=i(0),h=t=>{return c.css`
		display: grid;
		grid-template-rows: ${t===l.Map?"90% 5% 5%":t===l.Timeline?"0 5% 95%":"47.5% 5% 47.5%"};
		height: 100%;
		width: 100%;
		transition: all 1s;
	`};var l;!function(t){t[t.Both=0]="Both",t[t.Map=1]="Map",t[t.Timeline=2]="Timeline"}(l=e.VisibleComponents||(e.VisibleComponents={}));e.default=class extends r.PureComponent{constructor(t){super(t),this.timelineConfig=new a.TimelineConfig,this.timelineRef=r.createRef(),this.state={map:null,timeline:null,visibleComponents:l.Both,zoomLevel:null}}componentDidMount(){return n(this,void 0,void 0,function*(){const t=new o.default({handleEvent:(t,e)=>console.log(t,e),target:"map"});this.timelineConfig=yield this.props.loadConfig(this.timelineRef.current);const e=new a.default(this.timelineConfig,e=>{const i=e.bands.find(t=>t instanceof a.EventsBand&&"battles"===t.config.label);this.state.zoomLevel!==i.zoomLevel&&this.setState({zoomLevel:i.zoomLevel}),t.setVisibleEvents(i.visibleEvents)},e=>t.onSelect(e));this.setState({map:t,timeline:e,zoomLevel:this.timelineConfig.controlBand.zoomLevel})})}componentDidUpdate(t,e){e.visibleComponents!==this.state.visibleComponents&&(this.state.map.updateSize(),this.state.timeline.reload())}render(){return r.createElement("div",{className:h(this.state.visibleComponents)},r.createElement("div",{id:"map"}),r.createElement(s.default,{controlBand:this.timelineConfig.controlBand,map:this.state.map,timeline:this.state.timeline,showBoth:()=>this.setState({visibleComponents:l.Both}),showMap:()=>{this.state.visibleComponents===l.Map?this.setState({visibleComponents:l.Both}):this.setState({visibleComponents:l.Map})},showTimeline:()=>{this.state.visibleComponents===l.Timeline?this.setState({visibleComponents:l.Both}):this.setState({visibleComponents:l.Timeline})},zoomIn:()=>this.timelineConfig.controlBand.zoomIn(),zoomLevel:this.state.zoomLevel,zoomOut:()=>this.timelineConfig.controlBand.zoomOut()}),r.createElement("div",{ref:this.timelineRef}))}}},function(t,e,i){"use strict";
/** @license React v16.4.2
 * react.production.min.js
 *
 * Copyright (c) 2013-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=i(9),r=i(10),o=i(11),s=i(12),a="function"==typeof Symbol&&Symbol.for,c=a?Symbol.for("react.element"):60103,h=a?Symbol.for("react.portal"):60106,l=a?Symbol.for("react.fragment"):60107,u=a?Symbol.for("react.strict_mode"):60108,_=a?Symbol.for("react.profiler"):60114,d=a?Symbol.for("react.provider"):60109,p=a?Symbol.for("react.context"):60110,f=a?Symbol.for("react.async_mode"):60111,g=a?Symbol.for("react.forward_ref"):60112;a&&Symbol.for("react.timeout");var v="function"==typeof Symbol&&Symbol.iterator;function m(t){for(var e=arguments.length-1,i="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=0;n<e;n++)i+="&args[]="+encodeURIComponent(arguments[n+1]);r(!1,"Minified React error #"+t+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",i)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}};function b(t,e,i){this.props=t,this.context=e,this.refs=o,this.updater=i||y}function E(){}function x(t,e,i){this.props=t,this.context=e,this.refs=o,this.updater=i||y}b.prototype.isReactComponent={},b.prototype.setState=function(t,e){"object"!=typeof t&&"function"!=typeof t&&null!=t&&m("85"),this.updater.enqueueSetState(this,t,e,"setState")},b.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},E.prototype=b.prototype;var O=x.prototype=new E;O.constructor=x,n(O,b.prototype),O.isPureReactComponent=!0;var C={current:null},T=Object.prototype.hasOwnProperty,w={key:!0,ref:!0,__self:!0,__source:!0};function R(t,e,i){var n=void 0,r={},o=null,s=null;if(null!=e)for(n in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(o=""+e.key),e)T.call(e,n)&&!w.hasOwnProperty(n)&&(r[n]=e[n]);var a=arguments.length-2;if(1===a)r.children=i;else if(1<a){for(var h=Array(a),l=0;l<a;l++)h[l]=arguments[l+2];r.children=h}if(t&&t.defaultProps)for(n in a=t.defaultProps)void 0===r[n]&&(r[n]=a[n]);return{$$typeof:c,type:t,key:o,ref:s,props:r,_owner:C.current}}function M(t){return"object"==typeof t&&null!==t&&t.$$typeof===c}var P=/\/+/g,I=[];function D(t,e,i,n){if(I.length){var r=I.pop();return r.result=t,r.keyPrefix=e,r.func=i,r.context=n,r.count=0,r}return{result:t,keyPrefix:e,func:i,context:n,count:0}}function L(t){t.result=null,t.keyPrefix=null,t.func=null,t.context=null,t.count=0,10>I.length&&I.push(t)}function S(t,e,i,n){var r=typeof t;"undefined"!==r&&"boolean"!==r||(t=null);var o=!1;if(null===t)o=!0;else switch(r){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case c:case h:o=!0}}if(o)return i(n,t,""===e?"."+A(t,0):e),1;if(o=0,e=""===e?".":e+":",Array.isArray(t))for(var s=0;s<t.length;s++){var a=e+A(r=t[s],s);o+=S(r,a,i,n)}else if(null===t||void 0===t?a=null:a="function"==typeof(a=v&&t[v]||t["@@iterator"])?a:null,"function"==typeof a)for(t=a.call(t),s=0;!(r=t.next()).done;)o+=S(r=r.value,a=e+A(r,s++),i,n);else"object"===r&&m("31","[object Object]"===(i=""+t)?"object with keys {"+Object.keys(t).join(", ")+"}":i,"");return o}function A(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,function(t){return e[t]})}(t.key):e.toString(36)}function j(t,e){t.func.call(t.context,e,t.count++)}function k(t,e,i){var n=t.result,r=t.keyPrefix;t=t.func.call(t.context,e,t.count++),Array.isArray(t)?F(t,n,i,s.thatReturnsArgument):null!=t&&(M(t)&&(e=r+(!t.key||e&&e.key===t.key?"":(""+t.key).replace(P,"$&/")+"/")+i,t={$$typeof:c,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}),n.push(t))}function F(t,e,i,n,r){var o="";null!=i&&(o=(""+i).replace(P,"$&/")+"/"),e=D(e,o,n,r),null==t||S(t,"",k,e),L(e)}var U={Children:{map:function(t,e,i){if(null==t)return t;var n=[];return F(t,n,null,e,i),n},forEach:function(t,e,i){if(null==t)return t;e=D(null,null,e,i),null==t||S(t,"",j,e),L(e)},count:function(t){return null==t?0:S(t,"",s.thatReturnsNull,null)},toArray:function(t){var e=[];return F(t,e,null,s.thatReturnsArgument),e},only:function(t){return M(t)||m("143"),t}},createRef:function(){return{current:null}},Component:b,PureComponent:x,createContext:function(t,e){return void 0===e&&(e=null),(t={$$typeof:p,_calculateChangedBits:e,_defaultValue:t,_currentValue:t,_currentValue2:t,_changedBits:0,_changedBits2:0,Provider:null,Consumer:null}).Provider={$$typeof:d,_context:t},t.Consumer=t},forwardRef:function(t){return{$$typeof:g,render:t}},Fragment:l,StrictMode:u,unstable_AsyncMode:f,unstable_Profiler:_,createElement:R,cloneElement:function(t,e,i){(null===t||void 0===t)&&m("267",t);var r=void 0,o=n({},t.props),s=t.key,a=t.ref,h=t._owner;if(null!=e){void 0!==e.ref&&(a=e.ref,h=C.current),void 0!==e.key&&(s=""+e.key);var l=void 0;for(r in t.type&&t.type.defaultProps&&(l=t.type.defaultProps),e)T.call(e,r)&&!w.hasOwnProperty(r)&&(o[r]=void 0===e[r]&&void 0!==l?l[r]:e[r])}if(1===(r=arguments.length-2))o.children=i;else if(1<r){l=Array(r);for(var u=0;u<r;u++)l[u]=arguments[u+2];o.children=l}return{$$typeof:c,type:t.type,key:s,ref:a,props:o,_owner:h}},createFactory:function(t){var e=R.bind(null,t);return e.type=t,e},isValidElement:M,version:"16.4.2",__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentOwner:C,assign:n}},N={default:U},B=N&&U||N;t.exports=B.default?B.default:B},function(t,e,i){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var n=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},i=0;i<10;i++)e["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(t){n[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var i,s,a=function(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),c=1;c<arguments.length;c++){for(var h in i=Object(arguments[c]))r.call(i,h)&&(a[h]=i[h]);if(n){s=n(i);for(var l=0;l<s.length;l++)o.call(i,s[l])&&(a[s[l]]=i[s[l]])}}return a}},function(t,e,i){"use strict";var n=function(t){};t.exports=function(t,e,i,r,o,s,a,c){if(n(e),!t){var h;if(void 0===e)h=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[i,r,o,s,a,c],u=0;(h=new Error(e.replace(/%s/g,function(){return l[u++]}))).name="Invariant Violation"}throw h.framesToPop=1,h}}},function(t,e,i){"use strict";t.exports={}},function(t,e,i){"use strict";function n(t){return function(){return t}}var r=function(){};r.thatReturns=n,r.thatReturnsFalse=n(!1),r.thatReturnsTrue=n(!0),r.thatReturnsNull=n(null),r.thatReturnsThis=function(){return this},r.thatReturnsArgument=function(t){return t},t.exports=r},function(t,e,i){t.exports=function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=74)}([function(t,e,i){"use strict";i.d(e,"q",function(){return n}),i.d(e,"u",function(){return r}),i.d(e,"d",function(){return o}),i.d(e,"e",function(){return s}),i.d(e,"E",function(){return a}),i.d(e,"F",function(){return c}),i.d(e,"r",function(){return h}),i.d(e,"a",function(){return l}),i.d(e,"j",function(){return u}),i.d(e,"x",function(){return _}),i.d(e,"v",function(){return d}),i.d(e,"i",function(){return p}),i.d(e,"f",function(){return f}),i.d(e,"b",function(){return g}),i.d(e,"w",function(){return v}),i.d(e,"h",function(){return m}),i.d(e,"t",function(){return y}),i.d(e,"G",function(){return b}),i.d(e,"I",function(){return E}),i.d(e,"H",function(){return x}),i.d(e,"l",function(){return O}),i.d(e,"s",function(){return C}),i.d(e,"m",function(){return T}),i.d(e,"J",function(){return w}),i.d(e,"o",function(){return R}),i.d(e,"A",function(){return M}),i.d(e,"B",function(){return P}),i.d(e,"C",function(){return I}),i.d(e,"D",function(){return D}),i.d(e,"z",function(){return L}),i.d(e,"y",function(){return S}),i.d(e,"c",function(){return A}),i.d(e,"n",function(){return j}),i.d(e,"K",function(){return F}),i.d(e,"g",function(){return B}),i.d(e,"p",function(){return U}),i.d(e,"k",function(){return N});var n=1,r=770,o=36064,s=16384,a=4,c=5,h=771,l=34962,u=34963,_=35040,d=35044,p=35048,f=2884,g=3042,v=2960,m=2929,y=3089,b=5121,E=5123,x=5125,O=5126,C=6408,T=35632,w=35633,R=9729,M=10240,P=10241,I=10242,D=10243,L=3553,S=33984,A=33071,j=36160,k=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function F(t,e){for(var i=k.length,n=0;n<i;++n)try{var r=t.getContext(k[n],e);if(r)return r}catch(t){}return null}var U,N,B=!0;if("undefined"!=typeof window&&"WebGLRenderingContext"in window)try{var W=F(document.createElement("CANVAS"),{failIfMajorPerformanceCaveat:!0});W&&(U=W.getParameter(W.MAX_TEXTURE_SIZE),N=W.getSupportedExtensions())}catch(t){}},function(t,e,i){"use strict";i.d(e,"a",function(){return c}),i.d(e,"b",function(){return h}),i.d(e,"c",function(){return l}),i.d(e,"e",function(){return u}),i.d(e,"d",function(){return _});var n=i(10);function r(t,e,i,n){for(var r,o=0,s=t.length;o<s;++o)if((r=t[o]).listener===e&&r.bindTo===i)return n&&(r.deleteIndex=o),r}function o(t,e){var i=t.ol_lm;return i?i[e]:void 0}function s(t){var e=t.ol_lm;return e||(e=t.ol_lm={}),e}function a(t,e){var i=o(t,e);if(i){for(var r=0,s=i.length;r<s;++r)t.removeEventListener(e,i[r].boundListener),Object(n.b)(i[r]);i.length=0;var a=t.ol_lm;a&&(delete a[e],0===Object.keys(a).length&&delete t.ol_lm)}}function c(t,e,i,n,o){var a=s(t),c=a[e];c||(c=a[e]=[]);var h=r(c,i,n,!1);return h?o||(h.callOnce=!1):(h={bindTo:n,callOnce:!!o,listener:i,target:t,type:e},t.addEventListener(e,function(t){var e=function(e){var i=t.listener,n=t.bindTo||t.target;return t.callOnce&&u(t),i.call(n,e)};return t.boundListener=e,e}(h)),c.push(h)),h}function h(t,e,i,n){return c(t,e,i,n,!0)}function l(t,e,i,n){var s=o(t,e);if(s){var a=r(s,i,n,!0);a&&u(a)}}function u(t){if(t&&t.target){t.target.removeEventListener(t.type,t.boundListener);var e=o(t.target,t.type);if(e){var i="deleteIndex"in t?t.deleteIndex:e.indexOf(t);-1!==i&&e.splice(i,1),0===e.length&&a(t.target,t.type)}Object(n.b)(t)}}function _(t){var e=s(t);for(var i in e)a(t,i)}},function(t,e,i){"use strict";var n=i(11),r=i(45),o={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function s(t){for(var e=[1/0,1/0,-1/0,-1/0],i=0,n=t.length;i<n;++i)x(e,t[i]);return e}function a(t,e,i){return i?(i[0]=t[0]-e,i[1]=t[1]-e,i[2]=t[2]+e,i[3]=t[3]+e,i):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function c(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function h(t,e,i){var n,r;return(n=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*n+(r=i<t[1]?t[1]-i:t[3]<i?i-t[3]:0)*r}function l(t,e){return _(t,e[0],e[1])}function u(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function _(t,e,i){return t[0]<=e&&e<=t[2]&&t[1]<=i&&i<=t[3]}function d(t,e){var i=t[0],n=t[1],r=t[2],s=t[3],a=e[0],c=e[1],h=o.UNKNOWN;return a<i?h|=o.LEFT:a>r&&(h|=o.RIGHT),c<n?h|=o.BELOW:c>s&&(h|=o.ABOVE),h===o.UNKNOWN&&(h=o.INTERSECTING),h}function p(){return[1/0,1/0,-1/0,-1/0]}function f(t,e,i,n,r){return r?(r[0]=t,r[1]=e,r[2]=i,r[3]=n,r):[t,e,i,n]}function g(t){return f(1/0,1/0,-1/0,-1/0,t)}function v(t,e){var i=t[0],n=t[1];return f(i,n,i,n,e)}function m(t,e){return function(t,e){for(var i=0,n=e.length;i<n;++i)x(t,e[i]);return t}(g(e),t)}function y(t,e,i,n,r){return O(g(r),t,e,i,n)}function b(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function E(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function x(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function O(t,e,i,n,r){for(;i<n;i+=r)C(t,e[i],e[i+1]);return t}function C(t,e,i){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],i),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],i)}function T(t,e,i){var n;return(n=e.call(i,R(t)))?n:(n=e.call(i,M(t)))?n:(n=e.call(i,j(t)))?n:(n=e.call(i,A(t)))||!1}function w(t){var e=0;return U(t)||(e=k(t)*L(t)),e}function R(t){return[t[0],t[1]]}function M(t){return[t[2],t[1]]}function P(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function I(t,e){var i;return e===r.a.BOTTOM_LEFT?i=R(t):e===r.a.BOTTOM_RIGHT?i=M(t):e===r.a.TOP_LEFT?i=A(t):e===r.a.TOP_RIGHT?i=j(t):Object(n.a)(!1,13),i}function D(t,e,i,n,r){var o=e*n[0]/2,s=e*n[1]/2,a=Math.cos(i),c=Math.sin(i),h=o*a,l=o*c,u=s*a,_=s*c,d=t[0],p=t[1],g=d-h+_,v=d-h-_,m=d+h-_,y=d+h+_,b=p-l-u,E=p-l+u,x=p+l+u,O=p+l-u;return f(Math.min(g,v,m,y),Math.min(b,E,x,O),Math.max(g,v,m,y),Math.max(b,E,x,O),r)}function L(t){return t[3]-t[1]}function S(t,e,i){var n=i||[1/0,1/0,-1/0,-1/0];return F(t,e)?(t[0]>e[0]?n[0]=t[0]:n[0]=e[0],t[1]>e[1]?n[1]=t[1]:n[1]=e[1],t[2]<e[2]?n[2]=t[2]:n[2]=e[2],t[3]<e[3]?n[3]=t[3]:n[3]=e[3]):g(n),n}function A(t){return[t[0],t[3]]}function j(t){return[t[2],t[3]]}function k(t){return t[2]-t[0]}function F(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function U(t){return t[2]<t[0]||t[3]<t[1]}function N(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}function B(t,e){var i=(t[2]-t[0])/2*(e-1),n=(t[3]-t[1])/2*(e-1);t[0]-=i,t[2]+=i,t[1]-=n,t[3]+=n}function W(t,e,i){var n=!1,r=d(t,e),s=d(t,i);if(r===o.INTERSECTING||s===o.INTERSECTING)n=!0;else{var a,c,h=t[0],l=t[1],u=t[2],_=t[3],p=e[0],f=e[1],g=i[0],v=i[1],m=(v-f)/(g-p);s&o.ABOVE&&!(r&o.ABOVE)&&(n=(a=g-(v-_)/m)>=h&&a<=u),n||!(s&o.RIGHT)||r&o.RIGHT||(n=(c=v-(g-u)*m)>=l&&c<=_),n||!(s&o.BELOW)||r&o.BELOW||(n=(a=g-(v-l)/m)>=h&&a<=u),n||!(s&o.LEFT)||r&o.LEFT||(n=(c=v-(g-h)*m)>=l&&c<=_)}return n}function z(t,e,i){var n=[t[0],t[1],t[0],t[3],t[2],t[1],t[2],t[3]];return e(n,n,2),function(t,e,i){return f(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),i)}([n[0],n[2],n[4],n[6]],[n[1],n[3],n[5],n[7]],i)}i.d(e,"b",function(){return s}),i.d(e,"c",function(){return a}),i.d(e,"d",function(){return c}),i.d(e,"e",function(){return h}),i.d(e,"f",function(){return l}),i.d(e,"g",function(){return u}),i.d(e,"h",function(){return _}),i.d(e,"i",function(){return p}),i.d(e,"j",function(){return f}),i.d(e,"k",function(){return g}),i.d(e,"l",function(){return v}),i.d(e,"m",function(){return m}),i.d(e,"n",function(){return y}),i.d(e,"o",function(){return b}),i.d(e,"p",function(){return E}),i.d(e,"q",function(){return x}),i.d(e,"r",function(){return O}),i.d(e,"s",function(){return T}),i.d(e,"t",function(){return w}),i.d(e,"u",function(){return R}),i.d(e,"v",function(){return M}),i.d(e,"w",function(){return P}),i.d(e,"x",function(){return I}),i.d(e,"y",function(){return D}),i.d(e,"z",function(){return L}),i.d(e,"A",function(){return S}),i.d(e,"B",function(){return A}),i.d(e,"C",function(){return j}),i.d(e,"D",function(){return k}),i.d(e,"E",function(){return F}),i.d(e,"G",function(){return U}),i.d(e,"H",function(){return N}),i.d(e,"I",function(){return B}),i.d(e,"F",function(){return W}),i.d(e,"a",function(){return z})},function(t,e,i){"use strict";i.d(e,"b",function(){return r}),i.d(e,"a",function(){return o});var n=0;function r(t){return t.ol_uid||(t.ol_uid=++n)}var o="5.1.3"},function(t,e,i){"use strict";e.a={CHANGE:"change",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",ERROR:"error",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",MOUSEDOWN:"mousedown",MOUSEMOVE:"mousemove",MOUSEOUT:"mouseout",MOUSEUP:"mouseup",MOUSEWHEEL:"mousewheel",MSPOINTERDOWN:"MSPointerDown",RESIZE:"resize",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",WHEEL:"wheel"}},function(t,e,i){"use strict";i.d(e,"a",function(){return r}),i.d(e,"b",function(){return o}),i.d(e,"e",function(){return s}),i.d(e,"h",function(){return a}),i.d(e,"g",function(){return c}),i.d(e,"f",function(){return h}),i.d(e,"i",function(){return l}),i.d(e,"j",function(){return u}),i.d(e,"d",function(){return _}),i.d(e,"c",function(){return d});var n=i(11);function r(t,e,i){return Math.min(Math.max(t,e),i)}var o="cosh"in Math?Math.cosh:function(t){var e=Math.exp(t);return(e+1/e)/2};function s(t){return Object(n.a)(0<t,29),Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function a(t,e,i,n,r,o){var s=r-i,a=o-n;if(0!==s||0!==a){var h=((t-i)*s+(e-n)*a)/(s*s+a*a);h>1?(i=r,n=o):h>0&&(i+=s*h,n+=a*h)}return c(t,e,i,n)}function c(t,e,i,n){var r=i-t,o=n-e;return r*r+o*o}function h(t){for(var e=t.length,i=0;i<e;i++){for(var n=i,r=Math.abs(t[i][i]),o=i+1;o<e;o++){var s=Math.abs(t[o][i]);s>r&&(r=s,n=o)}if(0===r)return null;var a=t[n];t[n]=t[i],t[i]=a;for(var c=i+1;c<e;c++)for(var h=-t[c][i]/t[i][i],l=i;l<e+1;l++)i==l?t[c][l]=0:t[c][l]+=h*t[i][l]}for(var u=new Array(e),_=e-1;_>=0;_--){u[_]=t[_][e]/t[_][_];for(var d=_-1;d>=0;d--)t[d][e]-=t[d][_]*u[_]}return u}function l(t){return 180*t/Math.PI}function u(t){return t*Math.PI/180}function _(t,e){var i=t%e;return i*e<0?i+e:i}function d(t,e,i){return t+i*(e-t)}},function(t,e,i){"use strict";i.d(e,"c",function(){return o}),i.d(e,"f",function(){return s}),i.d(e,"e",function(){return a}),i.d(e,"i",function(){return h}),i.d(e,"a",function(){return l}),i.d(e,"g",function(){return u}),i.d(e,"h",function(){return _}),i.d(e,"j",function(){return d}),i.d(e,"b",function(){return p}),i.d(e,"d",function(){return f});var n=i(11),r=new Array(6);function o(){return[1,0,0,1,0,0]}function s(t){return c(t,1,0,0,1,0,0)}function a(t,e){var i=t[0],n=t[1],r=t[2],o=t[3],s=t[4],a=t[5],c=e[0],h=e[1],l=e[2],u=e[3],_=e[4],d=e[5];return t[0]=i*c+r*h,t[1]=n*c+o*h,t[2]=i*l+r*u,t[3]=n*l+o*u,t[4]=i*_+r*d+s,t[5]=n*_+o*d+a,t}function c(t,e,i,n,r,o,s){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t[4]=o,t[5]=s,t}function h(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function l(t,e){var i=e[0],n=e[1];return e[0]=t[0]*i+t[2]*n+t[4],e[1]=t[1]*i+t[3]*n+t[5],e}function u(t,e){var i=Math.cos(e),n=Math.sin(e);return a(t,c(r,i,n,-n,i,0,0))}function _(t,e,i){return a(t,c(r,e,0,0,i,0,0))}function d(t,e,i){return a(t,c(r,1,0,0,1,e,i))}function p(t,e,i,n,r,o,s,a){var c=Math.sin(o),h=Math.cos(o);return t[0]=n*h,t[1]=r*c,t[2]=-n*c,t[3]=r*h,t[4]=s*n*h-a*n*c+e,t[5]=s*r*c+a*r*h+i,t}function f(t){var e=function(t){return t[0]*t[3]-t[1]*t[2]}(t);Object(n.a)(0!==e,32);var i=t[0],r=t[1],o=t[2],s=t[3],a=t[4],c=t[5];return t[0]=s/e,t[1]=-r/e,t[2]=-o/e,t[3]=i/e,t[4]=(o*c-s*a)/e,t[5]=-(i*c-r*a)/e,t}},function(t,e,i){"use strict";e.a={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"}},function(t,e,i){"use strict";e.a={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4,ABORT:5}},function(t,e,i){"use strict";function n(){return!0}function r(){return!1}function o(){}i.d(e,"b",function(){return n}),i.d(e,"a",function(){return r}),i.d(e,"c",function(){return o})},function(t,e,i){"use strict";i.d(e,"a",function(){return n}),i.d(e,"b",function(){return r}),i.d(e,"c",function(){return o}),i.d(e,"d",function(){return s});var n="function"==typeof Object.assign?Object.assign:function(t,e){var i=arguments;if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),r=1,o=arguments.length;r<o;++r){var s=i[r];if(void 0!==s&&null!==s)for(var a in s)s.hasOwnProperty(a)&&(n[a]=s[a])}return n};function r(t){for(var e in t)delete t[e]}function o(t){var e=[];for(var i in t)e.push(t[i]);return e}function s(t){var e;for(e in t)return!1;return!e}},function(t,e,i){"use strict";i.d(e,"a",function(){return r});var n=i(59);function r(t,e){if(!t)throw new n.a(e)}},function(t,e,i){"use strict";i.d(e,"b",function(){return u});var n=i(3),r=i(36),o=i(57),s=i(17),a=i(10),c=function(t){function e(e,i,n){t.call(this,e),this.key=i,this.oldValue=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(s.a),h=function(t){function e(e){t.call(this),Object(n.b)(this),this.values_={},void 0!==e&&this.setProperties(e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){var e;return this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},e.prototype.getKeys=function(){return Object.keys(this.values_)},e.prototype.getProperties=function(){return Object(a.a)({},this.values_)},e.prototype.notify=function(t,e){var i;i=u(t),this.dispatchEvent(new c(i,t,e)),i=r.a.PROPERTYCHANGE,this.dispatchEvent(new c(i,t,e))},e.prototype.set=function(t,e,i){if(i)this.values_[t]=e;else{var n=this.values_[t];this.values_[t]=e,n!==e&&this.notify(t,n)}},e.prototype.setProperties=function(t,e){for(var i in t)this.set(i,t[i],e)},e.prototype.unset=function(t,e){if(t in this.values_){var i=this.values_[t];delete this.values_[t],e||this.notify(t,i)}},e}(o.a),l={};function u(t){return l.hasOwnProperty(t)?l[t]:l[t]="change:"+t}e.a=h},function(t,e,i){"use strict";function n(t,e){return t>e?1:t<e?-1:0}function r(t,e){return t.indexOf(e)>=0}function o(t,e,i){var n,r=t.length;if(t[0]<=e)return 0;if(e<=t[r-1])return r-1;if(i>0){for(n=1;n<r;++n)if(t[n]<e)return n-1}else if(i<0){for(n=1;n<r;++n)if(t[n]<=e)return n}else for(n=1;n<r;++n){if(t[n]==e)return n;if(t[n]<e)return t[n-1]-e<e-t[n]?n-1:n}return r-1}function s(t,e){for(var i=Array.isArray(e)?e:[e],n=i.length,r=0;r<n;r++)t[t.length]=i[r]}function a(t,e){var i=t.indexOf(e),n=i>-1;return n&&t.splice(i,1),n}function c(t,e){var i=t.length;if(i!==e.length)return!1;for(var n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}function h(t,e){var i,n=t.length,r=Array(t.length);for(i=0;i<n;i++)r[i]={index:i,value:t[i]};for(r.sort(function(t,i){return e(t.value,i.value)||t.index-i.index}),i=0;i<t.length;i++)t[i]=r[i].value}function l(t,e,i){var r=e||n;return t.every(function(e,n){if(0===n)return!0;var o=r(t[n-1],e);return!(o>0||i&&0===o)})}i.d(e,"f",function(){return n}),i.d(e,"c",function(){return r}),i.d(e,"e",function(){return o}),i.d(e,"b",function(){return s}),i.d(e,"g",function(){return a}),i.d(e,"a",function(){return c}),i.d(e,"h",function(){return h}),i.d(e,"d",function(){return l})},function(t,e,i){"use strict";function n(t,e){var i=document.createElement("CANVAS");return t&&(i.width=t),e&&(i.height=e),i.getContext("2d")}function r(t){var e=t.offsetWidth,i=getComputedStyle(t);return e+=parseInt(i.marginLeft,10)+parseInt(i.marginRight,10)}function o(t){var e=t.offsetHeight,i=getComputedStyle(t);return e+=parseInt(i.marginTop,10)+parseInt(i.marginBottom,10)}function s(t,e){var i=e.parentNode;i&&i.replaceChild(t,e)}function a(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}function c(t){for(;t.lastChild;)t.removeChild(t.lastChild)}i.d(e,"a",function(){return n}),i.d(e,"c",function(){return r}),i.d(e,"b",function(){return o}),i.d(e,"f",function(){return s}),i.d(e,"e",function(){return a}),i.d(e,"d",function(){return c})},function(t,e,i){"use strict";e.a={ANIMATING:0,INTERACTING:1}},function(t,e,i){"use strict";i.r(e);var n=i(54),r=i(2),o=i(5),s=i(18),a=function(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit};a.prototype.canWrapX=function(){return this.canWrapX_},a.prototype.getCode=function(){return this.code_},a.prototype.getExtent=function(){return this.extent_},a.prototype.getUnits=function(){return this.units_},a.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||s.a[this.units_]},a.prototype.getWorldExtent=function(){return this.worldExtent_},a.prototype.getAxisOrientation=function(){return this.axisOrientation_},a.prototype.isGlobal=function(){return this.global_},a.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},a.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},a.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},a.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},a.prototype.setWorldExtent=function(t){this.worldExtent_=t},a.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},a.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_};var c=a,h=6378137,l=Math.PI*h,u=[-l,-l,l,l],_=[-180,-85,180,85],d=function(t){function e(e){t.call(this,{code:e,units:s.b.METERS,extent:u,global:!0,worldExtent:_,getPointResolution:function(t,e){return t/Object(o.b)(e[1]/h)}})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(c),p=[new d("EPSG:3857"),new d("EPSG:102100"),new d("EPSG:102113"),new d("EPSG:900913"),new d("urn:ogc:def:crs:EPSG:6.18:3:3857"),new d("urn:ogc:def:crs:EPSG::3857"),new d("http://www.opengis.net/gml/srs/epsg.xml#3857")];function f(t,e,i){var n=t.length,r=i>1?i:2,o=e;void 0===o&&(o=r>2?t.slice():new Array(n));for(var s=l,a=0;a<n;a+=r){o[a]=s*t[a]/180;var c=h*Math.log(Math.tan(Math.PI*(t[a+1]+90)/360));c>s?c=s:c<-s&&(c=-s),o[a+1]=c}return o}function g(t,e,i){var n=t.length,r=i>1?i:2,o=e;void 0===o&&(o=r>2?t.slice():new Array(n));for(var s=0;s<n;s+=r)o[s]=180*t[s]/l,o[s+1]=360*Math.atan(Math.exp(t[s+1]/h))/Math.PI-90;return o}var v=[-180,-90,180,90],m=6378137*Math.PI/180,y=function(t){function e(e,i){t.call(this,{code:e,units:s.b.DEGREES,extent:v,axisOrientation:i,global:!0,metersPerUnit:m,worldExtent:v})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(c),b=[new y("CRS:84"),new y("EPSG:4326","neu"),new y("urn:ogc:def:crs:EPSG::4326","neu"),new y("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new y("urn:ogc:def:crs:OGC:1.3:CRS84"),new y("urn:ogc:def:crs:OGC:2:84"),new y("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new y("urn:x-ogc:def:crs:EPSG:4326","neu")],E={};i(10);var x={};function O(t,e,i){var n=t.getCode(),r=e.getCode();n in x||(x[n]={}),x[n][r]=i}function C(t,e,i){var n;if(void 0!==e){for(var r=0,o=t.length;r<o;++r)e[r]=t[r];n=e}else n=t.slice();return n}function T(t,e,i){if(void 0!==e&&t!==e){for(var n=0,r=t.length;n<r;++n)e[n]=t[n];t=e}return t}function w(t){!function(t,e){E[t]=e}(t.getCode(),t),O(t,t,C)}function R(t){t.forEach(w)}function M(t){var e=null;return t instanceof c?e=t:"string"==typeof t&&(e=function(t){return E[t]||null}(t)),e}function P(t,e,i,r){var o,a=(t=M(t)).getPointResolutionFunc();if(a)o=a(e,i);else if(t.getUnits()==s.b.DEGREES&&!r||r==s.b.DEGREES)o=e;else{var c=N(t,M("EPSG:4326")),h=[i[0]-e/2,i[1],i[0]+e/2,i[1],i[0],i[1]-e/2,i[0],i[1]+e/2];h=c(h,h,2),o=(Object(n.a)(h.slice(0,2),h.slice(2,4))+Object(n.a)(h.slice(4,6),h.slice(6,8)))/2;var l=r?s.a[r]:t.getMetersPerUnit();void 0!==l&&(o/=l)}return o}function I(t){R(t),t.forEach(function(e){t.forEach(function(t){e!==t&&O(e,t,C)})})}function D(t,e,i,n){t.forEach(function(t){e.forEach(function(e){O(t,e,i),O(e,t,n)})})}function L(){E={},x={}}function S(t,e){return t?"string"==typeof t?M(t):t:M(e)}function A(t){return function(e,i,n){for(var r=e.length,o=void 0!==n?n:2,s=void 0!==i?i:new Array(r),a=0;a<r;a+=o){var c=t([e[a],e[a+1]]);s[a]=c[0],s[a+1]=c[1];for(var h=o-1;h>=2;--h)s[a+h]=e[a+h]}return s}}function j(t,e,i,n){var r=M(t),o=M(e);O(r,o,A(i)),O(o,r,A(n))}function k(t,e){return W(t,"EPSG:4326",void 0!==e?e:"EPSG:3857")}function F(t,e){var i=W(t,void 0!==e?e:"EPSG:3857","EPSG:4326"),n=i[0];return(n<-180||n>180)&&(i[0]=Object(o.d)(n+180,360)-180),i}function U(t,e){if(t===e)return!0;var i=t.getUnits()===e.getUnits();return t.getCode()===e.getCode()?i:N(t,e)===C&&i}function N(t,e){var i=function(t,e){var i;return t in x&&e in x[t]&&(i=x[t][e]),i}(t.getCode(),e.getCode());return i||(i=T),i}function B(t,e){return N(M(t),M(e))}function W(t,e,i){return B(e,i)(t,void 0,t.length)}function z(t,e,i){var n=B(e,i);return Object(r.a)(t,n)}function G(t,e,i){return N(e,i)(t)}function K(){I(p),I(b),D(b,p,f,g)}i.d(e,"cloneTransform",function(){return C}),i.d(e,"identityTransform",function(){return T}),i.d(e,"addProjection",function(){return w}),i.d(e,"addProjections",function(){return R}),i.d(e,"get",function(){return M}),i.d(e,"getPointResolution",function(){return P}),i.d(e,"addEquivalentProjections",function(){return I}),i.d(e,"addEquivalentTransforms",function(){return D}),i.d(e,"clearAllProjections",function(){return L}),i.d(e,"createProjection",function(){return S}),i.d(e,"createTransformFromCoordinateTransform",function(){return A}),i.d(e,"addCoordinateTransforms",function(){return j}),i.d(e,"fromLonLat",function(){return k}),i.d(e,"toLonLat",function(){return F}),i.d(e,"equivalent",function(){return U}),i.d(e,"getTransformFromProjections",function(){return N}),i.d(e,"getTransform",function(){return B}),i.d(e,"transform",function(){return W}),i.d(e,"transformExtent",function(){return z}),i.d(e,"transformWithProjections",function(){return G}),i.d(e,"addCommon",function(){return K}),i.d(e,"METERS_PER_UNIT",function(){return s.a}),K()},function(t,e,i){"use strict";i.d(e,"b",function(){return r});var n=function(t){this.propagationStopped,this.type=t,this.target=null};function r(t){t.stopPropagation()}n.prototype.preventDefault=function(){this.propagationStopped=!0},n.prototype.stopPropagation=function(){this.propagationStopped=!0},e.a=n},function(t,e,i){"use strict";i.d(e,"a",function(){return r});var n={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},r={};r[n.DEGREES]=2*Math.PI*6370997/360,r[n.FEET]=.3048,r[n.METERS]=1,r[n.USFEET]=1200/3937,e.b=n},function(t,e,i){"use strict";e.a={IDLE:0,LOADING:1,LOADED:2,ERROR:3}},function(t,e,i){"use strict";i.d(e,"c",function(){return r}),i.d(e,"g",function(){return o}),i.d(e,"i",function(){return s}),i.d(e,"d",function(){return a}),i.d(e,"b",function(){return c}),i.d(e,"a",function(){return h}),i.d(e,"h",function(){return l}),i.d(e,"f",function(){return u}),i.d(e,"e",function(){return _});var n="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",r=-1!==n.indexOf("firefox"),o=-1!==n.indexOf("safari")&&-1==n.indexOf("chrom"),s=-1!==n.indexOf("webkit")&&-1==n.indexOf("edge"),a=-1!==n.indexOf("macintosh"),c=window.devicePixelRatio||1,h=function(){var t=!1;try{t=!!document.createElement("CANVAS").getContext("2d").setLineDash}catch(t){}return t}(),l=(navigator,"ontouchstart"in window),u="PointerEvent"in window,_=!!navigator.msPointerEnabled},function(t,e,i){"use strict";e.a={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",SOURCE:"source"}},function(t,e,i){"use strict";i.d(e,"c",function(){return n}),i.d(e,"d",function(){return r}),i.d(e,"e",function(){return o}),i.d(e,"b",function(){return s}),i.d(e,"a",function(){return a}),i.d(e,"f",function(){return c});var n="ol-hidden",r="ol-selectable",o="ol-unselectable",s="ol-control",a="ol-collapsed",c=function(){var t,e={};return function(i){if(t||(t=document.createElement("div").style),!(i in e)){t.font=i;var n=t.fontFamily;if(t.font="",!n)return null;e[i]=n.split(/,\s?/)}return e[i]}}()},function(t,e,i){"use strict";var n=i(59),r=i(25),o=i(12),s="length",a=function(t){function e(e,i){t.call(this,e),this.element=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(i(17).a),c=function(t){function e(e,i){t.call(this);var n=i||{};if(this.unique_=!!n.unique,this.array_=e||[],this.unique_)for(var r=0,o=this.array_.length;r<o;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var e=0,i=t.length;e<i;++e)this.push(t[e]);return this},e.prototype.forEach=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)t(e[i],i,e)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(s)},e.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new a(r.a.ADD,e))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},e.prototype.remove=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)if(e[i]===t)return this.removeAt(i)},e.prototype.removeAt=function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new a(r.a.REMOVE,e)),e},e.prototype.setAt=function(t,e){var i=this.getLength();if(t<i){this.unique_&&this.assertUnique_(e,t);var n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new a(r.a.REMOVE,n)),this.dispatchEvent(new a(r.a.ADD,e))}else{for(var o=i;o<t;++o)this.insertAt(o,void 0);this.insertAt(t,e)}},e.prototype.updateLength_=function(){this.set(s,this.array_.length)},e.prototype.assertUnique_=function(t,e){for(var i=0,r=this.array_.length;i<r;++i)if(this.array_[i]===t&&i!==e)throw new n.a(58)},e}(o.a);e.a=c},function(t,e,i){"use strict";function n(t){return Math.pow(t,3)}function r(t){return 1-n(1-t)}function o(t){return 3*t*t-2*t*t*t}function s(t){return t}i.d(e,"a",function(){return n}),i.d(e,"b",function(){return r}),i.d(e,"c",function(){return o}),i.d(e,"d",function(){return s})},function(t,e,i){"use strict";e.a={ADD:"add",REMOVE:"remove"}},function(t,e,i){"use strict";function n(t,e,i,n,r,o){for(var s=o||[],a=0,c=e;c<i;c+=n){var h=t[c],l=t[c+1];s[a++]=r[0]*h+r[2]*l+r[4],s[a++]=r[1]*h+r[3]*l+r[5]}return o&&s.length!=a&&(s.length=a),s}function r(t,e,i,n,r,o,s){for(var a=s||[],c=Math.cos(r),h=Math.sin(r),l=o[0],u=o[1],_=0,d=e;d<i;d+=n){var p=t[d]-l,f=t[d+1]-u;a[_++]=l+p*c-f*h,a[_++]=u+p*h+f*c;for(var g=d+2;g<d+n;++g)a[_++]=t[g]}return s&&a.length!=_&&(a.length=_),a}function o(t,e,i,n,r,o,s,a){for(var c=a||[],h=s[0],l=s[1],u=0,_=e;_<i;_+=n){var d=t[_]-h,p=t[_+1]-l;c[u++]=h+r*d,c[u++]=l+o*p;for(var f=_+2;f<_+n;++f)c[u++]=t[f]}return a&&c.length!=u&&(c.length=u),c}function s(t,e,i,n,r,o,s){for(var a=s||[],c=0,h=e;h<i;h+=n){a[c++]=t[h]+r,a[c++]=t[h+1]+o;for(var l=h+2;l<h+n;++l)a[c++]=t[l]}return s&&a.length!=c&&(a.length=c),a}i.d(e,"c",function(){return n}),i.d(e,"a",function(){return r}),i.d(e,"b",function(){return o}),i.d(e,"d",function(){return s})},function(t,e,i){"use strict";e.a={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"}},function(t,e,i){"use strict";i.d(e,"b",function(){return a}),i.d(e,"a",function(){return h}),i.d(e,"c",function(){return u});var n=i(11),r=i(5),o=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,s=/^([a-z]*)$/i;function a(t){return"string"==typeof t?t:u(t)}var c=function(){var t={},e=0;return function(i){var r;if(t.hasOwnProperty(i))r=t[i];else{if(e>=1024){var a=0;for(var c in t)0==(3&a++)&&(delete t[c],--e)}r=function(t){var e,i,r,a,c;if(s.exec(t)&&(t=function(t){var e=document.createElement("div");if(e.style.color=t,""!==e.style.color){document.body.appendChild(e);var i=getComputedStyle(e).color;return document.body.removeChild(e),i}return""}(t)),o.exec(t)){var h,u=t.length-1;h=u<=4?1:2;var _=4===u||8===u;e=parseInt(t.substr(1+0*h,h),16),i=parseInt(t.substr(1+1*h,h),16),r=parseInt(t.substr(1+2*h,h),16),a=_?parseInt(t.substr(1+3*h,h),16):255,1==h&&(e=(e<<4)+e,i=(i<<4)+i,r=(r<<4)+r,_&&(a=(a<<4)+a)),c=[e,i,r,a/255]}else 0==t.indexOf("rgba(")?l(c=t.slice(5,-1).split(",").map(Number)):0==t.indexOf("rgb(")?((c=t.slice(4,-1).split(",").map(Number)).push(1),l(c)):Object(n.a)(!1,14);return c}(i),t[i]=r,++e}return r}}();function h(t){return Array.isArray(t)?t:c(t)}function l(t){return t[0]=Object(r.a)(t[0]+.5|0,0,255),t[1]=Object(r.a)(t[1]+.5|0,0,255),t[2]=Object(r.a)(t[2]+.5|0,0,255),t[3]=Object(r.a)(t[3],0,1),t}function u(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var i=t[1];i!=(0|i)&&(i=i+.5|0);var n=t[2];return n!=(0|n)&&(n=n+.5|0),"rgba("+e+","+i+","+n+","+(void 0===t[3]?1:t[3])+")"}},function(t,e,i){"use strict";function n(t){return t[0]>0&&t[1]>0}function r(t,e,i){return void 0===i&&(i=[0,0]),i[0]=t[0]*e+.5|0,i[1]=t[1]*e+.5|0,i}function o(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:e[0]=e[1]=t,e)}i.d(e,"a",function(){return n}),i.d(e,"b",function(){return r}),i.d(e,"c",function(){return o})},function(t,e,i){"use strict";i.d(e,"b",function(){return n}),i.d(e,"a",function(){return r});var n=.5,r=!0},function(t,e,i){"use strict";i.d(e,"b",function(){return d});var n=i(1),r=i(4),o=i(3),s=i(12),a=i(61),c=i(21),h=i(10),l=i(43),u=i(33),_=function(t){function e(e){var i=Object(h.a)({},e);delete i.source,t.call(this,i),this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,e.map&&this.setMap(e.map),Object(n.a)(this,Object(s.b)(c.a.SOURCE),this.handleSourcePropertyChange_,this);var r=e.source?e.source:null;this.setSource(r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getLayersArray=function(t){var e=t||[];return e.push(this),e},e.prototype.getLayerStatesArray=function(t){var e=t||[];return e.push(this.getLayerState()),e},e.prototype.getSource=function(){return this.get(c.a.SOURCE)||null},e.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():u.a.UNDEFINED},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(Object(n.e)(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=Object(n.a)(t,r.a.CHANGE,this.handleSourceChange_,this)),this.changed()},e.prototype.setMap=function(t){this.mapPrecomposeKey_&&(Object(n.e)(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(Object(n.e)(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=Object(n.a)(t,l.a.PRECOMPOSE,function(t){var e=this.getLayerState();e.managed=!1,e.zIndex=1/0,t.frameState.layerStatesArray.push(e),t.frameState.layerStates[Object(o.b)(this)]=e},this),this.mapRenderKey_=Object(n.a)(this,r.a.CHANGE,t.render,t),this.changed())},e.prototype.setSource=function(t){this.set(c.a.SOURCE,t)},e}(a.a);function d(t,e){return t.visible&&e>=t.minResolution&&e<t.maxResolution}e.a=_},function(t,e,i){"use strict";var n=i(40),r=i(1),o=i(9),s=i(17),a=function(t){function e(){t.call(this),this.pendingRemovals_={},this.dispatching_={},this.listeners_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addEventListener=function(t,e){var i=this.listeners_[t];i||(i=this.listeners_[t]=[]),-1===i.indexOf(e)&&i.push(e)},e.prototype.dispatchEvent=function(t){var e="string"==typeof t?new s.a(t):t,i=e.type;e.target=this;var n,r=this.listeners_[i];if(r){i in this.dispatching_||(this.dispatching_[i]=0,this.pendingRemovals_[i]=0),++this.dispatching_[i];for(var a=0,c=r.length;a<c;++a)if(!1===r[a].call(this,e)||e.propagationStopped){n=!1;break}if(--this.dispatching_[i],0===this.dispatching_[i]){var h=this.pendingRemovals_[i];for(delete this.pendingRemovals_[i];h--;)this.removeEventListener(i,o.c);delete this.dispatching_[i]}return n}},e.prototype.disposeInternal=function(){Object(r.d)(this)},e.prototype.getListeners=function(t){return this.listeners_[t]},e.prototype.hasListener=function(t){return t?t in this.listeners_:Object.keys(this.listeners_).length>0},e.prototype.removeEventListener=function(t,e){var i=this.listeners_[t];if(i){var n=i.indexOf(e);t in this.pendingRemovals_?(i[n]=o.c,++this.pendingRemovals_[t]):(i.splice(n,1),0===i.length&&delete this.listeners_[t])}},e}(n.a);e.a=a},function(t,e,i){"use strict";e.a={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"}},function(t,e,i){"use strict";i.d(e,"a",function(){return r}),i.d(e,"b",function(){return o}),i.d(e,"c",function(){return s});var n=i(2);function r(t,e,i,r,s){return!Object(n.s)(s,function(n){return!o(t,e,i,r,n[0],n[1])})}function o(t,e,i,n,r,o){for(var s=0,a=t[i-n],c=t[i-n+1];e<i;e+=n){var h=t[e],l=t[e+1];c<=o?l>o&&(h-a)*(o-c)-(r-a)*(l-c)>0&&s++:l<=o&&(h-a)*(o-c)-(r-a)*(l-c)<0&&s--,a=h,c=l}return 0!==s}function s(t,e,i,n,r,s){if(0===i.length)return!1;if(!o(t,e,i[0],n,r,s))return!1;for(var a=1,c=i.length;a<c;++a)if(o(t,i[a-1],i[a],n,r,s))return!1;return!0}},function(t,e,i){"use strict";e.a={IMAGE:"IMAGE",TILE:"TILE",VECTOR_TILE:"VECTOR_TILE",VECTOR:"VECTOR"}},function(t,e,i){"use strict";e.a={PROPERTYCHANGE:"propertychange"}},function(t,e,i){"use strict";i.d(e,"c",function(){return r}),i.d(e,"d",function(){return o}),i.d(e,"a",function(){return s}),i.d(e,"b",function(){return a});var n=i(5);function r(t,e){return void 0!==t?0:void 0}function o(t,e){return void 0!==t?t+e:void 0}function s(t){var e=2*Math.PI/t;return function(t,i){return void 0!==t?t=Math.floor((t+i)/e+.5)*e:void 0}}function a(t){var e=t||Object(n.j)(5);return function(t,i){return void 0!==t?Math.abs(t+i)<=e?0:t+i:void 0}}},function(t,e,i){"use strict";function n(t,e){return t[0]+=e[0],t[1]+=e[1],t}function r(t,e){for(var i=!0,n=t.length-1;n>=0;--n)if(t[n]!=e[n]){i=!1;break}return i}function o(t,e){var i=Math.cos(e),n=Math.sin(e),r=t[0]*i-t[1]*n,o=t[1]*i+t[0]*n;return t[0]=r,t[1]=o,t}function s(t,e){return t[0]*=e,t[1]*=e,t}i(5),i.d(e,"a",function(){return n}),i.d(e,"b",function(){return r}),i.d(e,"c",function(){return o}),i.d(e,"d",function(){return s})},function(t,e,i){"use strict";function n(t,e,i,n){for(;e<i-n;){for(var r=0;r<n;++r){var o=t[e+r];t[e+r]=t[i-n+r],t[i-n+r]=o}e+=n,i-=n}}function r(t,e,i,n){for(var r=0,o=t[i-n],s=t[i-n+1];e<i;e+=n){var a=t[e],c=t[e+1];r+=(a-o)*(c+s),o=a,s=c}return r>0}function o(t,e,i,n,o){for(var s=void 0!==o&&o,a=0,c=i.length;a<c;++a){var h=i[a],l=r(t,e,h,n);if(0===a){if(s&&l||!s&&!l)return!1}else if(s&&!l||!s&&l)return!1;e=h}return!0}function s(t,e,i,o,s){for(var a=void 0!==s&&s,c=0,h=i.length;c<h;++c){var l=i[c],u=r(t,e,l,o);(0===c?a&&u||!a&&!u:a&&!u||!a&&u)&&n(t,e,l,o),e=l}return e}i.d(e,"a",function(){return r}),i.d(e,"b",function(){return o}),i.d(e,"c",function(){return s})},function(t,e,i){"use strict";var n=i(9),r=function(){};r.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},r.prototype.disposed_=!1,r.prototype.disposeInternal=n.c,e.a=r},function(t,e,i){"use strict";var n=i(9),r=i(2),o=i(58),s=i(27),a=i(26),c=i(10),h=function(t){function e(){t.call(this),this.layout=s.a.XY,this.stride=2,this.flatCoordinates=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeExtent=function(t){return Object(r.n)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinates=function(){},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!=this.getRevision()&&(Object(c.b)(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=t.toString();if(this.simplifiedGeometryCache.hasOwnProperty(e))return this.simplifiedGeometryCache[e];var i=this.getSimplifiedGeometryInternal(t);return i.getFlatCoordinates().length<this.flatCoordinates.length?(this.simplifiedGeometryCache[e]=i,i):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,e){this.stride=l(t),this.layout=t,this.flatCoordinates=e},e.prototype.setCoordinates=function(t,e){},e.prototype.setLayout=function(t,e,i){var n;if(t)n=l(t);else{for(var r=0;r<i;++r){if(0===e.length)return this.layout=s.a.XY,void(this.stride=2);e=e[0]}t=function(t){var e;return 2==t?e=s.a.XY:3==t?e=s.a.XYZ:4==t&&(e=s.a.XYZM),e}(n=e.length)}this.layout=t,this.stride=n},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();Object(a.a)(i,0,i.length,n,t,e,i),this.changed()}},e.prototype.scale=function(t,e,i){var n=e;void 0===n&&(n=t);var o=i;o||(o=Object(r.w)(this.getExtent()));var s=this.getFlatCoordinates();if(s){var c=this.getStride();Object(a.b)(s,0,s.length,c,t,n,o,s),this.changed()}},e.prototype.translate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();Object(a.d)(i,0,i.length,n,t,e,i),this.changed()}},e}(o.a);function l(t){var e;return t==s.a.XY?e=2:t==s.a.XYZ||t==s.a.XYM?e=3:t==s.a.XYZM&&(e=4),e}h.prototype.containsXY=n.a,e.a=h},function(t,e,i){"use strict";e.a={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend"}},function(t,e,i){"use strict";e.a={POSTCOMPOSE:"postcompose",PRECOMPOSE:"precompose",RENDER:"render"}},function(t,e,i){"use strict";i.d(e,"a",function(){return n}),i.d(e,"b",function(){return r});var n=42,r=256},function(t,e,i){"use strict";e.a={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"}},function(t,e,i){"use strict";var n=i(3),r=function(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width,this.checksum_=void 0};r.prototype.clone=function(){var t=this.getColor();return new r({color:t&&t.slice?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},r.prototype.getColor=function(){return this.color_},r.prototype.getLineCap=function(){return this.lineCap_},r.prototype.getLineDash=function(){return this.lineDash_},r.prototype.getLineDashOffset=function(){return this.lineDashOffset_},r.prototype.getLineJoin=function(){return this.lineJoin_},r.prototype.getMiterLimit=function(){return this.miterLimit_},r.prototype.getWidth=function(){return this.width_},r.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},r.prototype.setLineCap=function(t){this.lineCap_=t,this.checksum_=void 0},r.prototype.setLineDash=function(t){this.lineDash_=t,this.checksum_=void 0},r.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t,this.checksum_=void 0},r.prototype.setLineJoin=function(t){this.lineJoin_=t,this.checksum_=void 0},r.prototype.setMiterLimit=function(t){this.miterLimit_=t,this.checksum_=void 0},r.prototype.setWidth=function(t){this.width_=t,this.checksum_=void 0},r.prototype.getChecksum=function(){return void 0===this.checksum_&&(this.checksum_="s",this.color_?"string"==typeof this.color_?this.checksum_+=this.color_:this.checksum_+=Object(n.b)(this.color_).toString():this.checksum_+="-",this.checksum_+=","+(void 0!==this.lineCap_?this.lineCap_.toString():"-")+","+(this.lineDash_?this.lineDash_.toString():"-")+","+(void 0!==this.lineDashOffset_?this.lineDashOffset_:"-")+","+(void 0!==this.lineJoin_?this.lineJoin_:"-")+","+(void 0!==this.miterLimit_?this.miterLimit_.toString():"-")+","+(void 0!==this.width_?this.width_.toString():"-")),this.checksum_},e.a=r},function(t,e,i){"use strict";var n=i(3),r=i(65),o=i.n(r),s=i(2),a=i(10),c=function(t){this.rbush_=o()(t,void 0),this.items_={}};c.prototype.insert=function(t,e){var i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[Object(n.b)(e)]=i},c.prototype.load=function(t,e){for(var i=new Array(e.length),r=0,o=e.length;r<o;r++){var s=t[r],a=e[r],c={minX:s[0],minY:s[1],maxX:s[2],maxY:s[3],value:a};i[r]=c,this.items_[Object(n.b)(a)]=c}this.rbush_.load(i)},c.prototype.remove=function(t){var e=Object(n.b)(t),i=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(i)},c.prototype.update=function(t,e){var i=this.items_[Object(n.b)(e)],r=[i.minX,i.minY,i.maxX,i.maxY];Object(s.o)(r,t)||(this.remove(e),this.insert(t,e))},c.prototype.getAll=function(){return this.rbush_.all().map(function(t){return t.value})},c.prototype.getInExtent=function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(t){return t.value})},c.prototype.forEach=function(t,e){return this.forEach_(this.getAll(),t,e)},c.prototype.forEachInExtent=function(t,e,i){return this.forEach_(this.getInExtent(t),e,i)},c.prototype.forEach_=function(t,e,i){for(var n,r=0,o=t.length;r<o;r++)if(n=e.call(i,t[r]))return n;return n},c.prototype.isEmpty=function(){return Object(a.d)(this.items_)},c.prototype.clear=function(){this.rbush_.clear(),this.items_={}},c.prototype.getExtent=function(t){var e=this.rbush_.data;return Object(s.j)(e.minX,e.minY,e.maxX,e.maxY,t)},c.prototype.concat=function(t){for(var e in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[0|e]=t.items_[0|e]},e.a=c},function(t,e,i){"use strict";i.d(e,"a",function(){return r});var n=function(t,e,i,n){this.minX=t,this.maxX=e,this.minY=i,this.maxY=n};function r(t,e,i,r,o){return void 0!==o?(o.minX=t,o.maxX=e,o.minY=i,o.maxY=r,o):new n(t,e,i,r)}n.prototype.contains=function(t){return this.containsXY(t[1],t[2])},n.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},n.prototype.containsXY=function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY},n.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},n.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},n.prototype.getHeight=function(){return this.maxY-this.minY+1},n.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},n.prototype.getWidth=function(){return this.maxX-this.minX+1},n.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY},e.b=n},function(t,e,i){"use strict";var n=i(11),r=i(32),o=i(4),s=function(t){function e(e){t.call(this),this.highWaterMark=void 0!==e?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},e.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null,this.dispatchEvent(o.a.CLEAR)},e.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)},e.prototype.forEach=function(t,e){for(var i=this.oldest_;i;)t.call(e,i.value_,i.key_,this),i=i.newer},e.prototype.get=function(t){var e=this.entries_[t];return Object(n.a)(void 0!==e,15),e===this.newest_?e.value_:(e===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(e.newer.older=e.older,e.older.newer=e.newer),e.newer=null,e.older=this.newest_,this.newest_.newer=e,this.newest_=e,e.value_)},e.prototype.remove=function(t){var e=this.entries_[t];return Object(n.a)(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_},e.prototype.getCount=function(){return this.count_},e.prototype.getKeys=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.key_;return e},e.prototype.getValues=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.value_;return e},e.prototype.peekLast=function(){return this.oldest_.value_},e.prototype.peekLastKey=function(){return this.oldest_.key_},e.prototype.peekFirstKey=function(){return this.newest_.key_},e.prototype.pop=function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_},e.prototype.replace=function(t,e){this.get(t),this.entries_[t].value_=e},e.prototype.set=function(t,e){Object(n.a)(!(t in this.entries_),16);var i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_},e.prototype.setSize=function(t){this.highWaterMark=t},e.prototype.prune=function(){for(;this.canExpireCache();)this.pop()},e}(r.a);e.a=s},function(t,e,i){"use strict";function n(t,e,i,n){for(var r=0,o=t[i-n],s=t[i-n+1];e<i;e+=n){var a=t[e],c=t[e+1];r+=s*a-o*c,o=a,s=c}return r/2}function r(t,e,i,r){for(var o=0,s=0,a=i.length;s<a;++s){var c=i[s];o+=n(t,e,c,r),e=c}return o}i.d(e,"a",function(){return n}),i.d(e,"b",function(){return r})},function(t,e,i){"use strict";function n(t,e,i,n){for(var r=0,o=i.length;r<o;++r)t[e++]=i[r];return e}function r(t,e,i,n){for(var r=0,o=i.length;r<o;++r)for(var s=i[r],a=0;a<n;++a)t[e++]=s[a];return e}function o(t,e,i,n,o){for(var s=o||[],a=0,c=0,h=i.length;c<h;++c){var l=r(t,e,i[c],n);s[a++]=l,e=l}return s.length=a,s}i.d(e,"a",function(){return n}),i.d(e,"b",function(){return r}),i.d(e,"c",function(){return o})},function(t,e,i){"use strict";i.r(e);var n=i(11),r=i(7),o=i(53),s=i(14),a=i(20),c=i(19),h=(i(22),i(10),i(49)),l=i(6),u=[0,0,0,1],_=[0,0,0,1];new h.a,function(){var t=["monospace","serif"];t.length}(),Object(l.c)();var d=function(t){function e(e){var i=e||{};t.call(this,{points:1/0,fill:i.fill,radius:i.radius,snapToPixel:i.snapToPixel,stroke:i.stroke,atlasManager:i.atlasManager})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),snapToPixel:this.getSnapToPixel(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.setRadius=function(t){this.radius_=t,this.render_(this.atlasManager_)},e}(function(t){function e(e){var i=void 0===e.snapToPixel||e.snapToPixel,n=void 0!==e.rotateWithView&&e.rotateWithView;t.call(this,{opacity:1,rotateWithView:n,rotation:void 0!==e.rotation?e.rotation:0,scale:1,snapToPixel:i}),this.checksums_=null,this.canvas_=null,this.hitDetectionCanvas_=null,this.fill_=void 0!==e.fill?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius_=void 0!==e.radius?e.radius:e.radius1,this.radius2_=e.radius2,this.angle_=void 0!==e.angle?e.angle:0,this.stroke_=void 0!==e.stroke?e.stroke:null,this.anchor_=null,this.size_=null,this.imageSize_=null,this.hitDetectionImageSize_=null,this.atlasManager_=e.atlasManager,this.render_(this.atlasManager_)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),snapToPixel:this.getSnapToPixel(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.getAnchor=function(){return this.anchor_},e.prototype.getAngle=function(){return this.angle_},e.prototype.getFill=function(){return this.fill_},e.prototype.getHitDetectionImage=function(t){return this.hitDetectionCanvas_},e.prototype.getImage=function(t){return this.canvas_},e.prototype.getImageSize=function(){return this.imageSize_},e.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},e.prototype.getImageState=function(){return c.a.LOADED},e.prototype.getOrigin=function(){return this.origin_},e.prototype.getPoints=function(){return this.points_},e.prototype.getRadius=function(){return this.radius_},e.prototype.getRadius2=function(){return this.radius2_},e.prototype.getSize=function(){return this.size_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.listenImageChange=function(t,e){},e.prototype.load=function(){},e.prototype.unlistenImageChange=function(t,e){},e.prototype.render_=function(t){var e,i,n="",r="",c=0,h=null,l=0,u=0;this.stroke_&&(null===(i=this.stroke_.getColor())&&(i=_),i=Object(o.a)(i),void 0===(u=this.stroke_.getWidth())&&(u=1),h=this.stroke_.getLineDash(),l=this.stroke_.getLineDashOffset(),a.a||(h=null,l=0),void 0===(r=this.stroke_.getLineJoin())&&(r="round"),void 0===(n=this.stroke_.getLineCap())&&(n="round"),void 0===(c=this.stroke_.getMiterLimit())&&(c=10));var d=2*(this.radius_+u)+1,p={strokeStyle:i,strokeWidth:u,size:d,lineCap:n,lineDash:h,lineDashOffset:l,lineJoin:r,miterLimit:c};if(void 0===t){var f=Object(s.a)(d,d);this.canvas_=f.canvas,e=d=this.canvas_.width,this.draw_(p,f,0,0),this.createHitDetectionCanvas_(p)}else{d=Math.round(d);var g,v=!this.fill_;v&&(g=this.drawHitDetectionCanvas_.bind(this,p));var m=this.getChecksum(),y=t.add(m,d,d,this.draw_.bind(this,p),g);this.canvas_=y.image,this.origin_=[y.offsetX,y.offsetY],e=y.image.width,v?(this.hitDetectionCanvas_=y.hitImage,this.hitDetectionImageSize_=[y.hitImage.width,y.hitImage.height]):(this.hitDetectionCanvas_=this.canvas_,this.hitDetectionImageSize_=[e,e])}this.anchor_=[d/2,d/2],this.size_=[d,d],this.imageSize_=[e,e]},e.prototype.draw_=function(t,e,i,n){var r,s,a;e.setTransform(1,0,0,1,0,0),e.translate(i,n),e.beginPath();var c=this.points_;if(c===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var h=void 0!==this.radius2_?this.radius2_:this.radius_;for(h!==this.radius_&&(c*=2),r=0;r<=c;r++)s=2*r*Math.PI/c-Math.PI/2+this.angle_,a=r%2==0?this.radius_:h,e.lineTo(t.size/2+a*Math.cos(s),t.size/2+a*Math.sin(s))}if(this.fill_){var l=this.fill_.getColor();null===l&&(l=u),e.fillStyle=Object(o.a)(l),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke()),e.closePath()},e.prototype.createHitDetectionCanvas_=function(t){if(this.hitDetectionImageSize_=[t.size,t.size],this.fill_)this.hitDetectionCanvas_=this.canvas_;else{var e=Object(s.a)(t.size,t.size);this.hitDetectionCanvas_=e.canvas,this.drawHitDetectionCanvas_(t,e,0,0)}},e.prototype.drawHitDetectionCanvas_=function(t,e,i,n){e.setTransform(1,0,0,1,0,0),e.translate(i,n),e.beginPath();var r=this.points_;if(r===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var o,s,a,c=void 0!==this.radius2_?this.radius2_:this.radius_;for(c!==this.radius_&&(r*=2),o=0;o<=r;o++)a=2*o*Math.PI/r-Math.PI/2+this.angle_,s=o%2==0?this.radius_:c,e.lineTo(t.size/2+s*Math.cos(a),t.size/2+s*Math.sin(a))}e.fillStyle=u,e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.stroke()),e.closePath()},e.prototype.getChecksum=function(){var t=this.stroke_?this.stroke_.getChecksum():"-",e=this.fill_?this.fill_.getChecksum():"-";if(!this.checksums_||t!=this.checksums_[1]||e!=this.checksums_[2]||this.radius_!=this.checksums_[3]||this.radius2_!=this.checksums_[4]||this.angle_!=this.checksums_[5]||this.points_!=this.checksums_[6]){var i="r"+t+e+(void 0!==this.radius_?this.radius_.toString():"-")+(void 0!==this.radius2_?this.radius2_.toString():"-")+(void 0!==this.angle_?this.angle_.toString():"-")+(void 0!==this.points_?this.points_.toString():"-");this.checksums_=[i,t,e,this.radius_,this.radius2_,this.angle_,this.points_]}return this.checksums_[0]},e}(i(60).a)),p=i(3),f=i(28),g=function(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.checksum_=void 0};g.prototype.clone=function(){var t=this.getColor();return new g({color:t&&t.slice?t.slice():t||void 0})},g.prototype.getColor=function(){return this.color_},g.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},g.prototype.getChecksum=function(){return void 0===this.checksum_&&(this.color_ instanceof CanvasPattern||this.color_ instanceof CanvasGradient?this.checksum_=Object(p.b)(this.color_).toString():this.checksum_="f"+(this.color_?Object(f.b)(this.color_):"-")),this.checksum_};var v=g,m=i(46);i.d(e,"toFunction",function(){return b}),i.d(e,"createDefaultStyle",function(){return x}),i.d(e,"createEditingStyle",function(){return O});var y=function(t){var e=t||{};this.geometry_=null,this.geometryFunction_=C,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex};function b(t){var e,i;return"function"==typeof t?e=t:(Array.isArray(t)?i=t:(Object(n.a)(t instanceof y,41),i=[t]),e=function(){return i}),e}y.prototype.clone=function(){var t=this.getGeometry();return t&&t.clone&&(t=t.clone()),new y({geometry:t,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},y.prototype.getRenderer=function(){return this.renderer_},y.prototype.setRenderer=function(t){this.renderer_=t},y.prototype.getGeometry=function(){return this.geometry_},y.prototype.getGeometryFunction=function(){return this.geometryFunction_},y.prototype.getFill=function(){return this.fill_},y.prototype.setFill=function(t){this.fill_=t},y.prototype.getImage=function(){return this.image_},y.prototype.setImage=function(t){this.image_=t},y.prototype.getStroke=function(){return this.stroke_},y.prototype.setStroke=function(t){this.stroke_=t},y.prototype.getText=function(){return this.text_},y.prototype.setText=function(t){this.text_=t},y.prototype.getZIndex=function(){return this.zIndex_},y.prototype.setGeometry=function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=C,this.geometry_=t},y.prototype.setZIndex=function(t){this.zIndex_=t};var E=null;function x(t,e){if(!E){var i=new v({color:"rgba(255,255,255,0.4)"}),n=new m.a({color:"#3399CC",width:1.25});E=[new y({image:new d({fill:i,stroke:n,radius:5}),fill:i,stroke:n})]}return E}function O(){var t={},e=[255,255,255,1],i=[0,153,255,1];return t[r.a.POLYGON]=[new y({fill:new v({color:[255,255,255,.5]})})],t[r.a.MULTI_POLYGON]=t[r.a.POLYGON],t[r.a.LINE_STRING]=[new y({stroke:new m.a({color:e,width:5})}),new y({stroke:new m.a({color:i,width:3})})],t[r.a.MULTI_LINE_STRING]=t[r.a.LINE_STRING],t[r.a.CIRCLE]=t[r.a.POLYGON].concat(t[r.a.LINE_STRING]),t[r.a.POINT]=[new y({image:new d({radius:6,fill:new v({color:i}),stroke:new m.a({color:e,width:1.5})}),zIndex:1/0})],t[r.a.MULTI_POINT]=t[r.a.POINT],t[r.a.GEOMETRY_COLLECTION]=t[r.a.POLYGON].concat(t[r.a.LINE_STRING],t[r.a.POINT]),t}function C(t){return t.getGeometry()}e.default=y},function(t,e,i){"use strict";i.d(e,"a",function(){return r});var n=i(28);function r(t){return function(t){return"string"==typeof t||t instanceof CanvasPattern||t instanceof CanvasGradient}(t)?t:Object(n.c)(t)}},function(t,e,i){"use strict";i.d(e,"a",function(){return o}),i.d(e,"b",function(){return s});var n=i(5),r=(i(7),6371008.8);function o(t,e,i){var o=i||r,s=Object(n.j)(t[1]),a=Object(n.j)(e[1]),c=(a-s)/2,h=Object(n.j)(e[0]-t[0])/2,l=Math.sin(c)*Math.sin(c)+Math.sin(h)*Math.sin(h)*Math.cos(s)*Math.cos(a);return 2*o*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}function s(t,e,i,o){var s=o||r,a=Object(n.j)(t[1]),c=Object(n.j)(t[0]),h=e/s,l=Math.asin(Math.sin(a)*Math.cos(h)+Math.cos(a)*Math.sin(h)*Math.cos(i)),u=c+Math.atan2(Math.sin(i)*Math.sin(h)*Math.cos(a),Math.cos(h)-Math.sin(a)*Math.sin(l));return[Object(n.i)(u),Object(n.i)(l)]}},function(t,e,i){"use strict";i.d(e,"a",function(){return s});var n=i(28),r=function(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32};function o(t,e,i){return e+":"+t+":"+(i?Object(n.b)(i):"null")}r.prototype.clear=function(){this.cache_={},this.cacheSize_=0},r.prototype.expire=function(){if(this.cacheSize_>this.maxCacheSize_){var t=0;for(var e in this.cache_){var i=this.cache_[e];0!=(3&t++)||i.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}},r.prototype.get=function(t,e,i){var n=o(t,e,i);return n in this.cache_?this.cache_[n]:null},r.prototype.set=function(t,e,i,n){var r=o(t,e,i);this.cache_[r]=n,++this.cacheSize_},r.prototype.setSize=function(t){this.maxCacheSize_=t,this.expire()};var s=new r},function(t,e,i){"use strict";var n=i(13),r=i(2),o=i(27),s=i(7),a=i(41),c=i(50),h=i(5);function l(t,e,i,n,r,o,s){var a,c=t[e],l=t[e+1],u=t[i]-c,_=t[i+1]-l;if(0===u&&0===_)a=e;else{var d=((r-c)*u+(o-l)*_)/(u*u+_*_);if(d>1)a=i;else{if(d>0){for(var p=0;p<n;++p)s[p]=Object(h.c)(t[e+p],t[i+p],d);return void(s.length=n)}a=e}}for(var f=0;f<n;++f)s[f]=t[a+f];s.length=n}function u(t,e,i,n,r){var o=t[e],s=t[e+1];for(e+=n;e<i;e+=n){var a=t[e],c=t[e+1],l=Object(h.g)(o,s,a,c);l>r&&(r=l),o=a,s=c}return r}function _(t,e,i,n,r,o,s,a,c,u,_){if(e==i)return u;var d,p;if(0===r){if((p=Object(h.g)(s,a,t[e],t[e+1]))<u){for(d=0;d<n;++d)c[d]=t[e+d];return c.length=n,p}return u}for(var f=_||[NaN,NaN],g=e+n;g<i;)if(l(t,g-n,g,n,s,a,f),(p=Object(h.g)(s,a,f[0],f[1]))<u){for(u=p,d=0;d<n;++d)c[d]=f[d];c.length=n,g+=n}else g+=n*Math.max((Math.sqrt(p)-Math.sqrt(u))/r|0,1);if(o&&(l(t,i-n,e,n,s,a,f),(p=Object(h.g)(s,a,f[0],f[1]))<u)){for(u=p,d=0;d<n;++d)c[d]=f[d];c.length=n}return u}var d=i(51);function p(t,e,i,n,r){for(var o=void 0!==r?r:[],s=0,a=e;a<i;a+=n)o[s++]=t.slice(a,a+n);return o.length=s,o}function f(t,e){return e*Math.round(t/e)}function g(t,e,i,n,r,o,s){if(e==i)return s;var a,c,h=f(t[e],r),l=f(t[e+1],r);e+=n,o[s++]=h,o[s++]=l;do{if(a=f(t[e],r),c=f(t[e+1],r),(e+=n)==i)return o[s++]=a,o[s++]=c,s}while(a==h&&c==l);for(;e<i;){var u=f(t[e],r),_=f(t[e+1],r);if(e+=n,u!=a||_!=c){var d=a-h,p=c-l,g=u-h,v=_-l;d*v==p*g&&(d<0&&g<d||d==g||d>0&&g>d)&&(p<0&&v<p||p==v||p>0&&v>p)?(a=u,c=_):(o[s++]=a,o[s++]=c,h=a,l=c,a=u,c=_)}}return o[s++]=a,o[s++]=c,s}var v=function(t){function e(e,i){t.call(this),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===i||Array.isArray(e[0])?this.setCoordinates(e,i):this.setFlatCoordinates(i,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){return n<Object(r.e)(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(u(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.getArea=function(){return Object(c.a)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return p(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=function(t,e,i,n,r,o,s){var a=(i-e)/n;if(a<3){for(;e<i;e+=n)o[s++]=t[e],o[s++]=t[e+1];return s}var c=new Array(a);c[0]=1,c[a-1]=1;for(var l=[e,i-n],u=0;l.length>0;){for(var _=l.pop(),d=l.pop(),p=0,f=t[d],g=t[d+1],v=t[_],m=t[_+1],y=d+n;y<_;y+=n){var b=t[y],E=t[y+1],x=Object(h.h)(b,E,f,g,v,m);x>p&&(u=y,p=x)}p>r&&(c[(u-e)/n]=1,d+n<u&&l.push(d,u),u+n<_&&l.push(u,_))}for(var O=0;O<a;++O)c[O]&&(o[s++]=t[e+O*n],o[s++]=t[e+O*n+1]);return s}(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,o.a.XY)},e.prototype.getType=function(){return s.a.LINEAR_RING},e.prototype.intersectsExtent=function(t){},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Object(d.b)(this.flatCoordinates,0,t,this.stride),this.changed()},e}(a.a),m=i(63),y=(i(54),i(34));function b(t,e,i,n,o){var s=Object(r.r)(Object(r.i)(),t,e,i,n);return!!Object(r.E)(o,s)&&(!!Object(r.g)(o,s)||s[0]>=o[0]&&s[2]<=o[2]||s[1]>=o[1]&&s[3]<=o[3]||function(t,e,i,n,r,o){for(var s,a=[t[e],t[e+1]],c=[];e+n<i;e+=n){if(c[0]=t[e+n],c[1]=t[e+n+1],s=r.call(void 0,a,c))return s;a[0]=c[0],a[1]=c[1]}return!1}(t,e,i,n,function(t,e){return Object(r.F)(o,t,e)}))}var E=i(39);i.d(e,"b",function(){return O});var x=function(t){function e(e,i,n){t.call(this),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==i&&n?(this.setFlatCoordinates(i,e),this.ends_=n):this.setCoordinates(e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.appendLinearRing=function(t){this.flatCoordinates?Object(n.b)(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},e.prototype.closestPointXY=function(t,e,i,n){return n<Object(r.e)(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o];r=u(t,e,a,n,r),e=a}return r}(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,i,n,r,o,s,a,c,h,l){for(var u=l||[NaN,NaN],d=0,p=i.length;d<p;++d){var f=i[d];h=_(t,e,f,n,r,o,s,a,c,h,u),e=f}return h}(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.containsXY=function(t,e){return Object(y.c)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)},e.prototype.getArea=function(){return Object(c.b)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),Object(E.c)(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,function(t,e,i,n,r){for(var o=void 0!==r?r:[],s=0,a=0,c=i.length;a<c;++a){var h=i[a];o[s++]=p(t,e,h,n,o[s]),e=h}return o.length=s,o}(e,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=Object(r.w)(this.getExtent());this.flatInteriorPoint_=function(t,e,i,r,o,s,a){for(var c,h,l,u,_,d,p,f=o[s+1],g=[],v=0,m=i.length;v<m;++v){var b=i[v];for(u=t[b-r],d=t[b-r+1],c=e;c<b;c+=r)_=t[c],p=t[c+1],(f<=d&&p<=f||d<=f&&f<=p)&&(l=(f-d)/(p-d)*(_-u)+u,g.push(l)),u=_,d=p}var E=NaN,x=-1/0;for(g.sort(n.f),u=g[0],c=1,h=g.length;c<h;++c){_=g[c];var O=Math.abs(_-u);O>x&&(l=(u+_)/2,Object(y.c)(t,e,i,r,l,f)&&(E=l,x=O)),u=_}return isNaN(E)&&(E=o[s]),a?(a.push(E,f,x),a):[E,f,x]}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new m.default(this.getFlatInteriorPoint(),o.a.XYM)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new v(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[],r=0,o=0,s=i.length;o<s;++o){var a=i[o],c=new v(e.slice(r,a),t);n.push(c),r=a}return n},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;Object(E.b)(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Object(E.c)(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=function(t,e,i,n,r,o,s,a){for(var c=0,h=i.length;c<h;++c){var l=i[c];s=g(t,e,l,n,r,o,s),a.push(s),e=l}return s}(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),i,0,n),new e(i,o.a.XY,n)},e.prototype.getType=function(){return s.a.POLYGON},e.prototype.intersectsExtent=function(t){return function(t,e,i,n,r){if(!function(t,e,i,n,r){return!!(b(t,e,i,n,r)||Object(y.b)(t,e,i,n,r[0],r[1])||Object(y.b)(t,e,i,n,r[0],r[3])||Object(y.b)(t,e,i,n,r[2],r[1])||Object(y.b)(t,e,i,n,r[2],r[3]))}(t,e,i[0],n,r))return!1;if(1===i.length)return!0;for(var o=1,s=i.length;o<s;++o)if(Object(y.a)(t,i[o-1],i[o],n,r))return!1;return!0}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=Object(d.c)(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},e}(a.a);function O(t){var e=t[0],i=t[1],n=t[2],r=t[3],s=[e,i,e,r,n,r,n,i,e,i];return new x(s,o.a.XY,[s.length])}e.a=x},function(t,e,i){"use strict";var n=i(1),r=i(32),o=i(4),s=function(t){function e(){t.call(this),this.revision_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.changed=function(){++this.revision_,this.dispatchEvent(o.a.CHANGE)},e.prototype.getRevision=function(){return this.revision_},e.prototype.on=function(t,e){if(Array.isArray(t)){for(var i=t.length,r=new Array(i),o=0;o<i;++o)r[o]=Object(n.a)(this,t[o],e);return r}return Object(n.a)(this,t,e)},e.prototype.once=function(t,e){if(Array.isArray(t)){for(var i=t.length,r=new Array(i),o=0;o<i;++o)r[o]=Object(n.b)(this,t[o],e);return r}return Object(n.b)(this,t,e)},e.prototype.un=function(t,e){if(Array.isArray(t))for(var i=0,r=t.length;i<r;++i)Object(n.c)(this,t[i],e);else Object(n.c)(this,t,e)},e}(r.a);e.a=s},function(t,e,i){"use strict";var n=i(12),r=i(2),o=i(9),s=i(26),a=i(16),c=i(18),h=i(6),l=Object(h.c)(),u=function(t){function e(){t.call(this),this.extent_=Object(r.i)(),this.extentRevision_=-1,this.simplifiedGeometryCache={},this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){},e.prototype.closestPointXY=function(t,e,i,n){},e.prototype.getClosestPoint=function(t,e){var i=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],i,1/0),i},e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},e.prototype.computeExtent=function(t){},e.prototype.getExtent=function(t){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),Object(r.H)(this.extent_,t)},e.prototype.rotate=function(t,e){},e.prototype.scale=function(t,e,i){},e.prototype.translate=function(t,e){},e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},e.prototype.getSimplifiedGeometry=function(t){},e.prototype.getType=function(){},e.prototype.applyTransform=function(t){},e.prototype.intersectsExtent=function(t){},e.prototype.translate=function(t,e){},e.prototype.transform=function(t,e){var i=(t=Object(a.get)(t)).getUnits()==c.b.TILE_PIXELS?function(i,n,o){var c=t.getExtent(),u=t.getWorldExtent(),_=Object(r.z)(u)/Object(r.z)(c);return Object(h.b)(l,u[0],u[3],_,-_,0,0,0),Object(s.c)(i,0,i.length,o,l,n),Object(a.getTransform)(t,e)(i,n,o)}:Object(a.getTransform)(t,e);return this.applyTransform(i),this},e}(n.a);u.prototype.containsXY=o.a,e.a=u},function(t,e,i){"use strict";var n=i(3),r=function(t){function e(e){var i="Assertion failed. See https://openlayers.org/en/"+n.a.split("-")[0]+"/doc/errors/#"+e+" for details.";t.call(this,i),this.code=e,this.name="AssertionError",this.message=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error);e.a=r},function(t,e,i){"use strict";var n=function(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.snapToPixel_=t.snapToPixel};n.prototype.getOpacity=function(){return this.opacity_},n.prototype.getRotateWithView=function(){return this.rotateWithView_},n.prototype.getRotation=function(){return this.rotation_},n.prototype.getScale=function(){return this.scale_},n.prototype.getSnapToPixel=function(){return this.snapToPixel_},n.prototype.getAnchor=function(){},n.prototype.getImage=function(t){},n.prototype.getHitDetectionImage=function(t){},n.prototype.getImageState=function(){},n.prototype.getImageSize=function(){},n.prototype.getHitDetectionImageSize=function(){},n.prototype.getOrigin=function(){},n.prototype.getSize=function(){},n.prototype.setOpacity=function(t){this.opacity_=t},n.prototype.setRotateWithView=function(t){this.rotateWithView_=t},n.prototype.setRotation=function(t){this.rotation_=t},n.prototype.setScale=function(t){this.scale_=t},n.prototype.setSnapToPixel=function(t){this.snapToPixel_=t},n.prototype.listenImageChange=function(t,e){},n.prototype.load=function(){},n.prototype.unlistenImageChange=function(t,e){},e.a=n},function(t,e,i){"use strict";var n=i(12),r=i(21),o=i(5),s=i(10),a=function(t){function e(e){t.call(this);var i=Object(s.a)({},e);i[r.a.OPACITY]=void 0!==e.opacity?e.opacity:1,i[r.a.VISIBLE]=void 0===e.visible||e.visible,i[r.a.Z_INDEX]=void 0!==e.zIndex?e.zIndex:0,i[r.a.MAX_RESOLUTION]=void 0!==e.maxResolution?e.maxResolution:1/0,i[r.a.MIN_RESOLUTION]=void 0!==e.minResolution?e.minResolution:0,this.setProperties(i),this.state_={layer:this,managed:!0},this.type}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getType=function(){return this.type},e.prototype.getLayerState=function(){return this.state_.opacity=Object(o.a)(this.getOpacity(),0,1),this.state_.sourceState=this.getSourceState(),this.state_.visible=this.getVisible(),this.state_.extent=this.getExtent(),this.state_.zIndex=this.getZIndex(),this.state_.maxResolution=this.getMaxResolution(),this.state_.minResolution=Math.max(this.getMinResolution(),0),this.state_},e.prototype.getLayersArray=function(t){},e.prototype.getLayerStatesArray=function(t){},e.prototype.getExtent=function(){return this.get(r.a.EXTENT)},e.prototype.getMaxResolution=function(){return this.get(r.a.MAX_RESOLUTION)},e.prototype.getMinResolution=function(){return this.get(r.a.MIN_RESOLUTION)},e.prototype.getOpacity=function(){return this.get(r.a.OPACITY)},e.prototype.getSourceState=function(){},e.prototype.getVisible=function(){return this.get(r.a.VISIBLE)},e.prototype.getZIndex=function(){return this.get(r.a.Z_INDEX)},e.prototype.setExtent=function(t){this.set(r.a.EXTENT,t)},e.prototype.setMaxResolution=function(t){this.set(r.a.MAX_RESOLUTION,t)},e.prototype.setMinResolution=function(t){this.set(r.a.MIN_RESOLUTION,t)},e.prototype.setOpacity=function(t){this.set(r.a.OPACITY,t)},e.prototype.setVisible=function(t){this.set(r.a.VISIBLE,t)},e.prototype.setZIndex=function(t){this.set(r.a.Z_INDEX,t)},e}(n.a);e.a=a},function(t,e,i){"use strict";var n=i(9),r=i(12),o=i(16),s=i(33),a=function(t){function e(e){t.call(this),this.projection_=Object(o.get)(e.projection),this.attributions_=this.adaptAttributions_(e.attributions),this.state_=void 0!==e.state?e.state:s.a.READY,this.wrapX_=void 0!==e.wrapX&&e.wrapX}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.adaptAttributions_=function(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null},e.prototype.getAttributions=function(){return this.attributions_},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolutions=function(){},e.prototype.getState=function(){return this.state_},e.prototype.getWrapX=function(){return this.wrapX_},e.prototype.refresh=function(){this.changed()},e.prototype.setAttributions=function(t){this.attributions_=this.adaptAttributions_(t),this.changed()},e.prototype.setState=function(t){this.state_=t,this.changed()},e}(r.a);a.prototype.forEachFeatureAtCoordinate=n.c,e.a=a},function(t,e,i){"use strict";i.r(e);var n=i(2),r=i(7),o=i(41),s=i(51),a=i(5),c=function(t){function e(e,i){t.call(this),this.setCoordinates(e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){var r=this.flatCoordinates,o=Object(a.g)(t,e,r[0],r[1]);if(o<n){for(var s=this.stride,c=0;c<s;++c)i[c]=r[c];return i.length=s,o}return n},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return Object(n.l)(this.flatCoordinates,t)},e.prototype.getType=function(){return r.a.POINT},e.prototype.intersectsExtent=function(t){return Object(n.h)(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Object(s.a)(this.flatCoordinates,0,t,this.stride),this.changed()},e}(o.a);e.default=c},function(t,e,i){"use strict";i.r(e);var n=i(44),r=i(3),o=i(9),s=i(5);function a(t){return t}var c=i(12),h=i(13),l=i(37),u=i(15),_="center",d="resolution",p="rotation",f=i(11),g=i(38),v=i(24),m=i(2),y=i(7),b=i(56),E=i(41),x=i(10),O=i(16),C=i(18);i.d(e,"createCenterConstraint",function(){return R}),i.d(e,"createResolutionConstraint",function(){return M}),i.d(e,"createRotationConstraint",function(){return P}),i.d(e,"isNoopAnimation",function(){return I});var T=0,w=function(t){function e(e){t.call(this);var i=Object(x.a)({},e);this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.updateAnimations_=this.updateAnimations_.bind(this),this.projection_=Object(O.createProjection)(i.projection,"EPSG:3857"),this.applyOptions_(i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.applyOptions_=function(t){var e={};e[_]=void 0!==t.center?t.center:null;var i=M(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.minZoom_=i.minZoom;var n=R(t),r=i.constraint,o=P(t);this.constraints_={center:n,resolution:r,rotation:o},void 0!==t.resolution?e[d]=t.resolution:void 0!==t.zoom&&(e[d]=this.constrainResolution(this.maxResolution_,t.zoom-this.minZoom_),this.resolutions_&&(e[d]=Object(s.a)(Number(this.getResolution()||e[d]),this.minResolution_,this.maxResolution_))),e[p]=void 0!==t.rotation?t.rotation:0,this.setProperties(e),this.options_=t},e.prototype.getUpdatedOptions_=function(t){var e=Object(x.a)({},this.options_);return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenter(),e.rotation=this.getRotation(),Object(x.a)({},e,t)},e.prototype.animate=function(t){var e,i=arguments,n=arguments.length;if(n>1&&"function"==typeof arguments[n-1]&&(e=arguments[n-1],--n),!this.isDef()){var r=arguments[n-1];return r.center&&this.setCenter(r.center),void 0!==r.zoom&&this.setZoom(r.zoom),void 0!==r.rotation&&this.setRotation(r.rotation),void(e&&setTimeout(function(){e(!0)},0))}for(var o=Date.now(),a=this.getCenter().slice(),c=this.getResolution(),h=this.getRotation(),l=[],_=0;_<n;++_){var d=i[_],p={start:o,complete:!1,anchor:d.anchor,duration:void 0!==d.duration?d.duration:1e3,easing:d.easing||v.c};if(d.center&&(p.sourceCenter=a,p.targetCenter=d.center,a=p.targetCenter),void 0!==d.zoom?(p.sourceResolution=c,p.targetResolution=this.constrainResolution(this.maxResolution_,d.zoom-this.minZoom_,0),c=p.targetResolution):d.resolution&&(p.sourceResolution=c,p.targetResolution=d.resolution,c=p.targetResolution),void 0!==d.rotation){p.sourceRotation=h;var f=Object(s.d)(d.rotation-h+Math.PI,2*Math.PI)-Math.PI;p.targetRotation=h+f,h=p.targetRotation}p.callback=e,I(p)?p.complete=!0:o+=p.duration,l.push(p)}this.animations_.push(l),this.setHint(u.a.ANIMATING,1),this.updateAnimations_()},e.prototype.getAnimating=function(){return this.hints_[u.a.ANIMATING]>0},e.prototype.getInteracting=function(){return this.hints_[u.a.INTERACTING]>0},e.prototype.cancelAnimations=function(){this.setHint(u.a.ANIMATING,-this.hints_[u.a.ANIMATING]);for(var t=0,e=this.animations_.length;t<e;++t){var i=this.animations_[t];i[0].callback&&i[0].callback(!1)}this.animations_.length=0},e.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),e=!1,i=this.animations_.length-1;i>=0;--i){for(var n=this.animations_[i],r=!0,o=0,a=n.length;o<a;++o){var c=n[o];if(!c.complete){var h=t-c.start,l=c.duration>0?h/c.duration:1;l>=1?(c.complete=!0,l=1):r=!1;var f=c.easing(l);if(c.sourceCenter){var g=c.sourceCenter[0],v=c.sourceCenter[1],m=g+f*(c.targetCenter[0]-g),y=v+f*(c.targetCenter[1]-v);this.set(_,[m,y])}if(c.sourceResolution&&c.targetResolution){var b=1===f?c.targetResolution:c.sourceResolution+f*(c.targetResolution-c.sourceResolution);c.anchor&&this.set(_,this.calculateCenterZoom(b,c.anchor)),this.set(d,b)}if(void 0!==c.sourceRotation&&void 0!==c.targetRotation){var E=1===f?Object(s.d)(c.targetRotation+Math.PI,2*Math.PI)-Math.PI:c.sourceRotation+f*(c.targetRotation-c.sourceRotation);c.anchor&&this.set(_,this.calculateCenterRotate(E,c.anchor)),this.set(p,E)}if(e=!0,!c.complete)break}}if(r){this.animations_[i]=null,this.setHint(u.a.ANIMATING,-1);var x=n[0].callback;x&&setTimeout(function(){x(!0)},0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_))}},e.prototype.calculateCenterRotate=function(t,e){var i,n=this.getCenter();return void 0!==n&&(i=[n[0]-e[0],n[1]-e[1]],Object(g.c)(i,t-this.getRotation()),Object(g.a)(i,e)),i},e.prototype.calculateCenterZoom=function(t,e){var i,n=this.getCenter(),r=this.getResolution();return void 0!==n&&void 0!==r&&(i=[e[0]-t*(e[0]-n[0])/r,e[1]-t*(e[1]-n[1])/r]),i},e.prototype.getSizeFromViewport_=function(){var t=[100,100],e='.ol-viewport[data-view="'+Object(r.b)(this)+'"]',i=document.querySelector(e);if(i){var n=getComputedStyle(i);t[0]=parseInt(n.width,10),t[1]=parseInt(n.height,10)}return t},e.prototype.constrainCenter=function(t){return this.constraints_.center(t)},e.prototype.constrainResolution=function(t,e,i){var n=e||0,r=i||0;return this.constraints_.resolution(t,n,r)},e.prototype.constrainRotation=function(t,e){var i=e||0;return this.constraints_.rotation(t,i)},e.prototype.getCenter=function(){return this.get(_)},e.prototype.getConstraints=function(){return this.constraints_},e.prototype.getHints=function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},e.prototype.calculateExtent=function(t){var e=t||this.getSizeFromViewport_(),i=this.getCenter();Object(f.a)(i,1);var n=this.getResolution();Object(f.a)(void 0!==n,2);var r=this.getRotation();return Object(f.a)(void 0!==r,3),Object(m.y)(i,n,r,e)},e.prototype.getMaxResolution=function(){return this.maxResolution_},e.prototype.getMinResolution=function(){return this.minResolution_},e.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},e.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},e.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},e.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolution=function(){return this.get(d)},e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.getResolutionForExtent=function(t,e){var i=e||this.getSizeFromViewport_(),n=Object(m.D)(t)/i[0],r=Object(m.z)(t)/i[1];return Math.max(n,r)},e.prototype.getResolutionForValueFunction=function(t){var e=t||2,i=this.maxResolution_,n=this.minResolution_,r=Math.log(i/n)/Math.log(e);return function(t){return i/Math.pow(e,t*r)}},e.prototype.getRotation=function(){return this.get(p)},e.prototype.getValueForResolutionFunction=function(t){var e=t||2,i=this.maxResolution_,n=this.minResolution_,r=Math.log(i/n)/Math.log(e);return function(t){return Math.log(i/t)/Math.log(e)/r}},e.prototype.getState=function(){var t=this.getCenter(),e=this.getProjection(),i=this.getResolution(),n=this.getRotation();return{center:t.slice(),projection:void 0!==e?e:null,resolution:i,rotation:n,zoom:this.getZoom()}},e.prototype.getZoom=function(){var t,e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t},e.prototype.getZoomForResolution=function(t){var e,i,n=this.minZoom_||0;if(this.resolutions_){var r=Object(h.e)(this.resolutions_,t,1);n=r,e=this.resolutions_[r],i=r==this.resolutions_.length-1?2:e/this.resolutions_[r+1]}else e=this.maxResolution_,i=this.zoomFactor_;return n+Math.log(e/t)/Math.log(i)},e.prototype.getResolutionForZoom=function(t){return this.constrainResolution(this.maxResolution_,t-this.minZoom_,0)},e.prototype.fit=function(t,e){var i,n=e||{},r=n.size;r||(r=this.getSizeFromViewport_()),t instanceof E.a?t.getType()===y.a.CIRCLE?(t=t.getExtent(),(i=Object(b.b)(t)).rotate(this.getRotation(),Object(m.w)(t))):i=t:(Object(f.a)(Array.isArray(t),24),Object(f.a)(!Object(m.G)(t),25),i=Object(b.b)(t));var s,a=void 0!==n.padding?n.padding:[0,0,0,0],c=void 0===n.constrainResolution||n.constrainResolution,h=void 0!==n.nearest&&n.nearest;s=void 0!==n.minResolution?n.minResolution:void 0!==n.maxZoom?this.constrainResolution(this.maxResolution_,n.maxZoom-this.minZoom_,0):0;for(var l=i.getFlatCoordinates(),u=this.getRotation(),_=Math.cos(-u),d=Math.sin(-u),p=1/0,g=1/0,v=-1/0,x=-1/0,O=i.getStride(),C=0,T=l.length;C<T;C+=O){var w=l[C]*_-l[C+1]*d,R=l[C]*d+l[C+1]*_;p=Math.min(p,w),g=Math.min(g,R),v=Math.max(v,w),x=Math.max(x,R)}var M=this.getResolutionForExtent([p,g,v,x],[r[0]-a[1]-a[3],r[1]-a[0]-a[2]]);if(M=isNaN(M)?s:Math.max(M,s),c){var P=this.constrainResolution(M,0,0);!h&&P<M&&(P=this.constrainResolution(P,-1,0)),M=P}d=-d;var I=(p+v)/2,D=(g+x)/2,L=[(I+=(a[1]-a[3])/2*M)*_-(D+=(a[0]-a[2])/2*M)*d,D*_+I*d],S=n.callback?n.callback:o.c;void 0!==n.duration?this.animate({resolution:M,center:L,duration:n.duration,easing:n.easing},S):(this.setResolution(M),this.setCenter(L),setTimeout(S.bind(void 0,!0),0))},e.prototype.centerOn=function(t,e,i){var n=this.getRotation(),r=Math.cos(-n),o=Math.sin(-n),s=t[0]*r-t[1]*o,a=t[1]*r+t[0]*o,c=this.getResolution(),h=(s+=(e[0]/2-i[0])*c)*r-(a+=(i[1]-e[1]/2)*c)*(o=-o),l=a*r+s*o;this.setCenter([h,l])},e.prototype.isDef=function(){return!!this.getCenter()&&void 0!==this.getResolution()},e.prototype.rotate=function(t,e){if(void 0!==e){var i=this.calculateCenterRotate(t,e);this.setCenter(i)}this.setRotation(t)},e.prototype.setCenter=function(t){this.set(_,t),this.getAnimating()&&this.cancelAnimations()},e.prototype.setHint=function(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]},e.prototype.setResolution=function(t){this.set(d,t),this.getAnimating()&&this.cancelAnimations()},e.prototype.setRotation=function(t){this.set(p,t),this.getAnimating()&&this.cancelAnimations()},e.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},e}(c.a);function R(t){return void 0!==t.extent?function(t){return function(e){return e?[Object(s.a)(e[0],t[0],t[2]),Object(s.a)(e[1],t[1],t[3])]:void 0}}(t.extent):a}function M(t){var e,i,r,o=void 0!==t.minZoom?t.minZoom:T,a=void 0!==t.maxZoom?t.maxZoom:28,c=void 0!==t.zoomFactor?t.zoomFactor:2;if(void 0!==t.resolutions){var l=t.resolutions;i=l[o],r=void 0!==l[a]?l[a]:l[l.length-1],e=function(t){return function(e,i,n){if(void 0!==e){var r=Object(h.e)(t,e,n);r=Object(s.a)(r+i,0,t.length-1);var o=Math.floor(r);if(r!=o&&o<t.length-1){var a=t[o]/t[o+1];return t[o]/Math.pow(a,r-o)}return t[o]}}}(l)}else{var u=Object(O.createProjection)(t.projection,"EPSG:3857"),_=u.getExtent(),d=(_?Math.max(Object(m.D)(_),Object(m.z)(_)):360*C.a[C.b.DEGREES]/u.getMetersPerUnit())/n.b/Math.pow(2,T),p=d/Math.pow(2,28-T);void 0!==(i=t.maxResolution)?o=0:i=d/Math.pow(c,o),void 0===(r=t.minResolution)&&(r=void 0!==t.maxZoom?void 0!==t.maxResolution?i/Math.pow(c,a):d/Math.pow(c,a):p),a=o+Math.floor(Math.log(i/r)/Math.log(c)),r=i/Math.pow(c,a-o),e=function(t,e,i){return function(n,r,o){if(void 0!==n){var s=-o/2+.5,a=Math.floor(Math.log(e/n)/Math.log(t)+s),c=Math.max(a+r,0);return void 0!==i&&(c=Math.min(c,i)),e/Math.pow(t,c)}}}(c,i,a-o)}return{constraint:e,maxResolution:i,minResolution:r,minZoom:o,zoomFactor:c}}function P(t){if(void 0===t.enableRotation||t.enableRotation){var e=t.constrainRotation;return void 0===e||!0===e?Object(l.b)():!1===e?l.d:"number"==typeof e?Object(l.a)(e):l.d}return l.c}function I(t){return!(t.sourceCenter&&t.targetCenter&&!Object(g.b)(t.sourceCenter,t.targetCenter))&&t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation}e.default=w},function(t,e,i){"use strict";t.exports=r,t.exports.default=r;var n=i(76);function r(t,e){if(!(this instanceof r))return new r(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function o(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function s(t,e){a(t,0,t.children.length,e,t)}function a(t,e,i,n,r){r||(r=v(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,s=e;s<i;s++)o=t.children[s],c(r,t.leaf?n(o):o);return r}function c(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function h(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function u(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function _(t){return t.maxX-t.minX+(t.maxY-t.minY)}function d(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function p(t,e){var i=Math.max(t.minX,e.minX),n=Math.max(t.minY,e.minY),r=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,r-i)*Math.max(0,o-n)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function g(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function v(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(t,e,i,r,o){for(var s,a=[e,i];a.length;)(i=a.pop())-(e=a.pop())<=r||(s=e+Math.ceil((i-e)/r/2)*r,n(t,s,e,i,o),a.push(e,s,s,i))}r.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],n=this.toBBox;if(!g(t,e))return i;for(var r,o,s,a,c=[];e;){for(r=0,o=e.children.length;r<o;r++)s=e.children[r],g(t,a=e.leaf?n(s):s)&&(e.leaf?i.push(s):f(t,a)?this._all(s,i):c.push(s));e=c.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!g(t,e))return!1;for(var n,r,o,s,a=[];e;){for(n=0,r=e.children.length;n<r;n++)if(o=e.children[n],g(t,s=e.leaf?i(o):o)){if(e.leaf||f(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=v([]),this},remove:function(t,e){if(!t)return this;for(var i,n,r,s,a=this.data,c=this.toBBox(t),h=[],l=[];a||h.length;){if(a||(a=h.pop(),n=h[h.length-1],i=l.pop(),s=!0),a.leaf&&-1!==(r=o(t,a.children,e)))return a.children.splice(r,1),h.push(a),this._condense(h),this;s||a.leaf||!f(a,c)?n?(i++,a=n.children[i],s=!1):a=null:(h.push(a),l.push(i),i=0,n=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:h,compareMinY:l,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,n){var r,o=i-e+1,a=this._maxEntries;if(o<=a)return s(r=v(t.slice(e,i+1)),this.toBBox),r;n||(n=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,n-1))),(r=v([])).leaf=!1,r.height=n;var c,h,l,u,_=Math.ceil(o/a),d=_*Math.ceil(Math.sqrt(a));for(m(t,e,i,d,this.compareMinX),c=e;c<=i;c+=d)for(m(t,c,l=Math.min(c+d-1,i),_,this.compareMinY),h=c;h<=l;h+=_)u=Math.min(h+_-1,l),r.children.push(this._build(t,h,u,n-1));return s(r,this.toBBox),r},_chooseSubtree:function(t,e,i,n){for(var r,o,s,a,c,h,l,_;n.push(e),!e.leaf&&n.length-1!==i;){for(l=_=1/0,r=0,o=e.children.length;r<o;r++)c=u(s=e.children[r]),(h=d(t,s)-c)<_?(_=h,l=c<l?c:l,a=s):h===_&&c<l&&(l=c,a=s);e=a||e.children[0]}return e},_insert:function(t,e,i){var n=this.toBBox,r=i?t:n(t),o=[],s=this._chooseSubtree(r,this.data,e,o);for(s.children.push(t),c(s,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var i=t[e],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);var o=this._chooseSplitIndex(i,r,n),a=v(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,s(i,this.toBBox),s(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)},_splitRoot:function(t,e){this.data=v([t,e]),this.data.height=t.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var n,r,o,s,c,h,l,_;for(h=l=1/0,n=e;n<=i-e;n++)s=p(r=a(t,0,n,this.toBBox),o=a(t,n,i,this.toBBox)),c=u(r)+u(o),s<h?(h=s,_=n,l=c<l?c:l):s===h&&c<l&&(l=c,_=n);return _},_chooseSplitAxis:function(t,e,i){var n=t.leaf?this.compareMinX:h,r=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)},_allDistMargin:function(t,e,i,n){t.children.sort(n);var r,o,s=this.toBBox,h=a(t,0,e,s),l=a(t,i-e,i,s),u=_(h)+_(l);for(r=e;r<i-e;r++)o=t.children[r],c(h,t.leaf?s(o):o),u+=_(h);for(r=i-e-1;r>=e;r--)o=t.children[r],c(l,t.leaf?s(o):o),u+=_(l);return u},_adjustParentBBoxes:function(t,e,i){for(var n=i;n>=0;n--)c(e[n],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():s(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},,,,,,,,,function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(75),r=i(82),o=i(63),s=i(16),a=i(83),c=i(86),h=i(87),l=i(88),u=i(84),_=i(64),d=i(77),p=i(80),f=new u.default({}),g=new h.default({source:f}),v=[new c.default({source:new a.default({layer:"toner-background"})}),g],m=new _.default({center:s.fromLonLat([0,50]),zoom:4});e.default=class{constructor(t){this.events=[],this.visibleEvents=[],this.handleClick=(t=>{var e=this.map.getFeaturesAtPixel(t.pixel);e&&(e.forEach((t,e)=>{console.log(`[Feat props][${e+1}]`,t.getProperties())}),1===e.length&&this.popup.show(e[0]))});const e=new l.default({autoPan:!0,autoPanAnimation:{duration:250,source:null}});this.popup=new d.default(e),e.setElement(this.popup.el);const i=[e];this.map=new r.default({target:t.target,layers:v,overlays:i,view:m}),this.updateFeatures(),this.map.on("click",this.handleClick)}updateFeatures(){this.popup.hide();const t=this.visibleEvents.reduce((t,e)=>null==e.locations?t:(e.locations.forEach(i=>{const r=JSON.parse(i.f1),a=new n.default({geometry:new o.default(s.transform(r.coordinates,"EPSG:4326","EPSG:3857")),coordinates:r,date:i.f2,end_date:i.f3,event:e});let c;e.tags.indexOf("battle")>-1?(c=p.battleIconStyle,e.tags.indexOf("aerial battle")>-1&&(c=p.aerialBattleIconStyle)):e.tags.indexOf("human")>-1&&(e.date===i.f2||e.date_min===i.f2)?c=p.birthIconStyle:e.tags.indexOf("human")>-1&&e.end_date===i.f2&&(c=p.deathIconStyle),a.setStyle(c),t.push(a)}),t),[]);f.clear(),f.addFeatures(t)}onSelect(t){const e=f.getFeatures().find(e=>e.getProperties().event.id===t.id);console.log(e),e&&this.popup.show(e)}setVisibleEvents(t){this.visibleEvents=t,this.updateFeatures()}updateSize(){this.map.updateSize()}}},function(t,e,i){"use strict";i.r(e),i.d(e,"createStyleFunction",function(){return l});var n=i(11),r=i(1),o=i(4),s=i(12),a=i(58),c=i(52),h=function(t){function e(e){if(t.call(this),this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,Object(r.a)(this,Object(s.b)(this.geometryName_),this.handleGeometryChanged_,this),void 0!==e)if(e instanceof a.a||!e){var i=e;this.setGeometry(i)}else{var n=e;this.setProperties(n)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e(this.getProperties());t.setGeometryName(this.getGeometryName());var i=this.getGeometry();i&&t.setGeometry(i.clone());var n=this.getStyle();return n&&t.setStyle(n),t},e.prototype.getGeometry=function(){return this.get(this.geometryName_)},e.prototype.getId=function(){return this.id_},e.prototype.getGeometryName=function(){return this.geometryName_},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.handleGeometryChange_=function(){this.changed()},e.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(Object(r.e)(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=Object(r.a)(t,o.a.CHANGE,this.handleGeometryChange_,this)),this.changed()},e.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},e.prototype.setStyle=function(t){this.style_=t,this.styleFunction_=t?l(t):void 0,this.changed()},e.prototype.setId=function(t){this.id_=t,this.changed()},e.prototype.setGeometryName=function(t){Object(r.c)(this,Object(s.b)(this.geometryName_),this.handleGeometryChanged_,this),this.geometryName_=t,Object(r.a)(this,Object(s.b)(this.geometryName_),this.handleGeometryChanged_,this),this.handleGeometryChanged_()},e}(s.a);function l(t){return"function"==typeof t?t:(Array.isArray(t)?e=t:(Object(n.a)(t instanceof c.default,41),e=[t]),function(){return e});var e}e.default=h},function(t,e,i){t.exports=function(){"use strict";function t(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function e(t,e){return t<e?-1:t>e?1:0}return function(i,n,r,o,s){!function e(i,n,r,o,s){for(;o>r;){if(o-r>600){var a=o-r+1,c=n-r+1,h=Math.log(a),l=.5*Math.exp(2*h/3),u=.5*Math.sqrt(h*l*(a-l)/a)*(c-a/2<0?-1:1),_=Math.max(r,Math.floor(n-c*l/a+u)),d=Math.min(o,Math.floor(n+(a-c)*l/a+u));e(i,n,_,d,s)}var p=i[n],f=r,g=o;for(t(i,r,n),s(i[o],p)>0&&t(i,r,o);f<g;){for(t(i,f,g),f++,g--;s(i[f],p)<0;)f++;for(;s(i[g],p)>0;)g--}0===s(i[r],p)?t(i,r,g):t(i,++g,o),g<=n&&(r=g+1),n<=g&&(o=g-1)}}(i,n,r||0,o||i.length-1,s||e)}}()},function(t,e,i){"use strict";var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(r,o){function s(t){try{c(n.next(t))}catch(t){o(t)}}function a(t){try{c(n.throw(t))}catch(t){o(t)}}function c(t){t.done?r(t.value):new i(function(e){e(t.value)}).then(s,a)}c((n=n.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});const r=i(78),o=i(16),s=i(79);e.default=class{constructor(t){this.overlay=t,this.syncing=!1,this.handleClick=(t=>n(this,void 0,void 0,function*(){if(!this.syncing&&t.target.matches(".sync")){this.syncing=!0;const e=yield(yield fetch(`/api/sync-event/${t.target.dataset.wikidataId}`)).json();this.currentFeature.setProperties({event:e}),this.show(this.currentFeature),this.syncing=!1}})),this.el=document.createElement("div"),this.el.classList.add(`${r.CLASS_PREFIX}popup`),this.closeButton=document.createElement("a"),this.closeButton.textContent="",this.closeButton.addEventListener("click",()=>{null!=this.overlay&&this.overlay.setPosition(void 0)}),this.el.appendChild(this.closeButton),this.content=document.createElement("div"),this.content.addEventListener("click",this.handleClick),this.el.appendChild(this.content)}hide(){this.currentFeature=null,this.overlay.setPosition(void 0)}show(t){if(this.currentFeature=t,null==this.overlay)return console.error("[Popup.show] No overlay");const e=t.getProperties();this.content.innerHTML=this.contentTemplate(e);const i=o.transform(e.coordinates.coordinates,"EPSG:4326","EPSG:3857");this.overlay.setPosition(i)}contentTemplate(t){const{event:e}=t,i=null!=e.description?`<div class="description">${e.description}</div>`:"",n=s.formatDate(e.date,e.date_granularity),r=null!=e.date_min?`${s.formatDate(e.date_min,e.date_min_granularity)} ~ ${n}`:n,o=null!=e.end_date_max?`${s.formatDate(e.end_date,e.end_date_granularity)} ~ ${s.formatDate(e.end_date_max,e.end_date_max_granularity)}`:null!=e.end_date?s.formatDate(e.end_date,e.end_date_granularity):"";return`<h3 style="font-size: 1.5em">${e.label}</h3>\n\t\t\t${i}\n\t\t\t<h4 style="margin-bottom: 0">${""===o?"Date":"From"}</h4>\n\t\t\t${r}\n\t\t\t${""!==o?'<h4 style="margin-bottom: 0">To</h4>':""}\n\t\t\t${o}\n\t\t\t<div class="wikidata-id">\n\t\t\t\t<a href="https://www.wikidata.org/wiki/${e.wikidata_identifier}">\n\t\t\t\t\tEdit on Wikidata\n\t\t\t\t</a>\n\t\t\t\t&nbsp;&nbsp;\n\t\t\t\t<span style="text-decoration: underline; cursor: pointer;" class="sync" data-wikidata-id="${e.wikidata_identifier}">\n\t\t\t\t\tSync with Wikidata\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t`.replace(/\>(\\n|\s+)\</g,"><")}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CLASS_PREFIX="clm-"},function(t,e,i){t.exports=function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/build/",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);const n=14,r=16,o=r,s="CENTER_CHANGE_DONE",a="ZOOM_DONE",c="SCROLL_DONE",h=8;["rgba(211,84,0","rgba(219,10,91","rgba(31,58,147","rgba(0,128,0"].map(t=>(e=1)=>`${t},${e})`);const l=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],u=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function _(t){return u[t.getUTCMonth()]}function d(t){const e=t.getUTCDate();return`${l[t.getUTCDay()]}, ${e}${["st","nd","rd"].NaN||"th"}`}function p(t){return t.getUTCHours().toString().padStart(2,"0")}function f(t){return t.getUTCMinutes().toString().padStart(2,"0")}function g(t){return t.getUTCSeconds().toString().padStart(2,"0")}function v(t){return t.getUTCMilliseconds().toString().padStart(3,"0")}function m(t){return"YEAR"===t||"YEAR_5"===t||"DECADE"===t||"DECADE_5"===t||"CENTURY"===t||"CENTURY_5"===t||"MILLENIUM"===t}const y=(t,e)=>{if(null==t)return"";const i=new Date(t);let n=i.getUTCFullYear().toString();return m(e)?n:(n=`${_(i)} ${n}`,"MONHT"===e?n:(n=`${d(i)} ${n}`,"DAY"===e?n:(n=`${n} at ${p(i)}:`,"HOUR"===e?`${n}00`:(n=`${n}${f(i)}`,"MINUTE"===e?n:(n=`${n}:${g(i)}`,"SECOND"===e?n:`${n}.${v(i)}`)))))},b=t=>t>58?"MILLISECOND":t>12?"MILLISECOND_10":t>2.3?"MILLISECOND_50":t>1.5?"MILLISECOND_100":t>.4?"MILLISECOND_500":t>.00112?"SECOND":t>112e-6?"MINUTE":t>112e-7?"HOUR":t>8e-7?"DAY":t>2.6e-7?"WEEK":t>2.2e-8?"MONHT":t>2.2e-9?"YEAR":t>3.3e-10?"YEAR_5":t>1.6e-10?"DECADE":t>8e-11?"DECADE_5":t>1e-11?"CENTURY":t>5e-12?"CENTURY_5":"MILLENIUM",E=t=>{if("YEAR"===t)return 1;if("YEAR_5"===t)return 5;if("DECADE"===t)return 10;if("DECADE_5"===t)return 50;if("CENTURY"===t)return 100;if("CENTURY_5"===t)return 500;if("MILLENIUM"===t)return 1e3;if("MILLISECOND"===t)return 1;if("MILLISECOND_10"===t)return 10;if("MILLISECOND_50"===t)return 50;if("MILLISECOND_100"===t)return 100;if("MILLISECOND_500"===t)return 500;throw new RangeError("[getStep] Only steps with a granularity greater than 'year' calculated")};function x(t,e){const i=null!=t.date_min?t.date_min:t.date,n=null!=e.date_min?e.date_min:e.date;if(i<n)return-1;if(i>n)return 1;const r=null!=t.end_date_max?t.end_date_max:t.end_date,o=null!=e.end_date_max?e.end_date_max:e.end_date;return r<o?-1:r>o?1:0}const O=(t,e)=>{const i=new Date(t);return m(e)?i.getUTCFullYear().toString():"MONHT"===e?_(i):"WEEK"===e?`${_(i)}, week ${(t=>{const e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())),i=e.getUTCDay()||7;e.setUTCDate(e.getUTCDate()+4-i);const n=new Date(Date.UTC(e.getUTCFullYear(),0,1));return Math.ceil(((e.getTime()-n.getTime())/864e5+1)/7)})(i)}`:"DAY"===e?`${d(i)} ${_(i)}`:"HOUR"===e?`${p(i)}:00`:"MINUTE"===e?`${p(i)}:${f(i)}`:"SECOND"===e?`${p(i)}:${f(i)}:${g(i)}`:"MILLISECOND"===e.slice(0,"MILLISECOND".length)?`${p(i)}:${f(i)}:${g(i)}.${v(i)}`:void 0},C=(t,e)=>{let i;return()=>{clearTimeout(i),i=setTimeout(t,e)}};function T(t){return Math.pow(2,-1*t)}function w(t,e,i){return t/T(e)/i}function R(t){if(null==t)return null;const e=new Date(t);return`${e.getFullYear()}-${e.getMonth()+1}-${e.getDate()}`}var M;!function(t){t[t.Backward=-1]="Backward",t[t.Stop=0]="Stop",t[t.Forward=1]="Forward"}(M||(M={}));var P=new class{constructor(){this.elapsedTimeThreshold=2e3,this.goToDuration=300,this.zoomToDuration=300,this.multipliers=[.25,.5,1,2,4,8,16],this.multiplier=1,this.direction=M.Stop,this.elapsedTimeTotal=0,this.models=[],this.views=[],this.animate=(t=>{const e=null==this.prevTimestamp?0:t-this.prevTimestamp;if(e>0||null==this.prevTimestamp){if(null==this.centerMarker&&null==this.zoomMarker)H.center+=H.eventsBands[0].time/7.5*this.multiplier*this.direction;else if(null!=this.centerMarker){const t=this.goToDuration-this.elapsedTimeTotal,i=Math.abs(this.centerMarker-H.center)/(t/e);t<e?(H.center=this.centerMarker,this.stop()):H.center=H.center+i*this.direction}else if(null!=this.zoomMarker){const t=this.zoomToDuration-this.elapsedTimeTotal,i=(this.zoomMarker-this.activeBand.zoomLevel)/(t/e);if(t<e)this.activeBand.zoomLevel=this.zoomMarker,H.eventsBands.forEach(t=>{t===this.activeBand?this.activeBand.zoomLevel=this.zoomMarker:t.zoomLevel=this.zoomMarker+(t.config.zoomLevel-this.activeBand.config.zoomLevel)}),this.adjustMinimapBands(),document.dispatchEvent(new CustomEvent(a)),this.stop();else{for(const t of H.eventsBands)t.zoomLevel=t.zoomLevel+i;this.adjustMinimapBands()}}this.models.forEach(t=>t.update()),this.views.forEach(t=>t.update())}this.elapsedTimeTotal+=e,this.elapsedTimeTotal>this.elapsedTimeThreshold&&this.resetElapsedTimeTotal(),(this.isPlaying()||null!=this.zoomMarker)&&(H.center>=H.from&&H.center<=H.to||null!=this.centerMarker||null!=this.zoomMarker?(this.prevTimestamp=t,requestAnimationFrame(this.animate)):this.stop())})}registerModel(t){this.models.push(t)}registerView(t){this.views.push(t)}adjustMinimapBands(){H.minimapBands.forEach(t=>{this.activeBand.zoomLevel<t.config.zoomLevel&&(t.zoomLevel=this.activeBand.zoomLevel)})}resetElapsedTimeTotal(){this.elapsedTimeTotal=0,document.dispatchEvent(new CustomEvent(s))}accelerate(){const t=this.multipliers.indexOf(this.multiplier);return t===this.multipliers.length-1?this.multipliers[this.multipliers.length-1]:(this.multiplier=this.multipliers[t+1],this.multiplier)}decelerate(){const t=this.multipliers.indexOf(this.multiplier);return 0===t?this.multipliers[0]:(this.multiplier=this.multipliers[t-1],this.multiplier)}goTo(t){this.centerMarker=t,t>H.center?this.playForward():this.playBackward()}zoomTo(t,e){null==this.zoomMarker&&(e<0&&(e=0),t!==this.activeBand&&(this.stop(),this.activeBand=t),this.activeBand.zoomLevel!==e&&(this.zoomMarker=e,this.nextFrame()))}speed(t){const e=parseFloat(t);-1!==this.multipliers.indexOf(e)&&(this.multiplier=e)}isPlaying(){return this.direction!==M.Stop}isPlayingForward(){return this.direction===M.Forward}isPlayingBackward(){return this.direction===M.Backward}nextFrame(){requestAnimationFrame(this.animate)}playForward(){this.direction=M.Forward,this.nextFrame()}playBackward(){this.direction=M.Backward,this.nextFrame()}stop(){this.direction=M.Stop,this.activeBand=null,this.centerMarker=null,this.zoomMarker=null,this.prevTimestamp=null,this.elapsedTimeTotal=0}toggle(){this.isPlaying()?this.stop():this.nextFrame()}};class I{constructor(t){this.config=t,this.defaultZoomLevel=0}get offsetX(){return this._offsetX}set offsetX(t){this.prevOffsetX=this.offsetX||t,this._offsetX=t}get zoomLevel(){return this._zoomLevel}set zoomLevel(t){t<0&&(t=0),this.visibleRatio=T(t),this.width=Math.round(H.viewportWidth/this.visibleRatio),this.pixelsPerMillisecond=this.width/H.time,this.time=this.visibleRatio*H.time,this.granularity=b(this.pixelsPerMillisecond),this.nextDate=function(t){return m(t)?e=>{let i=new Date(e),n=i.getUTCFullYear()+1;if("YEAR"!==t){const e=E(t);for(;n%e!=0;)n+=1}return n>-1&&n<100?(i.setUTCFullYear(n),i.getTime()):Date.UTC(n,0,1)}:"MONHT"===t?t=>{const e=new Date(t);return Date.UTC(e.getUTCFullYear(),e.getUTCMonth()+1,1)}:"WEEK"===t?t=>{const e=new Date(t);return Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()+7)}:"DAY"===t?t=>{const e=new Date(t);return Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()+1)}:"HOUR"===t?t=>{const e=new Date(t);return Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours()+1)}:"MINUTE"===t?t=>{const e=new Date(t);return Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes()+1)}:"SECOND"===t?t=>{const e=new Date(t);return Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds()+1)}:"MILLISECOND"===t.slice(0,"MILLISECOND".length)?e=>{const i=E(t),n=new Date(e);let r=n.getUTCMilliseconds()+1;return i>1&&(r=r+i-r%i),Date.UTC(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds(),r)}:void 0}(this.granularity),this.prevZoomLevel=this.zoomLevel||t,this._zoomLevel=t,this.setHorizontalProps()}setVerticalProps(){this.visibleHeight=Math.round(this.config.heightRatio*H.viewportHeight),this.availableHeight=this.visibleHeight-o,this.visibleRowsCount=Math.floor(this.availableHeight/r),this.top=Math.round(this.config.topOffsetRatio*H.viewportHeight)}setHorizontalProps(){this.from=H.center-this.time/2,this.to=H.center+this.time/2,this.offsetX=(H.from-this.from)*this.pixelsPerMillisecond}init(){this.zoomLevel=this.config.zoomLevel,this.setVerticalProps(),P.registerModel(this)}resize(){this.zoomLevel=this.zoomLevel,this.setVerticalProps()}update(){this.setHorizontalProps()}updateConfig(t){Object.keys(t).forEach(e=>{this.config.hasOwnProperty(e)&&(this.config[e]=t[e])})}positionAtTimestamp(t){return Math.round((t-this.from)*this.pixelsPerMillisecond)}timestampAtProportion(t){return H.from+H.time*t}timestampAtPosition(t){return this.from+t/this.pixelsPerMillisecond}}class D{constructor(){this.heightRatio=1,this.rulers=!0,this.rulerLabels=!0,this.topOffsetRatio=0,this.zoomLevel=0}}class L extends D{constructor(){super(...arguments),this.indicatorFor=0,this.targets=[]}}class S extends D{}class A{}let j;if("undefined"!=typeof window){const t=document.createElement("style");document.head.appendChild(t),j=t.sheet}const k={};var F=(t,e,i,n)=>{if(!e)return document.createElement(t);let r;return k.hasOwnProperty(e)?r=k[e].cloneNode(!1):((r=document.createElement(t)).classList.add(e),i&&j.insertRule(`.${e} { ${i.join(";").concat(";")} }`),k[e]=r.cloneNode(!1)),n&&r.setAttribute("style",n.join(";").concat(";")),r};class U extends I{constructor(t){super(function(t){const e=Object.assign({},new L,t);return e.targets.length||e.targets.push(0),e}(t)),this.isDrawn=!1,this.canvas=F("canvas"),this.ctx=this.canvas.getContext("2d"),this.nextCanvas=F("canvas"),this.nextCtx=this.nextCanvas.getContext("2d")}init(){super.init(),this.maxRowCount=this.config.targets.reduce((t,e)=>{const{rowCount:i}=H.eventsBands[e];return Math.max(t,i)},0);const t=this.availableHeight/this.maxRowCount;this.eventHeight=t<1?1:Math.round(t),this.canvas.width=H.viewportWidth,this.canvas.height=this.maxRowCount*this.eventHeight,this.nextCanvas.width=H.viewportWidth,this.nextCanvas.height=this.maxRowCount*this.eventHeight}resize(){super.resize(),this.isDrawn=!1}draw(){return this.isDrawn?this.updateNextCanvas():this.drawEvents(),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(this.nextCanvas,0,0),this.canvas}drawEvents(t=this.from,e=this.to){this.nextCtx.beginPath(),this.config.targets.forEach(i=>{const n=H.eventsBands[i];for(const i of n.events){if(i.from>e||i.to<t)continue;const n=Math.round(i.time*this.pixelsPerMillisecond),r=this.positionAtTimestamp(null!=i.date_min?i.date_min:i.date),o=this.maxRowCount-(i.row+1)*this.eventHeight,s=n<1?1:n;this.nextCtx.rect(r,o,s,this.eventHeight)}}),this.nextCtx.fillStyle="rgb(190, 190, 190)",this.nextCtx.fill()}updateNextCanvas(){const t=Math.round(this.offsetX-this.prevOffsetX);if(0===t)return this.canvas;let e,i;this.nextCtx.clearRect(0,0,this.nextCanvas.width,this.nextCanvas.height),this.nextCtx.drawImage(this.canvas,t,0),t<0?(e=this.timestampAtPosition(H.viewportWidth+t),i=this.to):(e=this.from,i=this.timestampAtPosition(t)),this.drawEvents(e,i)}}class N{constructor(){this.events=[],this.row_count=0}}const B=8;function W(t,e){if(!t.length)return new N;let i=0;const r=[],o=2*n/e;return{events:t=t.map(t=>{let n;null==t.label&&(t.label="NO LABEL"),t.from=t.date_min||t.date,t.to=t.end_date_max||t.end_date,null==t.to&&(t.to=t.from),t.time=null==t.to?0:t.to-t.from,t.space=0,t.time||(null==t.label&&(t.label="NO LABEL"),t.space=t.label.length*B/e+o);let s=0;for(;null==n&&s<r.length;){let e=0,i=!0;for(;i&&e<r[s].length&&!(t.to<r[s][e][0]);)i=t.from>r[s][e][1],e++;i&&(r[s].push([t.from,t.from+t.time+t.space]),n=s),s++}return null==n&&(n=r.push([[t.from,t.from+t.time+t.space]])-1),n>i&&(i=n),t.row=n,t}),row_count:r.length}}class z extends I{constructor(t){super(Object.assign({},new S,t)),this.events=[],this.rowCount=0,this.visibleEvents=[],this._offsetY=0,null!=this.config.events&&this.config.events.sort(x)}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY+=t,this._offsetY<0&&(this._offsetY=0);const e=this.height>this.availableHeight?this.height-this.availableHeight+r:0;this._offsetY>e&&(this._offsetY=e);const i=this._offsetY/r;this.lowestVisibleRow=Math.ceil(i),this.highestVisibleRow=this.lowestVisibleRow+this.visibleRowsCount}init(){super.init();const t=w(H.viewportWidth,this.config.zoomLevel||0,H.time),e=null==this.config.orderedEvents?W(this.config.events,t):this.config.orderedEvents;this.events=e.events,this.rowCount=e.row_count,this.height=r*this.rowCount,this.offsetY=0,this.updateEvents()}updateEvents(){this.visibleEvents=this.events.filter(t=>!(t.from>this.to||t.to<this.from)&&t.row>=this.lowestVisibleRow&&t.row<=this.highestVisibleRow).map(t=>(t.left=this.positionAtTimestamp(t.from),t.width=Math.round(t.time*this.pixelsPerMillisecond),t.time&&t.width<1&&(t.width=1),t.padding=Math.round(t.space*this.pixelsPerMillisecond),t.top=this.top+this.availableHeight-(t.row+1)*r+this.offsetY,t))}update(){super.update(),this.updateEvents()}getEventByCoordinates(t,e){const i=this.timestampAtPosition(t),n=H.viewportOffset+this.top+this.availableHeight+this.offsetY,o=Math.floor((n-e)/r);return this.events.find(t=>!(!(t.from<i&&t.from+t.time+t.space>i)||t.row<this.lowestVisibleRow||t.row>this.highestVisibleRow)&&t.row===o)}zoomIn(){P.zoomTo(this,this.zoomLevel+1)}zoomOut(){P.zoomTo(this,this.zoomLevel-1)}}function G(t){return t instanceof z}function K(t){return t instanceof U}var H=new class{constructor(){this.defaultCenterRatio=.5,this.centerChangeDone=C(()=>{document.dispatchEvent(new CustomEvent(s))},300)}get center(){return this._center}set center(t){this._center===this.from&&t<this.from||this._center===this.to&&t>this.to||(t<this.from?this._center=this.from:t>this.to?this._center=this.to:this._center=t,this.centerChangeDone())}set dimensions(t){const e=getComputedStyle(t);this.viewportHeight=parseInt(e.getPropertyValue("height"),10),this.viewportOffset=t.getBoundingClientRect().top,this.viewportWidth=parseInt(e.getPropertyValue("width"),10)}init(t){null==t.rootElement&&console.error("[init] No rootElement found"),this.rootElement=t.rootElement,this.dimensions=this.rootElement;const[e,i]=t.bands.reduce((t,e)=>{if(e instanceof U)return t;const i=null==e.config.orderedEvents?e.config.events:e.config.orderedEvents.events;return t[0].push(i[0].date_min||i[0].date),t[1].push(i.reduce((t,e)=>Math.max(t,e.end_date||-1/0,e.end_date_max||-1/0),-1/0)),t},[[],[]]);this.from=Math.min(...e),this.to=Math.max(...i),this.time=this.to-this.from,this.center=null!=t.center?t.center:this.from+this.defaultCenterRatio*this.time,this.bands=t.bands,this.eventsBands=this.bands.filter(G),this.minimapBands=this.bands.filter(K);for(const t of this.bands)t.init()}resize(){this.dimensions=this.rootElement}},Y=new class{constructor(){this.eventsListeners=[]}register(t,e,i=document){i.addEventListener(t,e),this.eventsListeners.push([t,e,i])}flush(){this.eventsListeners.forEach(t=>{const[e,i,n]=t;n.removeEventListener(e,i)}),this.eventsListeners=[]}};class V{constructor(t){this.band=t,this.onMouseDown=(t=>{document.addEventListener("mouseup",this.onMouseUp),this.dragStartTime=Date.now(),this.dragStartPosition=[t.clientX,t.clientY],this.dragOffsetX=t.clientX,this.dragOffsetY=t.clientY}),this.onMouseMove=(t=>{if(null==this.dragOffsetX)return;this.band instanceof z&&(this.band.offsetY=t.clientY-this.dragOffsetY);const e=(this.dragOffsetX-t.clientX)/this.band.pixelsPerMillisecond;H.center+=e,P.nextFrame(),this.dragOffsetX=t.clientX,this.dragOffsetY=t.clientY}),this.onMouseUp=(t=>{this.lastDragInterval=Date.now()-this.dragStartTime,this.dispatchScrollDoneEvent(t),this.dragOffsetX=null,this.dragOffsetY=null,document.removeEventListener("mouseup",this.onMouseUp)}),this.onDblClick=(t=>{const e=this.band.timestampAtPosition(t.clientX);P.goTo(e)})}render(){return this.rootElement=F("div","band-wrap",["position: absolute","z-index: 2"],[`height: ${this.band.visibleHeight}px`,`top: ${this.band.top}px`,`width: ${H.viewportWidth}px`]),Y.register("mousedown",this.onMouseDown,this.rootElement),Y.register("mousemove",this.onMouseMove,this.rootElement),Y.register("dblclick",this.onDblClick,this.rootElement),this.rootElement}dispatchScrollDoneEvent(t){const e=[this.dragStartPosition[0]-t.clientX,this.dragStartPosition[1]-t.clientY].map(Math.abs).some(t=>t>5);(this.lastDragInterval>200||e)&&document.dispatchEvent(new CustomEvent(c))}resize(){this.rootElement.style.cssText=`height: ${this.band.visibleHeight}px; top: ${this.band.top}px; width: ${H.viewportWidth}px;`}}class X{constructor(t){this.onChange=t,this.animator=P,this.handleChange=(()=>{this.onChange({center:H.center,bands:H.bands})}),this.resize=(()=>{H.resize();for(const t of H.bands)t.resize();for(const t of this.views)t.resize();this.animator.nextFrame()}),document.addEventListener("keydown",t=>{189===t.keyCode&&H.eventsBands[0].zoomOut(),187===t.keyCode&&H.eventsBands[0].zoomIn()}),null!=this.onChange&&"function"==typeof this.onChange&&(document.addEventListener(s,this.handleChange),document.addEventListener(a,this.handleChange))}reload(){this.resize()}}class q extends V{constructor(t,e){super(t),this.band=t,this.select=e,this.onWheel=(t=>{0===Math.abs(t.deltaX)&&0!==t.deltaY&&(t.deltaY<0&&this.zoomOut(),t.deltaY>0&&this.zoomIn())}),this.onClick=(t=>{if(this.lastDragInterval>175)return;const e=this.band.getEventByCoordinates(t.clientX,t.clientY);e&&this.select&&(this.select(e),function(t,...e){console.log(t.label,t,t.left,R(t.from),R(t.to),e)}(e))})}render(){const t=super.render();return Y.register("click",this.onClick,this.rootElement),Y.register("wheel",this.onWheel,this.rootElement),t}zoomIn(){this.band.zoomIn()}zoomOut(){this.band.zoomOut()}}const Z="11px sans-serif",$="13px sans-serif";function J(t,e){return"CENTURY"===e.granularity&&new Date(t).getUTCFullYear()%1e3==0||"YEAR_5"===e.granularity&&new Date(t).getUTCFullYear()%50==0||"YEAR"===e.granularity&&new Date(t).getUTCFullYear()%5==0}function Q(t,e,i,n,r){const o=e.positionAtTimestamp(i);t.moveTo(o,n),t.lineTo(o,r),e.config.rulerLabels&&t.fillText(O(i,e.granularity),o+3,r-3)}function tt(t,e){if(!e.config.rulers)return;let i=e.nextDate(e.from);const n=e.config.topOffsetRatio*H.viewportHeight,r=e.config.heightRatio*H.viewportHeight,o=[],s=[];for(;i<e.to;)J(i,e)?s.push(i):o.push(i),i=e.nextDate(i);t.beginPath(),t.font=Z,t.fillStyle="rgb(205, 205, 205)";for(const i of o)Q(t,e,i,n,n+r);t.strokeStyle="rgb(235, 235, 235)",t.stroke(),t.beginPath(),t.font=$,t.fillStyle="rgb(120, 120, 120)";for(const i of s)Q(t,e,i,n,n+r);t.strokeStyle="rgb(150, 150, 150)",t.stroke()}class et{constructor(){this.indicatorsDrawn=!1,this.update=(()=>{H.bands.forEach(t=>{t instanceof z?this.drawEventsBand(t):this.drawMinimapBand(t)}),this.drawIndicators()}),P.registerView(this)}render(){return this.canvas=F("canvas","main",["position: absolute"]),this.canvas.width=H.viewportWidth,this.canvas.height=H.viewportHeight,this.ctx=this.canvas.getContext("2d"),this.indicatorsCanvas=F("canvas","indicators",["position: absolute"],["z-index: 1"]),this.indicatorsCanvas.width=H.viewportWidth,this.indicatorsCanvas.height=H.viewportHeight,this.indicatorsCtx=this.indicatorsCanvas.getContext("2d"),this.update(),[this.canvas,this.indicatorsCanvas]}resize(){this.indicatorsCanvas.width=H.viewportWidth,this.indicatorsCanvas.height=H.viewportHeight,this.canvas.width=H.viewportWidth,this.canvas.height=H.viewportHeight,this.indicatorsDrawn=!1}clear(t){this.ctx.clearRect(0,t.top,this.canvas.width,t.visibleHeight)}drawEventsBand(t){this.clear(t),tt(this.ctx,t),this.ctx.beginPath();for(const e of t.visibleEvents)e.time?this.ctx.rect(e.left,e.top,e.width,n):(this.ctx.moveTo(e.left,e.top+n/2),this.ctx.arc(e.left,e.top+n/2,n/3,0,2*Math.PI));this.ctx.fillStyle="rgb(216, 178, 178)",this.ctx.fill(),this.drawEventsText(t)}drawEventsText(t){this.ctx.font="11px sans-serif",this.ctx.fillStyle="rgb(126, 0, 0)";for(const e of t.visibleEvents){let t=0===e.time?e.padding:e.width,i=e.left;if(e.left<0&&0!==e.time&&(t=e.width+e.left,i=0),e.label.length*h<=t){const t=e.time?3:8;this.ctx.fillText(e.label,i+t,e.top+n-3)}}}drawMinimapBand(t){if(t.isDrawn&&t.prevOffsetX===t.offsetX&&t.prevZoomLevel===t.zoomLevel)return;this.clear(t),tt(this.ctx,t);const e=t.draw();this.ctx.drawImage(e,0,t.top,H.viewportWidth,t.availableHeight),t.isDrawn=!0}drawIndicators(){if(!this.indicatorsDrawn||!H.eventsBands.every(t=>t.prevZoomLevel===t.zoomLevel)){this.indicatorsCtx.clearRect(0,0,H.viewportWidth,H.viewportHeight),this.indicatorsCtx.beginPath();for(const t of H.minimapBands){const e=H.eventsBands[t.config.indicatorFor],i=Math.round(t.config.topOffsetRatio*H.viewportHeight),n=t.positionAtTimestamp(e.from);this.indicatorsCtx.rect(0,i,n,t.visibleHeight);const r=t.positionAtTimestamp(e.to);this.indicatorsCtx.rect(r,i,H.viewportWidth,t.visibleHeight),this.indicatorsCtx.rect(n,i+t.visibleHeight-o,r-n,o)}this.indicatorsCtx.fillStyle="rgba(0, 0, 0, .04)",this.indicatorsCtx.fill(),this.indicatorsCtx.closePath(),this.indicatorsDrawn=!0}}}class it{constructor(t){this.band=t}render(){const t=F("div","events-label-wrapper",["border-top: 1px solid #CCC","pointer-events: none","position: absolute","width: 100%","z-index: 3"],[`top: ${100*this.band.config.topOffsetRatio}%`]),e=F("div","events-label",["background: white","border-bottom-right-radius: 4px","box-shadow: 1px 2px 4px #AAA","color: #444","display: inline-block","font-family: sans-serif","font-size: .8em","padding: 4px 8px"]);return e.innerText=this.band.config.label,t.appendChild(e),t}resize(){}}class nt{constructor(){this.date_granularity="DAY"}}i.d(e,"default",function(){return rt}),i.d(e,"TimelineConfig",function(){return A}),i.d(e,"EventsBand",function(){return z}),i.d(e,"MinimapBand",function(){return U}),i.d(e,"OrderedEvents",function(){return N}),i.d(e,"calcPixelsPerMillisecond",function(){return w}),i.d(e,"formatDate",function(){return y}),i.d(e,"orderEvents",function(){return W}),i.d(e,"RawEv3nt",function(){return nt});class rt extends X{constructor(t,e,i){super(e),this.config=t,this.onSelect=i,this.appendToWrapper=(t=>{let e=t.render();Array.isArray(e)||(e=[e]),e.forEach(t=>this.wrapper.appendChild(t))}),H.init(t),t.rootElement.appendChild(this.render());const n=C(this.resize,600);window.addEventListener("resize",n)}render(){this.wrapper=F("div","wrapper",["box-sizing: border-box","height: 100%","overflow: hidden","position: relative","user-select: none","width: 100%"]),this.views=H.bands.map(t=>t instanceof z?new q(t,this.onSelect):new V(t)),this.views.push(new et),this.views.forEach(this.appendToWrapper),this.renderLabels();const t=F("div","red-line",["background-color: rgb(126, 0, 0)","bottom: 0","left: calc(50% - 1px)","position: absolute","top: 0","width: 2px","z-index: 4"]);return this.wrapper.appendChild(t),this.wrapper}renderLabels(){H.bands.filter(t=>t instanceof z&&null!=t.config.label).map(t=>new it(t)).forEach(this.appendToWrapper)}}}])},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(52),r=i(85),o=i(81),s=t=>({src:"data:image/svg+xml;utf8,"+t});e.battleIconStyle=new n.default({image:new r.default(s(o.battleSvg))}),e.aerialBattleIconStyle=new n.default({image:new r.default(s(o.aerialBattleSvg))}),e.birthIconStyle=new n.default({image:new r.default(s(o.birthSvg))}),e.deathIconStyle=new n.default({image:new r.default(s(o.deathSvg))})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n='xmlns="http://www.w3.org/2000/svg"\n\t\t\t\twidth="12"\n\t\t\t\theight="12"\n\t\t\t\tviewBox="0 0 96 96"'.replace(/\\n|\s+/g," ");e.battleSvg=`\n\t<svg ${n}>\n\t\t<circle fill="black" cx="48" cy="48" r="48" />\n\t\t<circle fill="white" cx="48" cy="48" r="39" />\n\t\t<circle fill="red" cx="48" cy="48" r="30" />\n\t</svg>`,e.deathSvg=`<svg ${n}>\n\t<g style="fill: red">\n\t\t<rect x="36" y="0" width="24" height="96" />\n\t\t<rect x="12" y="24" width="72" height="24" />\n\t</g>\n</svg>`,e.birthSvg=`<svg ${n}>\n\t<g style="fill: red">\n\t\t<polygon points="48,0 96,72 0,72" />\n\t\t<polygon points="48,96 96,24 0,24" />\n\t</g>\n</svg>`,e.aerialBattleSvg='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.005 512.005" width="12" height="12">\n\t<g style="fill: red">\n\t\t<path d="M508.623,300.399l-39.287-29.807V230.4c0-14.114-11.486-25.6-25.6-25.6s-25.6,11.486-25.6,25.6v1.357l-34.133-25.899\n\t\t\tv-43.725c0-14.114-11.486-25.6-25.6-25.6s-25.6,11.486-25.6,25.6v4.89l-34.15-25.907l0.017-43.819\n\t\t\tc0-26.249-4.54-52.07-13.534-76.894C280.647,8.021,269.246,0.017,256.079,0h-0.043c-13.141,0-24.55,7.979-29.056,20.335\n\t\t\tc-9.054,24.806-13.645,50.782-13.645,77.21l-0.017,43.588l-34.116,25.882v-4.881c0-14.114-11.486-25.6-25.6-25.6\n\t\t\tc-14.114,0-25.6,11.486-25.6,25.6v43.725l-34.133,25.89V230.4c0-14.114-11.486-25.6-25.6-25.6s-25.6,11.486-25.6,25.6v40.192\n\t\t\tL3.373,300.399c-2.125,1.621-3.371,4.13-3.371,6.801v51.2c0,2.756,1.331,5.35,3.575,6.946c1.468,1.05,3.2,1.587,4.958,1.587\n\t\t\tc0.93,0,1.877-0.154,2.782-0.469l201.95-69.632l-0.034,121.344l-62.916,26.214c-3.174,1.323-5.248,4.437-5.248,7.876v51.2\n\t\t\tc0,2.85,1.425,5.513,3.797,7.1c2.381,1.596,5.385,1.877,8.021,0.777l99.115-41.301l99.115,41.301\n\t\t\tc1.058,0.444,2.176,0.657,3.285,0.657c1.655,0,3.311-0.486,4.736-1.434c2.372-1.587,3.797-4.25,3.797-7.1v-51.2\n\t\t\tc0-3.439-2.074-6.554-5.248-7.876l-63.121-26.3l0.034-121.31l202.086,69.683c0.905,0.316,1.852,0.469,2.782,0.469\n\t\t\tc1.749,0,3.49-0.538,4.949-1.587c2.253-1.596,3.584-4.19,3.584-6.946v-51.2C512.002,304.529,510.757,302.02,508.623,300.399z\n\t\t\tM76.802,244.702l-17.067,12.945V230.4c0-4.71,3.831-8.533,8.533-8.533s8.533,3.823,8.533,8.533V244.702z M162.136,179.959\n\t\t\tl-17.067,12.945v-30.771c0-4.71,3.831-8.533,8.533-8.533c4.702,0,8.533,3.823,8.533,8.533V179.959z M366.936,192.913\n\t\t\tl-17.067-12.945v-17.835c0-4.71,3.831-8.533,8.533-8.533c4.702,0,8.533,3.823,8.533,8.533V192.913z M452.269,257.647\n\t\t\tl-17.067-12.945V230.4c0-4.71,3.823-8.533,8.533-8.533c4.71,0,8.533,3.823,8.533,8.533V257.647z"/>\n\t</g>\n</svg>'},function(t,e,i){"use strict";i.r(e);var n=i(3),r=i(23),o=i(25),s=i(17),a=function(t){function e(e,i,n){t.call(this,e),this.map=i,this.frameState=void 0!==n?n:null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(s.a),c=function(t){function e(e,i,n,r,o){t.call(this,e,i,o),this.originalEvent=n,this.pixel=i.getEventPixel(n),this.coordinate=i.getCoordinateFromPixel(this.pixel),this.dragging=void 0!==r&&r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.preventDefault=function(){t.prototype.preventDefault.call(this),this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){t.prototype.stopPropagation.call(this),this.originalEvent.stopPropagation()},e}(a),h=i(20),l=i(4),u={SINGLECLICK:"singleclick",CLICK:l.a.CLICK,DBLCLICK:l.a.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},_=function(t){function e(e,i,n,r,o){t.call(this,e,i,n.originalEvent,r,o),this.pointerEvent=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(c),d=i(1),p=i(32),f={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},g=function(t,e){this.dispatcher=t,this.mapping_=e};g.prototype.getEvents=function(){return Object.keys(this.mapping_)},g.prototype.getHandlerForEvent=function(t){return this.mapping_[t]};var v=g,m=1,y="mouse";function b(t){if(!this.isEventSimulatedFromTouch_(t)){m.toString()in this.pointerMap&&this.cancel(t);var e=T(t,this.dispatcher);this.pointerMap[m.toString()]=t,this.dispatcher.down(e,t)}}function E(t){if(!this.isEventSimulatedFromTouch_(t)){var e=T(t,this.dispatcher);this.dispatcher.move(e,t)}}function x(t){if(!this.isEventSimulatedFromTouch_(t)){var e=this.pointerMap[m.toString()];if(e&&e.button===t.button){var i=T(t,this.dispatcher);this.dispatcher.up(i,t),this.cleanupMouse()}}}function O(t){if(!this.isEventSimulatedFromTouch_(t)){var e=T(t,this.dispatcher);this.dispatcher.enterOver(e,t)}}function C(t){if(!this.isEventSimulatedFromTouch_(t)){var e=T(t,this.dispatcher);this.dispatcher.leaveOut(e,t)}}function T(t,e){var i=e.cloneEvent(t,t),n=i.preventDefault;return i.preventDefault=function(){t.preventDefault(),n()},i.pointerId=m,i.isPrimary=!0,i.pointerType=y,i}var w=function(t){function e(e){var i={mousedown:b,mousemove:E,mouseup:x,mouseover:O,mouseout:C};t.call(this,e,i),this.pointerMap=e.pointerMap,this.lastTouches=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isEventSimulatedFromTouch_=function(t){for(var e=this.lastTouches,i=t.clientX,n=t.clientY,r=0,o=e.length,s=void 0;r<o&&(s=e[r]);r++){var a=Math.abs(i-s[0]),c=Math.abs(n-s[1]);if(a<=25&&c<=25)return!0}return!1},e.prototype.cancel=function(t){var e=T(t,this.dispatcher);this.dispatcher.cancel(e,t),this.cleanupMouse()},e.prototype.cleanupMouse=function(){delete this.pointerMap[m.toString()]},e}(v),R=["","unavailable","touch","pen","mouse"];function M(t){this.pointerMap[t.pointerId.toString()]=t;var e=this.prepareEvent_(t);this.dispatcher.down(e,t)}function P(t){var e=this.prepareEvent_(t);this.dispatcher.move(e,t)}function I(t){var e=this.prepareEvent_(t);this.dispatcher.up(e,t),this.cleanup(t.pointerId)}function D(t){var e=this.prepareEvent_(t);this.dispatcher.leaveOut(e,t)}function L(t){var e=this.prepareEvent_(t);this.dispatcher.enterOver(e,t)}function S(t){var e=this.prepareEvent_(t);this.dispatcher.cancel(e,t),this.cleanup(t.pointerId)}function A(t){var e=this.dispatcher.makeEvent("lostpointercapture",t,t);this.dispatcher.dispatchEvent(e)}function j(t){var e=this.dispatcher.makeEvent("gotpointercapture",t,t);this.dispatcher.dispatchEvent(e)}var k=function(t){function e(e){var i={MSPointerDown:M,MSPointerMove:P,MSPointerUp:I,MSPointerOut:D,MSPointerOver:L,MSPointerCancel:S,MSGotPointerCapture:j,MSLostPointerCapture:A};t.call(this,e,i),this.pointerMap=e.pointerMap}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.prepareEvent_=function(t){var e=t;return"number"==typeof t.pointerType&&((e=this.dispatcher.cloneEvent(t,t)).pointerType=R[t.pointerType]),e},e.prototype.cleanup=function(t){delete this.pointerMap[t.toString()]},e}(v);function F(t){this.dispatcher.fireNativeEvent(t)}function U(t){this.dispatcher.fireNativeEvent(t)}function N(t){this.dispatcher.fireNativeEvent(t)}function B(t){this.dispatcher.fireNativeEvent(t)}function W(t){this.dispatcher.fireNativeEvent(t)}function z(t){this.dispatcher.fireNativeEvent(t)}function G(t){this.dispatcher.fireNativeEvent(t)}function K(t){this.dispatcher.fireNativeEvent(t)}var H=function(t){function e(e){var i={pointerdown:F,pointermove:U,pointerup:N,pointerout:B,pointerover:W,pointercancel:z,gotpointercapture:K,lostpointercapture:G};t.call(this,e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(v),Y=!1,V=function(t){function e(e,i,n){t.call(this,e),this.originalEvent=i;var r=n||{};this.buttons=this.getButtons_(r),this.pressure=this.getPressure_(r,this.buttons),this.bubbles="bubbles"in r&&r.bubbles,this.cancelable="cancelable"in r&&r.cancelable,this.view="view"in r?r.view:null,this.detail="detail"in r?r.detail:null,this.screenX="screenX"in r?r.screenX:0,this.screenY="screenY"in r?r.screenY:0,this.clientX="clientX"in r?r.clientX:0,this.clientY="clientY"in r?r.clientY:0,this.ctrlKey="ctrlKey"in r&&r.ctrlKey,this.altKey="altKey"in r&&r.altKey,this.shiftKey="shiftKey"in r&&r.shiftKey,this.metaKey="metaKey"in r&&r.metaKey,this.button="button"in r?r.button:0,this.relatedTarget="relatedTarget"in r?r.relatedTarget:null,this.pointerId="pointerId"in r?r.pointerId:0,this.width="width"in r?r.width:0,this.height="height"in r?r.height:0,this.tiltX="tiltX"in r?r.tiltX:0,this.tiltY="tiltY"in r?r.tiltY:0,this.pointerType="pointerType"in r?r.pointerType:"",this.hwTimestamp="hwTimestamp"in r?r.hwTimestamp:0,this.isPrimary="isPrimary"in r&&r.isPrimary,i.preventDefault&&(this.preventDefault=function(){i.preventDefault()})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getButtons_=function(t){var e;if(t.buttons||Y)e=t.buttons;else switch(t.which){case 1:e=1;break;case 2:e=4;break;case 3:e=2;break;default:e=0}return e},e.prototype.getPressure_=function(t,e){return t.pressure?t.pressure:e?.5:0},e}(s.a);!function(){try{var t=new MouseEvent("click",{buttons:1});Y=1===t.buttons}catch(t){}}();var X=V,q=i(13);function Z(t){this.vacuumTouches_(t),this.setPrimaryTouch_(t.changedTouches[0]),this.dedupSynthMouse_(t),this.clickCount_++,this.processTouches_(t,this.overDown_)}function $(t){t.preventDefault(),this.processTouches_(t,this.moveOverOut_)}function J(t){this.dedupSynthMouse_(t),this.processTouches_(t,this.upOut_)}function Q(t){this.processTouches_(t,this.cancelOut_)}var tt=function(t){function e(e,i){var n={touchstart:Z,touchmove:$,touchend:J,touchcancel:Q};t.call(this,e,n),this.pointerMap=e.pointerMap,this.mouseSource=i,this.firstTouchId_=void 0,this.clickCount_=0,this.resetId_=void 0,this.dedupTimeout_=2500}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isPrimaryTouch_=function(t){return this.firstTouchId_===t.identifier},e.prototype.setPrimaryTouch_=function(t){var e=Object.keys(this.pointerMap).length;(0===e||1===e&&m.toString()in this.pointerMap)&&(this.firstTouchId_=t.identifier,this.cancelResetClickCount_())},e.prototype.removePrimaryPointer_=function(t){t.isPrimary&&(this.firstTouchId_=void 0,this.resetClickCount_())},e.prototype.resetClickCount_=function(){this.resetId_=setTimeout(this.resetClickCountHandler_.bind(this),200)},e.prototype.resetClickCountHandler_=function(){this.clickCount_=0,this.resetId_=void 0},e.prototype.cancelResetClickCount_=function(){void 0!==this.resetId_&&clearTimeout(this.resetId_)},e.prototype.touchToPointer_=function(t,e){var i=this.dispatcher.cloneEvent(t,e);return i.pointerId=e.identifier+2,i.bubbles=!0,i.cancelable=!0,i.detail=this.clickCount_,i.button=0,i.buttons=1,i.width=e.webkitRadiusX||e.radiusX||0,i.height=e.webkitRadiusY||e.radiusY||0,i.pressure=e.webkitForce||e.force||.5,i.isPrimary=this.isPrimaryTouch_(e),i.pointerType="touch",i.clientX=e.clientX,i.clientY=e.clientY,i.screenX=e.screenX,i.screenY=e.screenY,i},e.prototype.processTouches_=function(t,e){var i=Array.prototype.slice.call(t.changedTouches),n=i.length;function r(){t.preventDefault()}for(var o=0;o<n;++o){var s=this.touchToPointer_(t,i[o]);s.preventDefault=r,e.call(this,t,s)}},e.prototype.findTouch_=function(t,e){for(var i=t.length,n=0;n<i;n++)if(t[n].identifier===e)return!0;return!1},e.prototype.vacuumTouches_=function(t){var e=t.touches,i=Object.keys(this.pointerMap),n=i.length;if(n>=e.length){for(var r=[],o=0;o<n;++o){var s=i[o],a=this.pointerMap[s];s==m||this.findTouch_(e,s-2)||r.push(a.out)}for(var c=0;c<r.length;++c)this.cancelOut_(t,r[c])}},e.prototype.overDown_=function(t,e){this.pointerMap[e.pointerId]={target:e.target,out:e,outTarget:e.target},this.dispatcher.over(e,t),this.dispatcher.enter(e,t),this.dispatcher.down(e,t)},e.prototype.moveOverOut_=function(t,e){var i=e,n=this.pointerMap[i.pointerId];if(n){var r=n.out,o=n.outTarget;this.dispatcher.move(i,t),r&&o!==i.target&&(r.relatedTarget=i.target,i.relatedTarget=o,r.target=o,i.target?(this.dispatcher.leaveOut(r,t),this.dispatcher.enterOver(i,t)):(i.target=o,i.relatedTarget=null,this.cancelOut_(t,i))),n.out=i,n.outTarget=i.target}},e.prototype.upOut_=function(t,e){this.dispatcher.up(e,t),this.dispatcher.out(e,t),this.dispatcher.leave(e,t),this.cleanUpPointer_(e)},e.prototype.cancelOut_=function(t,e){this.dispatcher.cancel(e,t),this.dispatcher.out(e,t),this.dispatcher.leave(e,t),this.cleanUpPointer_(e)},e.prototype.cleanUpPointer_=function(t){delete this.pointerMap[t.pointerId],this.removePrimaryPointer_(t)},e.prototype.dedupSynthMouse_=function(t){var e=this.mouseSource.lastTouches,i=t.changedTouches[0];if(this.isPrimaryTouch_(i)){var n=[i.clientX,i.clientY];e.push(n),setTimeout(function(){Object(q.g)(e,n)},this.dedupTimeout_)}},e}(v),et=[["bubbles",!1],["cancelable",!1],["view",null],["detail",null],["screenX",0],["screenY",0],["clientX",0],["clientY",0],["ctrlKey",!1],["altKey",!1],["shiftKey",!1],["metaKey",!1],["button",0],["relatedTarget",null],["buttons",0],["pointerId",0],["width",0],["height",0],["pressure",0],["tiltX",0],["tiltY",0],["pointerType",""],["hwTimestamp",0],["isPrimary",!1],["type",""],["target",null],["currentTarget",null],["which",0]],it=function(t){function e(e){t.call(this),this.element_=e,this.pointerMap={},this.eventMap_={},this.eventSourceList_=[],this.registerSources()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.registerSources=function(){if(h.f)this.registerSource("native",new H(this));else if(h.e)this.registerSource("ms",new k(this));else{var t=new w(this);this.registerSource("mouse",t),h.h&&this.registerSource("touch",new tt(this,t))}this.register_()},e.prototype.registerSource=function(t,e){var i=e,n=i.getEvents();n&&(n.forEach(function(t){var e=i.getHandlerForEvent(t);e&&(this.eventMap_[t]=e.bind(i))}.bind(this)),this.eventSourceList_.push(i))},e.prototype.register_=function(){for(var t=this.eventSourceList_.length,e=0;e<t;e++){var i=this.eventSourceList_[e];this.addEvents_(i.getEvents())}},e.prototype.unregister_=function(){for(var t=this.eventSourceList_.length,e=0;e<t;e++){var i=this.eventSourceList_[e];this.removeEvents_(i.getEvents())}},e.prototype.eventHandler_=function(t){var e=t.type,i=this.eventMap_[e];i&&i(t)},e.prototype.addEvents_=function(t){t.forEach(function(t){Object(d.a)(this.element_,t,this.eventHandler_,this)}.bind(this))},e.prototype.removeEvents_=function(t){t.forEach(function(t){Object(d.c)(this.element_,t,this.eventHandler_,this)}.bind(this))},e.prototype.cloneEvent=function(t,e){for(var i={},n=0,r=et.length;n<r;n++){var o=et[n][0];i[o]=t[o]||e[o]||et[n][1]}return i},e.prototype.down=function(t,e){this.fireEvent(f.POINTERDOWN,t,e)},e.prototype.move=function(t,e){this.fireEvent(f.POINTERMOVE,t,e)},e.prototype.up=function(t,e){this.fireEvent(f.POINTERUP,t,e)},e.prototype.enter=function(t,e){t.bubbles=!1,this.fireEvent(f.POINTERENTER,t,e)},e.prototype.leave=function(t,e){t.bubbles=!1,this.fireEvent(f.POINTERLEAVE,t,e)},e.prototype.over=function(t,e){t.bubbles=!0,this.fireEvent(f.POINTEROVER,t,e)},e.prototype.out=function(t,e){t.bubbles=!0,this.fireEvent(f.POINTEROUT,t,e)},e.prototype.cancel=function(t,e){this.fireEvent(f.POINTERCANCEL,t,e)},e.prototype.leaveOut=function(t,e){this.out(t,e),this.contains_(t.target,t.relatedTarget)||this.leave(t,e)},e.prototype.enterOver=function(t,e){this.over(t,e),this.contains_(t.target,t.relatedTarget)||this.enter(t,e)},e.prototype.contains_=function(t,e){return!(!t||!e)&&t.contains(e)},e.prototype.makeEvent=function(t,e,i){return new X(t,i,e)},e.prototype.fireEvent=function(t,e,i){var n=this.makeEvent(t,e,i);this.dispatchEvent(n)},e.prototype.fireNativeEvent=function(t){var e=this.makeEvent(t.type,t,t);this.dispatchEvent(e)},e.prototype.wrapMouseEvent=function(t,e){return this.makeEvent(t,w.prepareEvent(e,this),e)},e.prototype.disposeInternal=function(){this.unregister_(),t.prototype.disposeInternal.call(this)},e}(p.a),nt=function(t){function e(e,i){t.call(this),this.map_=e,this.clickTimeoutId_=0,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=i?i*h.b:h.b,this.down_=null;var n=this.map_.getViewport();this.activePointers_=0,this.trackedTouches_={},this.pointerEventHandler_=new it(n),this.documentPointerEventHandler_=null,this.pointerdownListenerKey_=Object(d.a)(this.pointerEventHandler_,f.POINTERDOWN,this.handlePointerDown_,this),this.relayedListenerKey_=Object(d.a)(this.pointerEventHandler_,f.POINTERMOVE,this.relayEvent_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.emulateClick_=function(t){var e=new _(u.CLICK,this.map_,t);this.dispatchEvent(e),0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=0,e=new _(u.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=0;var e=new _(u.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}.bind(this),250)},e.prototype.updateActivePointers_=function(t){var e=t;e.type==u.POINTERUP||e.type==u.POINTERCANCEL?delete this.trackedTouches_[e.pointerId]:e.type==u.POINTERDOWN&&(this.trackedTouches_[e.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},e.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var e=new _(u.POINTERUP,this.map_,t);this.dispatchEvent(e),e.propagationStopped||this.dragging_||!this.isMouseActionButton_(t)||this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(d.e),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null,this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null)},e.prototype.isMouseActionButton_=function(t){return 0===t.button},e.prototype.handlePointerDown_=function(t){this.updateActivePointers_(t);var e=new _(u.POINTERDOWN,this.map_,t);this.dispatchEvent(e),this.down_=t,0===this.dragListenerKeys_.length&&(this.documentPointerEventHandler_=new it(document),this.dragListenerKeys_.push(Object(d.a)(this.documentPointerEventHandler_,u.POINTERMOVE,this.handlePointerMove_,this),Object(d.a)(this.documentPointerEventHandler_,u.POINTERUP,this.handlePointerUp_,this),Object(d.a)(this.pointerEventHandler_,u.POINTERCANCEL,this.handlePointerUp_,this)))},e.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=!0;var e=new _(u.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(e)}t.preventDefault()},e.prototype.relayEvent_=function(t){var e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new _(t.type,this.map_,t,e))},e.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},e.prototype.disposeInternal=function(){this.relayedListenerKey_&&(Object(d.e)(this.relayedListenerKey_),this.relayedListenerKey_=null),this.pointerdownListenerKey_&&(Object(d.e)(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(d.e),this.dragListenerKeys_.length=0,this.documentPointerEventHandler_&&(this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null),this.pointerEventHandler_&&(this.pointerEventHandler_.dispose(),this.pointerEventHandler_=null),t.prototype.disposeInternal.call(this)},e}(p.a),rt=i(42),ot={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},st=i(12),at=i(36),ct=i(8),ht=i(11),lt=i(10),ut=function(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}};ut.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,Object(lt.b)(this.queuedElements_)},ut.prototype.dequeue=function(){var t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));var n=this.keyFunction_(i);return delete this.queuedElements_[n],i},ut.prototype.enqueue=function(t){Object(ht.a)(!(this.keyFunction_(t)in this.queuedElements_),31);var e=this.priorityFunction_(t);return e!=1/0&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},ut.prototype.getCount=function(){return this.elements_.length},ut.prototype.getLeftChildIndex_=function(t){return 2*t+1},ut.prototype.getRightChildIndex_=function(t){return 2*t+2},ut.prototype.getParentIndex_=function(t){return t-1>>1},ut.prototype.heapify_=function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)},ut.prototype.isEmpty=function(){return 0===this.elements_.length},ut.prototype.isKeyQueued=function(t){return t in this.queuedElements_},ut.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))},ut.prototype.siftUp_=function(t){for(var e=this.elements_,i=this.priorities_,n=e.length,r=e[t],o=i[t],s=t;t<n>>1;){var a=this.getLeftChildIndex_(t),c=this.getRightChildIndex_(t),h=c<n&&i[c]<i[a]?c:a;e[t]=e[h],i[t]=i[h],t=h}e[t]=r,i[t]=o,this.siftDown_(s,t)},ut.prototype.siftDown_=function(t,e){for(var i=this.elements_,n=this.priorities_,r=i[e],o=n[e];e>t;){var s=this.getParentIndex_(e);if(!(n[s]>o))break;i[e]=i[s],n[e]=n[s],e=s}i[e]=r,n[e]=o},ut.prototype.reprioritize=function(){var t,e,i,n=this.priorityFunction_,r=this.elements_,o=this.priorities_,s=0,a=r.length;for(e=0;e<a;++e)(i=n(t=r[e]))==1/0?delete this.queuedElements_[this.keyFunction_(t)]:(o[s]=i,r[s++]=t);r.length=s,o.length=s,this.heapify_()};var _t=ut,dt=function(t){function e(e,i){t.call(this,function(t){return e.apply(null,t)},function(t){return t[0].getKey()}),this.tileChangeCallback_=i,this.tilesLoading_=0,this.tilesLoadingKeys_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.enqueue=function(e){var i=t.prototype.enqueue.call(this,e);if(i){var n=e[0];Object(d.a)(n,l.a.CHANGE,this.handleTileChange,this)}return i},e.prototype.getTilesLoading=function(){return this.tilesLoading_},e.prototype.handleTileChange=function(t){var e=t.target,i=e.getState();if(i===ct.a.LOADED||i===ct.a.ERROR||i===ct.a.EMPTY||i===ct.a.ABORT){Object(d.c)(e,l.a.CHANGE,this.handleTileChange,this);var n=e.getKey();n in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[n],--this.tilesLoading_),this.tileChangeCallback_()}},e.prototype.loadMoreTiles=function(t,e){for(var i,n,r,o=0,s=!1;this.tilesLoading_<t&&o<e&&this.getCount()>0;)r=(n=this.dequeue()[0]).getKey(),(i=n.getState())===ct.a.ABORT?s=!0:i!==ct.a.IDLE||r in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++o,n.load());0===o&&s&&this.tileChangeCallback_()},e}(_t),pt=i(64),ft=i(15),gt=i(14),vt=i(2),mt=i(9),yt=i(61),bt=i(33),Et={LAYERS:"layers"},xt=function(t){function e(e){var i=e||{},n=Object(lt.a)({},i);delete n.layers;var o=i.layers;t.call(this,n),this.layersListenerKeys_=[],this.listenerKeys_={},Object(d.a)(this,Object(st.b)(Et.LAYERS),this.handleLayersChanged_,this),o?Array.isArray(o)?o=new r.a(o.slice(),{unique:!0}):(Object(ht.a)(o instanceof r.a,43),o=o):o=new r.a(void 0,{unique:!0}),this.setLayers(o)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleLayerChange_=function(){this.changed()},e.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(d.e),this.layersListenerKeys_.length=0;var t=this.getLayers();for(var e in this.layersListenerKeys_.push(Object(d.a)(t,o.a.ADD,this.handleLayersAdd_,this),Object(d.a)(t,o.a.REMOVE,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[e].forEach(d.e);Object(lt.b)(this.listenerKeys_);for(var i=t.getArray(),r=0,s=i.length;r<s;r++){var a=i[r];this.listenerKeys_[Object(n.b)(a).toString()]=[Object(d.a)(a,at.a.PROPERTYCHANGE,this.handleLayerChange_,this),Object(d.a)(a,l.a.CHANGE,this.handleLayerChange_,this)]}this.changed()},e.prototype.handleLayersAdd_=function(t){var e=t.element,i=Object(n.b)(e).toString();this.listenerKeys_[i]=[Object(d.a)(e,at.a.PROPERTYCHANGE,this.handleLayerChange_,this),Object(d.a)(e,l.a.CHANGE,this.handleLayerChange_,this)],this.changed()},e.prototype.handleLayersRemove_=function(t){var e=t.element,i=Object(n.b)(e).toString();this.listenerKeys_[i].forEach(d.e),delete this.listenerKeys_[i],this.changed()},e.prototype.getLayers=function(){return this.get(Et.LAYERS)},e.prototype.setLayers=function(t){this.set(Et.LAYERS,t)},e.prototype.getLayersArray=function(t){var e=void 0!==t?t:[];return this.getLayers().forEach(function(t){t.getLayersArray(e)}),e},e.prototype.getLayerStatesArray=function(t){var e=void 0!==t?t:[],i=e.length;this.getLayers().forEach(function(t){t.getLayerStatesArray(e)});for(var n=this.getLayerState(),r=i,o=e.length;r<o;r++){var s=e[r];s.opacity*=n.opacity,s.visible=s.visible&&n.visible,s.maxResolution=Math.min(s.maxResolution,n.maxResolution),s.minResolution=Math.max(s.minResolution,n.minResolution),void 0!==n.extent&&(void 0!==s.extent?s.extent=Object(vt.A)(s.extent,n.extent):s.extent=n.extent)}return e},e.prototype.getSourceState=function(){return bt.a.READY},e}(yt.a),Ot=i(29),Ct=i(6),Tt=function(t){function e(e){t.call(this);var i=function(t){var e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);var i,n,o,s={},a=t.layers instanceof xt?t.layers:new xt({layers:t.layers});return s[ot.LAYERGROUP]=a,s[ot.TARGET]=t.target,s[ot.VIEW]=void 0!==t.view?t.view:new pt.default,void 0!==t.controls&&(Array.isArray(t.controls)?i=new r.a(t.controls.slice()):(Object(ht.a)(t.controls instanceof r.a,47),i=t.controls)),void 0!==t.interactions&&(Array.isArray(t.interactions)?n=new r.a(t.interactions.slice()):(Object(ht.a)(t.interactions instanceof r.a,48),n=t.interactions)),void 0!==t.overlays?Array.isArray(t.overlays)?o=new r.a(t.overlays.slice()):(Object(ht.a)(t.overlays instanceof r.a,49),o=t.overlays):o=new r.a,{controls:i,interactions:n,keyboardEventTarget:e,overlays:o,values:s}}(e);this.maxTilesLoading_=void 0!==e.maxTilesLoading?e.maxTilesLoading:16,this.loadTilesWhileAnimating_=void 0!==e.loadTilesWhileAnimating&&e.loadTilesWhileAnimating,this.loadTilesWhileInteracting_=void 0!==e.loadTilesWhileInteracting&&e.loadTilesWhileInteracting,this.pixelRatio_=void 0!==e.pixelRatio?e.pixelRatio:h.b,this.animationDelayKey_,this.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_.call(this,Date.now())}.bind(this),this.coordinateToPixelTransform_=Object(Ct.c)(),this.pixelToCoordinateTransform_=Object(Ct.c)(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("DIV"),this.viewport_.className="ol-viewport"+(h.h?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.viewport_.style.msTouchAction="none",this.viewport_.style.touchAction="none",this.overlayContainer_=document.createElement("DIV"),this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("DIV"),this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent";for(var n=[l.a.CLICK,l.a.DBLCLICK,l.a.MOUSEDOWN,l.a.TOUCHSTART,l.a.MSPOINTERDOWN,u.POINTERDOWN,l.a.MOUSEWHEEL,l.a.WHEEL],a=0,c=n.length;a<c;++a)Object(d.a)(this.overlayContainerStopEvent_,n[a],s.b);for(var _ in this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=new nt(this,e.moveTolerance),u)Object(d.a)(this.mapBrowserEventHandler_,u[_],this.handleMapBrowserEvent,this);this.keyboardEventTarget_=i.keyboardEventTarget,this.keyHandlerKeys_=null,Object(d.a)(this.viewport_,l.a.CONTEXTMENU,this.handleBrowserEvent,this),Object(d.a)(this.viewport_,l.a.WHEEL,this.handleBrowserEvent,this),Object(d.a)(this.viewport_,l.a.MOUSEWHEEL,this.handleBrowserEvent,this),this.controls=i.controls||new r.a,this.interactions=i.interactions||new r.a,this.overlays_=i.overlays,this.overlayIdIndex_={},this.renderer_=this.createRenderer(),this.handleResize_,this.focus_=null,this.postRenderFunctions_=[],this.tileQueue_=new dt(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.skippedFeatureUids_={},Object(d.a)(this,Object(st.b)(ot.LAYERGROUP),this.handleLayerGroupChanged_,this),Object(d.a)(this,Object(st.b)(ot.VIEW),this.handleViewChanged_,this),Object(d.a)(this,Object(st.b)(ot.SIZE),this.handleSizeChanged_,this),Object(d.a)(this,Object(st.b)(ot.TARGET),this.handleTargetChanged_,this),this.setProperties(i.values),this.controls.forEach(function(t){t.setMap(this)}.bind(this)),Object(d.a)(this.controls,o.a.ADD,function(t){t.element.setMap(this)},this),Object(d.a)(this.controls,o.a.REMOVE,function(t){t.element.setMap(null)},this),this.interactions.forEach(function(t){t.setMap(this)}.bind(this)),Object(d.a)(this.interactions,o.a.ADD,function(t){t.element.setMap(this)},this),Object(d.a)(this.interactions,o.a.REMOVE,function(t){t.element.setMap(null)},this),this.overlays_.forEach(this.addOverlayInternal_.bind(this)),Object(d.a)(this.overlays_,o.a.ADD,function(t){this.addOverlayInternal_(t.element)},this),Object(d.a)(this.overlays_,o.a.REMOVE,function(t){var e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)},this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},e.prototype.addControl=function(t){this.getControls().push(t)},e.prototype.addInteraction=function(t){this.getInteractions().push(t)},e.prototype.addLayer=function(t){this.getLayerGroup().getLayers().push(t)},e.prototype.addOverlay=function(t){this.getOverlays().push(t)},e.prototype.addOverlayInternal_=function(t){var e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)},e.prototype.disposeInternal=function(){this.mapBrowserEventHandler_.dispose(),Object(d.c)(this.viewport_,l.a.CONTEXTMENU,this.handleBrowserEvent,this),Object(d.c)(this.viewport_,l.a.WHEEL,this.handleBrowserEvent,this),Object(d.c)(this.viewport_,l.a.MOUSEWHEEL,this.handleBrowserEvent,this),void 0!==this.handleResize_&&(removeEventListener(l.a.RESIZE,this.handleResize_,!1),this.handleResize_=void 0),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0),this.setTarget(null),t.prototype.disposeInternal.call(this)},e.prototype.forEachFeatureAtPixel=function(t,e,i){if(this.frameState_){var n=this.getCoordinateFromPixel(t),r=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,o=void 0!==i.layerFilter?i.layerFilter:mt.b;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,r,e,null,o,null)}},e.prototype.getFeaturesAtPixel=function(t,e){var i=null;return this.forEachFeatureAtPixel(t,function(t){i||(i=[]),i.push(t)},e),i},e.prototype.forEachLayerAtPixel=function(t,e,i){if(this.frameState_){var n=i||{},r=void 0!==n.hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,o=n.layerFilter||mt.b;return this.renderer_.forEachLayerAtPixel(t,this.frameState_,r,e,null,o,null)}},e.prototype.hasFeatureAtPixel=function(t,e){if(!this.frameState_)return!1;var i=this.getCoordinateFromPixel(t),n=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:mt.b,r=void 0!==e.hitTolerance?e.hitTolerance*this.frameState_.pixelRatio:0;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,r,n,null)},e.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))},e.prototype.getEventPixel=function(t){var e=this.viewport_.getBoundingClientRect(),i=t.changedTouches?t.changedTouches[0]:t;return[i.clientX-e.left,i.clientY-e.top]},e.prototype.getTarget=function(){return this.get(ot.TARGET)},e.prototype.getTargetElement=function(){var t=this.getTarget();return void 0!==t?"string"==typeof t?document.getElementById(t):t:null},e.prototype.getCoordinateFromPixel=function(t){var e=this.frameState_;return e?Object(Ct.a)(e.pixelToCoordinateTransform,t.slice()):null},e.prototype.getControls=function(){return this.controls},e.prototype.getOverlays=function(){return this.overlays_},e.prototype.getOverlayById=function(t){var e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getInteractions=function(){return this.interactions},e.prototype.getLayerGroup=function(){return this.get(ot.LAYERGROUP)},e.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},e.prototype.getPixelFromCoordinate=function(t){var e=this.frameState_;return e?Object(Ct.a)(e.coordinateToPixelTransform,t.slice(0,2)):null},e.prototype.getRenderer=function(){return this.renderer_},e.prototype.getSize=function(){return this.get(ot.SIZE)},e.prototype.getView=function(){return this.get(ot.VIEW)},e.prototype.getViewport=function(){return this.viewport_},e.prototype.getOverlayContainer=function(){return this.overlayContainer_},e.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},e.prototype.getTilePriority=function(t,e,i,n){var r=this.frameState_;if(!(r&&e in r.wantedTiles))return 1/0;if(!r.wantedTiles[e][t.getKey()])return 1/0;var o=i[0]-r.focus[0],s=i[1]-r.focus[1];return 65536*Math.log(n)+Math.sqrt(o*o+s*s)/n},e.prototype.handleBrowserEvent=function(t,e){var i=e||t.type,n=new c(i,this,t);this.handleMapBrowserEvent(n)},e.prototype.handleMapBrowserEvent=function(t){if(this.frameState_){this.focus_=t.coordinate,t.frameState=this.frameState_;var e=this.getInteractions().getArray();if(!1!==this.dispatchEvent(t))for(var i=e.length-1;i>=0;i--){var n=e[i];if(n.getActive()&&!n.handleEvent(t))break}}},e.prototype.handlePostRender=function(){var t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){var i=this.maxTilesLoading_,n=i;if(t){var r=t.viewHints;r[ft.a.ANIMATING]&&(i=this.loadTilesWhileAnimating_?8:0,n=2),r[ft.a.INTERACTING]&&(i=this.loadTilesWhileInteracting_?8:0,n=2)}e.getTilesLoading()<i&&(e.reprioritize(),e.loadMoreTiles(i,n))}for(var o=this.postRenderFunctions_,s=0,a=o.length;s<a;++s)o[s](this,t);o.length=0},e.prototype.handleSizeChanged_=function(){this.render()},e.prototype.handleTargetChanged_=function(){var t;if(this.getTarget()&&(t=this.getTargetElement()),this.keyHandlerKeys_){for(var e=0,i=this.keyHandlerKeys_.length;e<i;++e)Object(d.e)(this.keyHandlerKeys_[e]);this.keyHandlerKeys_=null}if(t){t.appendChild(this.viewport_);var n=this.keyboardEventTarget_?this.keyboardEventTarget_:t;this.keyHandlerKeys_=[Object(d.a)(n,l.a.KEYDOWN,this.handleBrowserEvent,this),Object(d.a)(n,l.a.KEYPRESS,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),addEventListener(l.a.RESIZE,this.handleResize_,!1))}else this.renderer_.removeLayerRenderers(),Object(gt.e)(this.viewport_),void 0!==this.handleResize_&&(removeEventListener(l.a.RESIZE,this.handleResize_,!1),this.handleResize_=void 0);this.updateSize()},e.prototype.handleTileChange_=function(){this.render()},e.prototype.handleViewPropertyChanged_=function(){this.render()},e.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(Object(d.e)(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Object(d.e)(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.viewport_.setAttribute("data-view",Object(n.b)(t)),this.viewPropertyListenerKey_=Object(d.a)(t,at.a.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Object(d.a)(t,l.a.CHANGE,this.handleViewPropertyChanged_,this)),this.render()},e.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(d.e),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.layerGroupPropertyListenerKeys_=[Object(d.a)(t,at.a.PROPERTYCHANGE,this.render,this),Object(d.a)(t,l.a.CHANGE,this.render,this)]),this.render()},e.prototype.isRendered=function(){return!!this.frameState_},e.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},e.prototype.render=function(){void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},e.prototype.removeControl=function(t){return this.getControls().remove(t)},e.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)},e.prototype.removeLayer=function(t){return this.getLayerGroup().getLayers().remove(t)},e.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)},e.prototype.renderFrame_=function(t){var e,i=this.getSize(),r=this.getView(),o=Object(vt.i)(),s=this.frameState_,c=null;if(void 0!==i&&Object(Ot.a)(i)&&r&&r.isDef()){for(var h=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=this.getLayerGroup().getLayerStatesArray(),u={},_=0,d=l.length;_<d;++_)u[Object(n.b)(l[_].layer)]=l[_];e=r.getState();var p=this.focus_;if(!p){p=e.center;var f=e.resolution/this.pixelRatio_;p[0]=Math.round(p[0]/f)*f,p[1]=Math.round(p[1]/f)*f}c={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,extent:o,focus:p,index:this.frameIndex_++,layerStates:u,layerStatesArray:l,pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:i,skippedFeatureUids:this.skippedFeatureUids_,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:e,viewHints:h,wantedTiles:{}}}c&&(c.extent=Object(vt.y)(e.center,e.resolution,e.rotation,c.size,o)),this.frameState_=c,this.renderer_.renderFrame(c),c&&(c.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,c.postRenderFunctions),s&&(!this.previousExtent_||!Object(vt.G)(this.previousExtent_)&&!Object(vt.o)(c.extent,this.previousExtent_))&&(this.dispatchEvent(new a(rt.a.MOVESTART,this,s)),this.previousExtent_=Object(vt.k)(this.previousExtent_)),this.previousExtent_&&!c.viewHints[ft.a.ANIMATING]&&!c.viewHints[ft.a.INTERACTING]&&!Object(vt.o)(c.extent,this.previousExtent_)&&(this.dispatchEvent(new a(rt.a.MOVEEND,this,c)),Object(vt.d)(c.extent,this.previousExtent_))),this.dispatchEvent(new a(rt.a.POSTRENDER,this,c)),setTimeout(this.handlePostRender.bind(this),0)},e.prototype.setLayerGroup=function(t){this.set(ot.LAYERGROUP,t)},e.prototype.setSize=function(t){this.set(ot.SIZE,t)},e.prototype.setTarget=function(t){this.set(ot.TARGET,t)},e.prototype.setView=function(t){this.set(ot.VIEW,t)},e.prototype.skipFeature=function(t){var e=Object(n.b)(t).toString();this.skippedFeatureUids_[e]=!0,this.render()},e.prototype.updateSize=function(){var t=this.getTargetElement();if(t){var e=getComputedStyle(t);this.setSize([t.offsetWidth-parseFloat(e.borderLeftWidth)-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight)-parseFloat(e.borderRightWidth),t.offsetHeight-parseFloat(e.borderTopWidth)-parseFloat(e.paddingTop)-parseFloat(e.paddingBottom)-parseFloat(e.borderBottomWidth)])}else this.setSize(void 0)},e.prototype.unskipFeature=function(t){var e=Object(n.b)(t).toString();delete this.skippedFeatureUids_[e],this.render()},e}(st.a),wt=function(t){function e(e){t.call(this),this.element=e.element?e.element:null,this.target_=null,this.map_=null,this.listenerKeys=[],this.render=e.render?e.render:mt.c,e.target&&this.setTarget(e.target)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){Object(gt.e)(this.element),t.prototype.disposeInternal.call(this)},e.prototype.getMap=function(){return this.map_},e.prototype.setMap=function(t){this.map_&&Object(gt.e)(this.element);for(var e=0,i=this.listenerKeys.length;e<i;++e)Object(d.e)(this.listenerKeys[e]);this.listenerKeys.length=0,this.map_=t,this.map_&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==mt.c&&this.listenerKeys.push(Object(d.a)(t,rt.a.POSTRENDER,this.render,this)),t.render())},e.prototype.setTarget=function(t){this.target_="string"==typeof t?document.getElementById(t):t},e}(st.a),Rt=i(22),Mt=i(31);function Pt(t){this.updateElement_(t.frameState)}var It=function(t){function e(e){var i=e||{};t.call(this,{element:document.createElement("div"),render:i.render||Pt,target:i.target}),this.ulElement_=document.createElement("UL"),this.collapsed_=void 0===i.collapsed||i.collapsed,this.collapsible_=void 0===i.collapsible||i.collapsible,this.collapsible_||(this.collapsed_=!1);var n=void 0!==i.className?i.className:"ol-attribution",r=void 0!==i.tipLabel?i.tipLabel:"Attributions",o=void 0!==i.collapseLabel?i.collapseLabel:"";"string"==typeof o?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=o):this.collapseLabel_=o;var s=void 0!==i.label?i.label:"i";"string"==typeof s?(this.label_=document.createElement("span"),this.label_.textContent=s):this.label_=s;var a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,c=document.createElement("button");c.setAttribute("type","button"),c.title=r,c.appendChild(a),Object(d.a)(c,l.a.CLICK,this.handleClick_,this);var h=n+" "+Rt.e+" "+Rt.b+(this.collapsed_&&this.collapsible_?" "+Rt.a:"")+(this.collapsible_?"":" ol-uncollapsible"),u=this.element;u.className=h,u.appendChild(this.ulElement_),u.appendChild(c),this.renderedAttributions_=[],this.renderedVisible_=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getSourceAttributions_=function(t){for(var e={},i=[],n=t.layerStatesArray,r=t.viewState.resolution,o=0,s=n.length;o<s;++o){var a=n[o];if(Object(Mt.b)(a,r)){var c=a.layer.getSource();if(c){var h=c.getAttributions();if(h){var l=h(t);if(l)if(Array.isArray(l))for(var u=0,_=l.length;u<_;++u)l[u]in e||(i.push(l[u]),e[l[u]]=!0);else l in e||(i.push(l),e[l]=!0)}}}}return i},e.prototype.updateElement_=function(t){if(t){var e=this.getSourceAttributions_(t),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!Object(q.a)(e,this.renderedAttributions_)){Object(gt.d)(this.ulElement_);for(var n=0,r=e.length;n<r;++n){var o=document.createElement("LI");o.innerHTML=e[n],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},e.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_()},e.prototype.handleToggle_=function(){this.element.classList.toggle(Rt.a),this.collapsed_?Object(gt.f)(this.collapseLabel_,this.label_):Object(gt.f)(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_},e.prototype.getCollapsible=function(){return this.collapsible_},e.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),!t&&this.collapsed_&&this.handleToggle_())},e.prototype.setCollapsed=function(t){this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()},e.prototype.getCollapsed=function(){return this.collapsed_},e}(wt),Dt=i(24);function Lt(t){var e=t.frameState;if(e){var i=e.viewState.rotation;if(i!=this.rotation_){var n="rotate("+i+"rad)";if(this.autoHide_){var r=this.element.classList.contains(Rt.c);r||0!==i?r&&0!==i&&this.element.classList.remove(Rt.c):this.element.classList.add(Rt.c)}this.label_.style.msTransform=n,this.label_.style.webkitTransform=n,this.label_.style.transform=n}this.rotation_=i}}var St=function(t){function e(e){var i=e||{};t.call(this,{element:document.createElement("div"),render:i.render||Lt,target:i.target});var n=void 0!==i.className?i.className:"ol-rotate",r=void 0!==i.label?i.label:"";this.label_=null,"string"==typeof r?(this.label_=document.createElement("span"),this.label_.className="ol-compass",this.label_.textContent=r):(this.label_=r,this.label_.classList.add("ol-compass"));var o=i.tipLabel?i.tipLabel:"Reset rotation",s=document.createElement("button");s.className=n+"-reset",s.setAttribute("type","button"),s.title=o,s.appendChild(this.label_),Object(d.a)(s,l.a.CLICK,this.handleClick_,this);var a=n+" "+Rt.e+" "+Rt.b,c=this.element;c.className=a,c.appendChild(s),this.callResetNorth_=i.resetNorth?i.resetNorth:void 0,this.duration_=void 0!==i.duration?i.duration:250,this.autoHide_=void 0===i.autoHide||i.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Rt.c)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleClick_=function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},e.prototype.resetNorth_=function(){var t=this.getMap().getView();t&&void 0!==t.getRotation()&&(this.duration_>0?t.animate({rotation:0,duration:this.duration_,easing:Dt.b}):t.setRotation(0))},e}(wt),At=function(t){function e(e){var i=e||{};t.call(this,{element:document.createElement("div"),target:i.target});var n=void 0!==i.className?i.className:"ol-zoom",r=void 0!==i.delta?i.delta:1,o=void 0!==i.zoomInLabel?i.zoomInLabel:"+",s=void 0!==i.zoomOutLabel?i.zoomOutLabel:"",a=void 0!==i.zoomInTipLabel?i.zoomInTipLabel:"Zoom in",c=void 0!==i.zoomOutTipLabel?i.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=n+"-in",h.setAttribute("type","button"),h.title=a,h.appendChild("string"==typeof o?document.createTextNode(o):o),Object(d.a)(h,l.a.CLICK,this.handleClick_.bind(this,r));var u=document.createElement("button");u.className=n+"-out",u.setAttribute("type","button"),u.title=c,u.appendChild("string"==typeof s?document.createTextNode(s):s),Object(d.a)(u,l.a.CLICK,this.handleClick_.bind(this,-r));var _=n+" "+Rt.e+" "+Rt.b,p=this.element;p.className=_,p.appendChild(h),p.appendChild(u),this.duration_=void 0!==i.duration?i.duration:250}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleClick_=function(t,e){e.preventDefault(),this.zoomByDelta_(t)},e.prototype.zoomByDelta_=function(t){var e=this.getMap().getView();if(e){var i=e.getResolution();if(i){var n=e.constrainResolution(i,t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({resolution:n,duration:this.duration_,easing:Dt.b})):e.setResolution(n)}}},e}(wt),jt=function(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0};jt.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},jt.prototype.update=function(t,e){this.points_.push(t,e,Date.now())},jt.prototype.end=function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;for(var i=e-3;i>0&&this.points_[i+2]>t;)i-=3;var n=this.points_[e+2]-this.points_[i+2];if(n<1e3/60)return!1;var r=this.points_[e]-this.points_[i],o=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(o,r),this.initialVelocity_=Math.sqrt(r*r+o*o)/n,this.initialVelocity_>this.minVelocity_},jt.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},jt.prototype.getAngle=function(){return this.angle_};var kt=jt,Ft=i(5);function Ut(t,e,i,n){Nt(t,e=t.constrainRotation(e,0),i,n)}function Nt(t,e,i,n){if(void 0!==e){var r=t.getRotation(),o=t.getCenter();void 0!==r&&o&&n>0?t.animate({rotation:e,anchor:i,duration:n,easing:Dt.b}):t.rotate(e,i)}}function Bt(t,e,i,n){var r=t.getResolution(),o=t.constrainResolution(r,e,0);if(void 0!==o){var s=t.getResolutions();o=Object(Ft.a)(o,t.getMinResolution()||s[s.length-1],t.getMaxResolution()||s[0])}if(i&&void 0!==o&&o!==r){var a=t.getCenter(),c=t.calculateCenterZoom(o,i);c=t.constrainCenter(c),i=[(o*a[0]-r*c[0])/(o-r),(o*a[1]-r*c[1])/(o-r)]}Wt(t,o,i,n)}function Wt(t,e,i,n){if(e){var r=t.getResolution(),o=t.getCenter();if(void 0!==r&&o&&e!==r&&n)t.animate({resolution:e,anchor:i,duration:n,easing:Dt.b});else{if(i){var s=t.calculateCenterZoom(e,i);t.setCenter(s)}t.setResolution(e)}}}var zt=function(t){function e(e){t.call(this),this.map_=null,this.setActive(!0),this.handleEvent=e.handleEvent}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getActive=function(){return this.get("active")},e.prototype.getMap=function(){return this.map_},e.prototype.setActive=function(t){this.set("active",t)},e.prototype.setMap=function(t){this.map_=t},e}(st.a);function Gt(t){var e=!1,i=t.originalEvent;if(t.type==u.DBLCLICK){var n=t.map,r=t.coordinate,o=i.shiftKey?-this.delta_:this.delta_;Bt(n.getView(),o,r,this.duration_),t.preventDefault(),e=!0}return!e}var Kt=function(t){function e(e){t.call(this,{handleEvent:Gt});var i=e||{};this.delta_=i.delta?i.delta:1,this.duration_=void 0!==i.duration?i.duration:250}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(zt),Ht=i(38),Yt=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Vt=mt.b,Xt=function(t){var e=t.originalEvent;return 0==e.button&&!(h.i&&h.d&&e.ctrlKey)},qt=(mt.a,function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey}),Zt=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},$t=function(t){var e=t.originalEvent.target.tagName;return"INPUT"!==e&&"SELECT"!==e&&"TEXTAREA"!==e},Jt=function(t){return Object(ht.a)(t.pointerEvent,56),"mouse"==t.pointerEvent.pointerType},Qt=mt.c,te=mt.a,ee=mt.a,ie=mt.c;function ne(t){for(var e=t.length,i=0,n=0,r=0;r<e;r++)i+=t[r].clientX,n+=t[r].clientY;return[i/e,n/e]}function re(t){if(!(t instanceof _))return!0;var e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==u.POINTERDRAG)this.handleDragEvent_(t);else if(t.type==u.POINTERUP){var i=this.handleUpEvent_(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==u.POINTERDOWN){var n=this.handleDownEvent_(t);this.handlingDownUpSequence=n,e=this.stopDown(n)}else t.type==u.POINTERMOVE&&this.handleMoveEvent_(t);return!e}var oe=function(t){function e(e){var i=e||{};t.call(this,{handleEvent:i.handleEvent||re}),this.handleDownEvent_=i.handleDownEvent?i.handleDownEvent:ee,this.handleDragEvent_=i.handleDragEvent?i.handleDragEvent:Qt,this.handleMoveEvent_=i.handleMoveEvent?i.handleMoveEvent:ie,this.handleUpEvent_=i.handleUpEvent?i.handleUpEvent:te,this.handlingDownUpSequence=!1,this.stopDown=i.stopDown?i.stopDown:se,this.trackedPointers_={},this.targetPointers=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.updateTrackedPointers_=function(t){if(function(t){var e=t.type;return e===u.POINTERDOWN||e===u.POINTERDRAG||e===u.POINTERUP}(t)){var e=t.pointerEvent,i=e.pointerId.toString();t.type==u.POINTERUP?delete this.trackedPointers_[i]:t.type==u.POINTERDOWN?this.trackedPointers_[i]=e:i in this.trackedPointers_&&(this.trackedPointers_[i]=e),this.targetPointers=Object(lt.c)(this.trackedPointers_)}},e}(zt);function se(t){return t}function ae(t){var e=this.targetPointers,i=ne(e);if(e.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){var n=this.lastCentroid[0]-i[0],r=i[1]-this.lastCentroid[1],o=t.map.getView(),s=[n,r];Object(Ht.d)(s,o.getResolution()),Object(Ht.c)(s,o.getRotation()),Object(Ht.a)(s,o.getCenter()),s=o.constrainCenter(s),o.setCenter(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=e.length}function ce(t){var e=t.map,i=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var n=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),o=i.getCenter(),s=e.getPixelFromCoordinate(o),a=e.getCoordinateFromPixel([s[0]-n*Math.cos(r),s[1]-n*Math.sin(r)]);i.animate({center:i.constrainCenter(a),duration:500,easing:Dt.b})}return i.setHint(ft.a.INTERACTING,-1),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}function he(t){if(this.targetPointers.length>0&&this.condition_(t)){var e=t.map.getView();return this.lastCentroid=null,this.handlingDownUpSequence||e.setHint(ft.a.INTERACTING,1),e.getAnimating()&&e.setCenter(t.frameState.viewState.center),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}var le=function(t){function e(e){t.call(this,{handleDownEvent:he,handleDragEvent:ae,handleUpEvent:ce,stopDown:mt.a});var i=e||{};this.kinetic_=i.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.condition_=i.condition?i.condition:qt,this.noKinetic_=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(oe),ue=i(37);function _e(t){if(Jt(t)){var e=t.map,i=e.getView();if(i.getConstraints().rotation!==ue.c){var n=e.getSize(),r=t.pixel,o=Math.atan2(n[1]/2-r[1],r[0]-n[0]/2);if(void 0!==this.lastAngle_){var s=o-this.lastAngle_;Nt(i,i.getRotation()-s)}this.lastAngle_=o}}}function de(t){if(!Jt(t))return!0;var e=t.map.getView();return e.setHint(ft.a.INTERACTING,-1),Ut(e,e.getRotation(),void 0,this.duration_),!1}function pe(t){return!(!Jt(t)||!Xt(t)||!this.condition_(t)||(t.map.getView().setHint(ft.a.INTERACTING,1),this.lastAngle_=void 0,0))}var fe=function(t){function e(e){var i=e||{};t.call(this,{handleDownEvent:pe,handleDragEvent:_e,handleUpEvent:de,stopDown:mt.a}),this.condition_=i.condition?i.condition:Yt,this.lastAngle_=void 0,this.duration_=void 0!==i.duration?i.duration:250}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(oe),ge=i(40),ve=i(56),me=function(t){function e(e){t.call(this),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.setMap(null)},e.prototype.render_=function(){var t=this.startPixel_,e=this.endPixel_,i=this.element_.style;i.left=Math.min(t[0],e[0])+"px",i.top=Math.min(t[1],e[1])+"px",i.width=Math.abs(e[0]-t[0])+"px",i.height=Math.abs(e[1]-t[1])+"px"},e.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var e=this.element_.style;e.left=e.top=e.width=e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},e.prototype.setPixels=function(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()},e.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,e=this.endPixel_,i=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixel,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new ve.a([i])},e.prototype.getGeometry=function(){return this.geometry_},e}(ge.a),ye={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend"},be=function(t){function e(e,i,n){t.call(this,e),this.coordinate=i,this.mapBrowserEvent=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(s.a);function Ee(t,e,i){var n=i[0]-e[0],r=i[1]-e[1];return n*n+r*r>=this.minArea_}function xe(t){Jt(t)&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new be(ye.BOXDRAG,t.coordinate,t)))}function Oe(t){return!Jt(t)||(this.box_.setMap(null),this.boxEndCondition_(t,this.startPixel_,t.pixel)&&(this.onBoxEnd_(t),this.dispatchEvent(new be(ye.BOXEND,t.coordinate,t))),!1)}function Ce(t){return!(!Jt(t)||!Xt(t)||!this.condition_(t)||(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new be(ye.BOXSTART,t.coordinate,t)),0))}function Te(){var t=this.getMap(),e=t.getView(),i=t.getSize(),n=this.getGeometry().getExtent();if(this.out_){var r=e.calculateExtent(i),o=Object(vt.m)([t.getPixelFromCoordinate(Object(vt.u)(n)),t.getPixelFromCoordinate(Object(vt.C)(n))]),s=e.getResolutionForExtent(o,i);Object(vt.I)(r,1/s),n=r}var a=e.constrainResolution(e.getResolutionForExtent(n,i)),c=Object(vt.w)(n);c=e.constrainCenter(c),e.animate({resolution:a,center:c,duration:this.duration_,easing:Dt.b})}var we=function(t){function e(e){var i=e||{},n=i.condition?i.condition:Zt;t.call(this,{condition:n,className:i.className||"ol-dragzoom",onBoxEnd:Te}),this.duration_=void 0!==i.duration?i.duration:200,this.out_=void 0!==i.out&&i.out}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(function(t){function e(e){t.call(this,{handleDownEvent:Ce,handleDragEvent:xe,handleUpEvent:Oe});var i=e||{};this.box_=new me(i.className||"ol-dragbox"),this.minArea_=void 0!==i.minArea?i.minArea:64,this.onBoxEnd_=i.onBoxEnd?i.onBoxEnd:mt.c,this.startPixel_=null,this.condition_=i.condition?i.condition:Vt,this.boxEndCondition_=i.boxEndCondition?i.boxEndCondition:Ee}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getGeometry=function(){return this.box_.getGeometry()},e}(oe)),Re={LEFT:37,UP:38,RIGHT:39,DOWN:40};function Me(t){var e=!1;if(t.type==l.a.KEYDOWN){var i=t.originalEvent.keyCode;if(this.condition_(t)&&(i==Re.DOWN||i==Re.LEFT||i==Re.RIGHT||i==Re.UP)){var n=t.map.getView(),r=n.getResolution()*this.pixelDelta_,o=0,s=0;i==Re.DOWN?s=-r:i==Re.LEFT?o=-r:i==Re.RIGHT?o=r:s=r;var a=[o,s];Object(Ht.c)(a,n.getRotation()),function(t,e,i){var n=t.getCenter();if(n){var r=t.constrainCenter([n[0]+e[0],n[1]+e[1]]);i?t.animate({duration:i,easing:Dt.d,center:r}):t.setCenter(r)}}(n,a,this.duration_),t.preventDefault(),e=!0}}return!e}var Pe=function(t){function e(e){t.call(this,{handleEvent:Me});var i=e||{};this.defaultCondition_=function(t){return qt(t)&&$t(t)},this.condition_=void 0!==i.condition?i.condition:this.defaultCondition_,this.duration_=void 0!==i.duration?i.duration:100,this.pixelDelta_=void 0!==i.pixelDelta?i.pixelDelta:128}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(zt);function Ie(t){var e=!1;if(t.type==l.a.KEYDOWN||t.type==l.a.KEYPRESS){var i=t.originalEvent.charCode;if(this.condition_(t)&&(i=="+".charCodeAt(0)||i=="-".charCodeAt(0))){var n=t.map,r=i=="+".charCodeAt(0)?this.delta_:-this.delta_;Bt(n.getView(),r,void 0,this.duration_),t.preventDefault(),e=!0}}return!e}var De=function(t){function e(e){t.call(this,{handleEvent:Ie});var i=e||{};this.condition_=i.condition?i.condition:$t,this.delta_=i.delta?i.delta:1,this.duration_=void 0!==i.duration?i.duration:100}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(zt),Le={TRACKPAD:"trackpad",WHEEL:"wheel"};function Se(t){if(!this.condition_(t))return!0;var e=t.type;if(e!==l.a.WHEEL&&e!==l.a.MOUSEWHEEL)return!0;t.preventDefault();var i,n=t.map,r=t.originalEvent;if(this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==l.a.WHEEL?(i=r.deltaY,h.c&&r.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(i/=h.b),r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(i*=40)):t.type==l.a.MOUSEWHEEL&&(i=-r.wheelDeltaY,h.g&&(i/=3)),0===i)return!1;var o=Date.now();if(void 0===this.startTime_&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(i)<4?Le.TRACKPAD:Le.WHEEL),this.mode_===Le.TRACKPAD){var s=n.getView();this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):s.setHint(ft.a.INTERACTING,1),this.trackpadTimeoutId_=setTimeout(this.decrementInteractingHint_.bind(this),this.trackpadEventGap_);var a=s.getResolution()*Math.pow(2,i/this.trackpadDeltaPerZoom_),c=s.getMinResolution(),u=s.getMaxResolution(),_=0;if(a<c?(a=Math.max(a,c/this.trackpadZoomBuffer_),_=1):a>u&&(a=Math.min(a,u*this.trackpadZoomBuffer_),_=-1),this.lastAnchor_){var d=s.calculateCenterZoom(a,this.lastAnchor_);s.setCenter(s.constrainCenter(d))}return s.setResolution(a),0===_&&this.constrainResolution_&&s.animate({resolution:s.constrainResolution(a,i>0?-1:1),easing:Dt.b,anchor:this.lastAnchor_,duration:this.duration_}),_>0?s.animate({resolution:c,easing:Dt.b,anchor:this.lastAnchor_,duration:500}):_<0&&s.animate({resolution:u,easing:Dt.b,anchor:this.lastAnchor_,duration:500}),this.startTime_=o,!1}this.delta_+=i;var p=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),p),!1}var Ae=function(t){function e(e){t.call(this,{handleEvent:Se});var i=e||{};this.delta_=0,this.duration_=void 0!==i.duration?i.duration:250,this.timeout_=void 0!==i.timeout?i.timeout:80,this.useAnchor_=void 0===i.useAnchor||i.useAnchor,this.constrainResolution_=i.constrainResolution||!1,this.condition_=i.condition?i.condition:Vt,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_=void 0,this.trackpadDeltaPerZoom_=300,this.trackpadZoomBuffer_=1.5}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.decrementInteractingHint_=function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().setHint(ft.a.INTERACTING,-1)},e.prototype.handleWheelZoom_=function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations(),Bt(e,-Object(Ft.a)(this.delta_,-1,1),this.lastAnchor_,this.duration_),this.mode_=void 0,this.delta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},e.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},e}(zt);function je(t){var e=0,i=this.targetPointers[0],n=this.targetPointers[1],r=Math.atan2(n.clientY-i.clientY,n.clientX-i.clientX);if(void 0!==this.lastAngle_){var o=r-this.lastAngle_;this.rotationDelta_+=o,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=o}this.lastAngle_=r;var s=t.map,a=s.getView();if(a.getConstraints().rotation!==ue.c){var c=s.getViewport().getBoundingClientRect(),h=ne(this.targetPointers);if(h[0]-=c.left,h[1]-=c.top,this.anchor_=s.getCoordinateFromPixel(h),this.rotating_){var l=a.getRotation();s.render(),Nt(a,l+e,this.anchor_)}}}function ke(t){if(this.targetPointers.length<2){var e=t.map.getView();return e.setHint(ft.a.INTERACTING,-1),this.rotating_&&Ut(e,e.getRotation(),this.anchor_,this.duration_),!1}return!0}function Fe(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().setHint(ft.a.INTERACTING,1),!0}return!1}var Ue=function(t){function e(e){t.call(this,{handleDownEvent:Fe,handleDragEvent:je,handleUpEvent:ke,stopDown:mt.a});var i=e||{};this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==i.threshold?i.threshold:.3,this.duration_=void 0!==i.duration?i.duration:250}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(oe);function Ne(t){var e=1,i=this.targetPointers[0],n=this.targetPointers[1],r=i.clientX-n.clientX,o=i.clientY-n.clientY,s=Math.sqrt(r*r+o*o);void 0!==this.lastDistance_&&(e=this.lastDistance_/s),this.lastDistance_=s;var a=t.map,c=a.getView(),h=c.getResolution(),l=c.getMaxResolution(),u=c.getMinResolution(),_=h*e;_>l?(e=l/h,_=l):_<u&&(e=u/h,_=u),1!=e&&(this.lastScaleDelta_=e);var d=a.getViewport().getBoundingClientRect(),p=ne(this.targetPointers);p[0]-=d.left,p[1]-=d.top,this.anchor_=a.getCoordinateFromPixel(p),a.render(),Wt(c,_,this.anchor_)}function Be(t){if(this.targetPointers.length<2){var e=t.map.getView();e.setHint(ft.a.INTERACTING,-1);var i=e.getResolution();if(this.constrainResolution_||i<e.getMinResolution()||i>e.getMaxResolution()){var n=this.lastScaleDelta_-1;!function(t,e,i,n,r){Wt(t,e=t.constrainResolution(e,0,r),i,n)}(e,i,this.anchor_,this.duration_,n)}return!1}return!0}function We(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().setHint(ft.a.INTERACTING,1),!0}return!1}var ze=function(t){function e(e){t.call(this,{handleDownEvent:We,handleDragEvent:Ne,handleUpEvent:Be,stopDown:mt.a});var i=e||{};this.constrainResolution_=i.constrainResolution||!1,this.anchor_=null,this.duration_=void 0!==i.duration?i.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(oe),Ge=i(30),Ke=i(35),He=function(t){function e(e,i,n,r,o){t.call(this,e),this.vectorContext=i,this.frameState=n,this.context=r,this.glContext=o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(s.a),Ye=i(43),Ve=i(7),Xe={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"},qe=function(){};qe.prototype.drawCustom=function(t,e,i){},qe.prototype.drawGeometry=function(t){},qe.prototype.setStyle=function(t){},qe.prototype.drawCircle=function(t,e){},qe.prototype.drawFeature=function(t,e){},qe.prototype.drawGeometryCollection=function(t,e){},qe.prototype.drawLineString=function(t,e){},qe.prototype.drawMultiLineString=function(t,e){},qe.prototype.drawMultiPoint=function(t,e){},qe.prototype.drawMultiPolygon=function(t,e){},qe.prototype.drawPoint=function(t,e){},qe.prototype.drawPolygon=function(t,e){},qe.prototype.drawText=function(t,e){},qe.prototype.setFillStrokeStyle=function(t,e){},qe.prototype.setImageStyle=function(t,e){},qe.prototype.setTextStyle=function(t,e){};var Ze=qe,$e=[Xe.POLYGON,Xe.CIRCLE,Xe.LINE_STRING,Xe.IMAGE,Xe.TEXT,Xe.DEFAULT],Je={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},Qe=function(){};Qe.prototype.getReplay=function(t,e){},Qe.prototype.isEmpty=function(){};var ti=Qe,ei=i(28),ii=i(26),ni=i(0),ri=function(t){this.source_=t};ri.prototype.getType=function(){},ri.prototype.getSource=function(){return this.source_},ri.prototype.isAnimated=mt.a;var oi=ri,si=function(t){function e(e){t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getType=function(){return ni.m},e}(oi),ai=function(t){function e(e){t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getType=function(){return ni.J},e}(oi),ci=new si(ni.g?"precision mediump float;\nvarying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_fillColor;\nuniform vec4 u_strokeColor;\nuniform vec2 u_size;\n\nvoid main(void) {\n  vec2 windowCenter = vec2((v_center.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_center.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  vec2 windowOffset = vec2((v_offset.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_offset.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  float radius = length(windowCenter - windowOffset);\n  float dist = length(windowCenter - gl_FragCoord.xy);\n  if (dist > radius + v_halfWidth) {\n    if (u_strokeColor.a == 0.0) {\n      gl_FragColor = u_fillColor;\n    } else {\n      gl_FragColor = u_strokeColor;\n    }\n    gl_FragColor.a = gl_FragColor.a - (dist - (radius + v_halfWidth));\n  } else if (u_fillColor.a == 0.0) {\n    // Hooray, no fill, just stroke. We can use real antialiasing.\n    gl_FragColor = u_strokeColor;\n    if (dist < radius - v_halfWidth) {\n      gl_FragColor.a = gl_FragColor.a - (radius - v_halfWidth - dist);\n    }\n  } else {\n    gl_FragColor = u_fillColor;\n    float strokeDist = radius - v_halfWidth;\n    float antialias = 2.0 * v_pixelRatio;\n    if (dist > strokeDist) {\n      gl_FragColor = u_strokeColor;\n    } else if (dist >= strokeDist - antialias) {\n      float step = smoothstep(strokeDist - antialias, strokeDist, dist);\n      gl_FragColor = mix(u_fillColor, u_strokeColor, step);\n    }\n  }\n  gl_FragColor.a = gl_FragColor.a * u_opacity;\n  if (gl_FragColor.a <= 0.0) {\n    discard;\n  }\n}\n":"precision mediump float;varying vec2 a;varying vec2 b;varying float c;varying float d;uniform float m;uniform vec4 n;uniform vec4 o;uniform vec2 p;void main(void){vec2 windowCenter=vec2((a.x+1.0)/2.0*p.x*d,(a.y+1.0)/2.0*p.y*d);vec2 windowOffset=vec2((b.x+1.0)/2.0*p.x*d,(b.y+1.0)/2.0*p.y*d);float radius=length(windowCenter-windowOffset);float dist=length(windowCenter-gl_FragCoord.xy);if(dist>radius+c){if(o.a==0.0){gl_FragColor=n;}else{gl_FragColor=o;}gl_FragColor.a=gl_FragColor.a-(dist-(radius+c));}else if(n.a==0.0){gl_FragColor=o;if(dist<radius-c){gl_FragColor.a=gl_FragColor.a-(radius-c-dist);}} else{gl_FragColor=n;float strokeDist=radius-c;float antialias=2.0*d;if(dist>strokeDist){gl_FragColor=o;}else if(dist>=strokeDist-antialias){float step=smoothstep(strokeDist-antialias,strokeDist,dist);gl_FragColor=mix(n,o,step);}} gl_FragColor.a=gl_FragColor.a*m;if(gl_FragColor.a<=0.0){discard;}}"),hi=new ai(ni.g?"varying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\nattribute vec2 a_position;\nattribute float a_instruction;\nattribute float a_radius;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  v_center = vec4(u_projectionMatrix * vec4(a_position, 0.0, 1.0)).xy;\n  v_pixelRatio = u_pixelRatio;\n  float lineWidth = u_lineWidth * u_pixelRatio;\n  v_halfWidth = lineWidth / 2.0;\n  if (lineWidth == 0.0) {\n    lineWidth = 2.0 * u_pixelRatio;\n  }\n  vec2 offset;\n  // Radius with anitaliasing (roughly).\n  float radius = a_radius + 3.0 * u_pixelRatio;\n  // Until we get gl_VertexID in WebGL, we store an instruction.\n  if (a_instruction == 0.0) {\n    // Offsetting the edges of the triangle by lineWidth / 2 is necessary, however\n    // we should also leave some space for the antialiasing, thus we offset by lineWidth.\n    offset = vec2(-1.0, 1.0);\n  } else if (a_instruction == 1.0) {\n    offset = vec2(-1.0, -1.0);\n  } else if (a_instruction == 2.0) {\n    offset = vec2(1.0, -1.0);\n  } else {\n    offset = vec2(1.0, 1.0);\n  }\n\n  gl_Position = u_projectionMatrix * vec4(a_position + offset * radius, 0.0, 1.0) +\n      offsetMatrix * vec4(offset * lineWidth, 0.0, 0.0);\n  v_offset = vec4(u_projectionMatrix * vec4(a_position.x + a_radius, a_position.y,\n      0.0, 1.0)).xy;\n\n  if (distance(v_center, v_offset) > 20000.0) {\n    gl_Position = vec4(v_center, 0.0, 1.0);\n  }\n}\n\n\n":"varying vec2 a;varying vec2 b;varying float c;varying float d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;void main(void){mat4 offsetMatrix=i*j;a=vec4(h*vec4(e,0.0,1.0)).xy;d=l;float lineWidth=k*l;c=lineWidth/2.0;if(lineWidth==0.0){lineWidth=2.0*l;}vec2 offset;float radius=g+3.0*l;if(f==0.0){offset=vec2(-1.0,1.0);}else if(f==1.0){offset=vec2(-1.0,-1.0);}else if(f==2.0){offset=vec2(1.0,-1.0);}else{offset=vec2(1.0,1.0);}gl_Position=h*vec4(e+offset*radius,0.0,1.0)+offsetMatrix*vec4(offset*lineWidth,0.0,0.0);b=vec4(h*vec4(e.x+g,e.y,0.0,1.0)).xy;if(distance(a,b)>20000.0){gl_Position=vec4(a,0.0,1.0);}}");function li(t,e){return t[0]=e[0],t[1]=e[1],t[4]=e[2],t[5]=e[3],t[12]=e[4],t[13]=e[5],t}var ui=function(t){function e(e,i){t.call(this),this.tolerance=e,this.maxExtent=i,this.origin=Object(vt.w)(i),this.projectionMatrix_=Object(Ct.c)(),this.offsetRotateMatrix_=Object(Ct.c)(),this.offsetScaleMatrix_=Object(Ct.c)(),this.tmpMat4_=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.indices=[],this.indicesBuffer=null,this.startIndices=[],this.startIndicesFeature=[],this.vertices=[],this.verticesBuffer=null,this.lineStringReplay=void 0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDeleteResourcesFunction=function(t){},e.prototype.finish=function(t){},e.prototype.setUpProgram=function(t,e,i,n){},e.prototype.shutDownProgram=function(t,e){},e.prototype.drawReplay=function(t,e,i,n){},e.prototype.drawHitDetectionReplayOneByOne=function(t,e,i,n,r){},e.prototype.drawHitDetectionReplay=function(t,e,i,n,r,o){return r?this.drawHitDetectionReplayOneByOne(t,e,i,n,o):this.drawHitDetectionReplayAll(t,e,i,n)},e.prototype.drawHitDetectionReplayAll=function(t,e,i,n){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawReplay(t,e,i,!0);var r=n(null);return r||void 0},e.prototype.replay=function(t,e,i,n,r,o,s,a,c,h,l){var u,_,d,p,f,g,v,m,y=t.getGL();this.lineStringReplay&&(u=y.isEnabled(y.STENCIL_TEST),_=y.getParameter(y.STENCIL_FUNC),d=y.getParameter(y.STENCIL_VALUE_MASK),p=y.getParameter(y.STENCIL_REF),f=y.getParameter(y.STENCIL_WRITEMASK),g=y.getParameter(y.STENCIL_FAIL),v=y.getParameter(y.STENCIL_PASS_DEPTH_PASS),m=y.getParameter(y.STENCIL_PASS_DEPTH_FAIL),y.enable(y.STENCIL_TEST),y.clear(y.STENCIL_BUFFER_BIT),y.stencilMask(255),y.stencilFunc(y.ALWAYS,1,255),y.stencilOp(y.KEEP,y.KEEP,y.REPLACE),this.lineStringReplay.replay(t,e,i,n,r,o,s,a,c,h,l),y.stencilMask(0),y.stencilFunc(y.NOTEQUAL,1,255)),t.bindBuffer(ni.a,this.verticesBuffer),t.bindBuffer(ni.j,this.indicesBuffer);var b=this.setUpProgram(y,t,r,o),E=Object(Ct.f)(this.projectionMatrix_);Object(Ct.h)(E,2/(i*r[0]),2/(i*r[1])),Object(Ct.g)(E,-n),Object(Ct.j)(E,-(e[0]-this.origin[0]),-(e[1]-this.origin[1]));var x=Object(Ct.f)(this.offsetScaleMatrix_);Object(Ct.h)(x,2/r[0],2/r[1]);var O,C=Object(Ct.f)(this.offsetRotateMatrix_);return 0!==n&&Object(Ct.g)(C,-n),y.uniformMatrix4fv(b.u_projectionMatrix,!1,li(this.tmpMat4_,E)),y.uniformMatrix4fv(b.u_offsetScaleMatrix,!1,li(this.tmpMat4_,x)),y.uniformMatrix4fv(b.u_offsetRotateMatrix,!1,li(this.tmpMat4_,C)),y.uniform1f(b.u_opacity,s),void 0===c?this.drawReplay(y,t,a,!1):O=this.drawHitDetectionReplay(y,t,a,c,h,l),this.shutDownProgram(y,b),this.lineStringReplay&&(u||y.disable(y.STENCIL_TEST),y.clear(y.STENCIL_BUFFER_BIT),y.stencilFunc(_,p,d),y.stencilMask(f),y.stencilOp(g,m,v)),O},e.prototype.drawElements=function(t,e,i,n){var r=e.hasOESElementIndexUint?ni.H:ni.I,o=n-i,s=i*(e.hasOESElementIndexUint?4:2);t.drawElements(ni.E,o,r,s)},e}(Ze),_i=[0,0,0,1],di=[],pi=[0,0,0,1],fi=Number.EPSILON||2.220446049250313e-16,gi=function(t,e,i,n,r,o){var s=(i-t)*(o-e)-(r-t)*(n-e);return s<=fi&&s>=-fi?void 0:s>0},vi={STATIC_DRAW:ni.v,STREAM_DRAW:ni.x,DYNAMIC_DRAW:ni.i},mi=function(t,e){this.arr_=void 0!==t?t:[],this.usage_=void 0!==e?e:vi.STATIC_DRAW};mi.prototype.getArray=function(){return this.arr_},mi.prototype.getUsage=function(){return this.usage_};var yi=mi,bi=function(t){function e(e,i){t.call(this,e,i),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.radius_=0,this.state_={fillColor:null,strokeColor:null,lineDash:null,lineDashOffset:void 0,lineWidth:void 0,changed:!1}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawCoordinates_=function(t,e,i,n){var r,o,s=this.vertices.length,a=this.indices.length,c=s/4;for(r=e,o=i;r<o;r+=n)this.vertices[s++]=t[r],this.vertices[s++]=t[r+1],this.vertices[s++]=0,this.vertices[s++]=this.radius_,this.vertices[s++]=t[r],this.vertices[s++]=t[r+1],this.vertices[s++]=1,this.vertices[s++]=this.radius_,this.vertices[s++]=t[r],this.vertices[s++]=t[r+1],this.vertices[s++]=2,this.vertices[s++]=this.radius_,this.vertices[s++]=t[r],this.vertices[s++]=t[r+1],this.vertices[s++]=3,this.vertices[s++]=this.radius_,this.indices[a++]=c,this.indices[a++]=c+1,this.indices[a++]=c+2,this.indices[a++]=c+2,this.indices[a++]=c+3,this.indices[a++]=c,c+=4},e.prototype.drawCircle=function(t,e){var i=t.getRadius(),n=t.getStride();if(i){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.radius_=i;var r=t.getFlatCoordinates();r=Object(ii.d)(r,0,2,n,-this.origin[0],-this.origin[1]),this.drawCoordinates_(r,0,2,n)}else if(this.state_.changed&&(this.styles_.pop(),this.styles_.length)){var o=this.styles_[this.styles_.length-1];this.state_.fillColor=o[0],this.state_.strokeColor=o[1],this.state_.lineWidth=o[2],this.state_.changed=!1}},e.prototype.finish=function(t){this.verticesBuffer=new yi(this.vertices),this.indicesBuffer=new yi(this.indices),this.startIndices.push(this.indices.length),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},e.prototype.getDeleteResourcesFunction=function(t){var e=this.verticesBuffer,i=this.indicesBuffer;return function(){t.deleteBuffer(e),t.deleteBuffer(i)}},e.prototype.setUpProgram=function(t,e,i,n){var r,o=e.getProgram(ci,hi);return this.defaultLocations_?r=this.defaultLocations_:(r=new function(t,e){this.u_projectionMatrix=t.getUniformLocation(e,ni.g?"u_projectionMatrix":"h"),this.u_offsetScaleMatrix=t.getUniformLocation(e,ni.g?"u_offsetScaleMatrix":"i"),this.u_offsetRotateMatrix=t.getUniformLocation(e,ni.g?"u_offsetRotateMatrix":"j"),this.u_lineWidth=t.getUniformLocation(e,ni.g?"u_lineWidth":"k"),this.u_pixelRatio=t.getUniformLocation(e,ni.g?"u_pixelRatio":"l"),this.u_opacity=t.getUniformLocation(e,ni.g?"u_opacity":"m"),this.u_fillColor=t.getUniformLocation(e,ni.g?"u_fillColor":"n"),this.u_strokeColor=t.getUniformLocation(e,ni.g?"u_strokeColor":"o"),this.u_size=t.getUniformLocation(e,ni.g?"u_size":"p"),this.a_position=t.getAttribLocation(e,ni.g?"a_position":"e"),this.a_instruction=t.getAttribLocation(e,ni.g?"a_instruction":"f"),this.a_radius=t.getAttribLocation(e,ni.g?"a_radius":"g")}(t,o),this.defaultLocations_=r),e.useProgram(o),t.enableVertexAttribArray(r.a_position),t.vertexAttribPointer(r.a_position,2,ni.l,!1,16,0),t.enableVertexAttribArray(r.a_instruction),t.vertexAttribPointer(r.a_instruction,1,ni.l,!1,16,8),t.enableVertexAttribArray(r.a_radius),t.vertexAttribPointer(r.a_radius,1,ni.l,!1,16,12),t.uniform2fv(r.u_size,i),t.uniform1f(r.u_pixelRatio,n),r},e.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_position),t.disableVertexAttribArray(e.a_instruction),t.disableVertexAttribArray(e.a_radius)},e.prototype.drawReplay=function(t,e,i,n){var r,o,s,a;if(Object(lt.d)(i))for(s=this.startIndices[this.startIndices.length-1],r=this.styleIndices_.length-1;r>=0;--r)o=this.styleIndices_[r],a=this.styles_[r],this.setFillStyle_(t,a[0]),this.setStrokeStyle_(t,a[1],a[2]),this.drawElements(t,e,o,s),s=o;else this.drawReplaySkipping_(t,e,i)},e.prototype.drawHitDetectionReplayOneByOne=function(t,e,i,r,o){var s,a,c,h,l,u,_;for(_=this.startIndices.length-2,c=this.startIndices[_+1],s=this.styleIndices_.length-1;s>=0;--s)for(h=this.styles_[s],this.setFillStyle_(t,h[0]),this.setStrokeStyle_(t,h[1],h[2]),l=this.styleIndices_[s];_>=0&&this.startIndices[_]>=l;){if(a=this.startIndices[_],u=this.startIndicesFeature[_],void 0===i[Object(n.b)(u).toString()]&&u.getGeometry()&&(void 0===o||Object(vt.E)(o,u.getGeometry().getExtent()))){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawElements(t,e,a,c);var d=r(u);if(d)return d}_--,c=a}},e.prototype.drawReplaySkipping_=function(t,e,i){var r,o,s,a,c,h,l,u;for(l=this.startIndices.length-2,s=o=this.startIndices[l+1],r=this.styleIndices_.length-1;r>=0;--r){for(a=this.styles_[r],this.setFillStyle_(t,a[0]),this.setStrokeStyle_(t,a[1],a[2]),c=this.styleIndices_[r];l>=0&&this.startIndices[l]>=c;)u=this.startIndices[l],h=this.startIndicesFeature[l],i[Object(n.b)(h).toString()]&&(o!==s&&this.drawElements(t,e,o,s),s=u),l--,o=u;o!==s&&this.drawElements(t,e,o,s),o=s=c}},e.prototype.setFillStyle_=function(t,e){t.uniform4fv(this.defaultLocations_.u_fillColor,e)},e.prototype.setStrokeStyle_=function(t,e,i){t.uniform4fv(this.defaultLocations_.u_strokeColor,e),t.uniform1f(this.defaultLocations_.u_lineWidth,i)},e.prototype.setFillStrokeStyle=function(t,e){var i,n;if(e){var r=e.getLineDash();this.state_.lineDash=r||di;var o=e.getLineDashOffset();this.state_.lineDashOffset=o||0,i=(i=e.getColor())instanceof CanvasGradient||i instanceof CanvasPattern?pi:Object(ei.a)(i).map(function(t,e){return 3!=e?t/255:t})||pi,n=void 0!==(n=e.getWidth())?n:1}else i=[0,0,0,0],n=0;var s=t?t.getColor():[0,0,0,0];s=s instanceof CanvasGradient||s instanceof CanvasPattern?_i:Object(ei.a)(s).map(function(t,e){return 3!=e?t/255:t})||_i,this.state_.strokeColor&&Object(q.a)(this.state_.strokeColor,i)&&this.state_.fillColor&&Object(q.a)(this.state_.fillColor,s)&&this.state_.lineWidth===n||(this.state_.changed=!0,this.state_.fillColor=s,this.state_.strokeColor=i,this.state_.lineWidth=n,this.styles_.push([s,i,n]))},e}(ui),Ei=new si(ni.g?"precision mediump float;\nvarying vec2 v_texCoord;\nvarying float v_opacity;\n\nuniform float u_opacity;\nuniform sampler2D u_image;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  float alpha = texColor.a * v_opacity * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;varying vec2 a;varying float b;uniform float k;uniform sampler2D l;void main(void){vec4 texColor=texture2D(l,a);gl_FragColor.rgb=texColor.rgb;float alpha=texColor.a*b*k;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}"),xi=new ai(ni.g?"varying vec2 v_texCoord;\nvarying float v_opacity;\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nattribute vec2 a_offsets;\nattribute float a_opacity;\nattribute float a_rotateWithView;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix;\n  if (a_rotateWithView == 1.0) {\n    offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  }\n  vec4 offsets = offsetMatrix * vec4(a_offsets, 0.0, 0.0);\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n  v_texCoord = a_texCoord;\n  v_opacity = a_opacity;\n}\n\n\n":"varying vec2 a;varying float b;attribute vec2 c;attribute vec2 d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;void main(void){mat4 offsetMatrix=i;if(g==1.0){offsetMatrix=i*j;}vec4 offsets=offsetMatrix*vec4(e,0.0,0.0);gl_Position=h*vec4(c,0.0,1.0)+offsets;a=d;b=f;}"),Oi={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"};function Ci(t,e,i){var n=t.createTexture();return t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),void 0!==e&&t.texParameteri(ni.z,ni.C,e),void 0!==i&&t.texParameteri(ni.z,ni.D,i),n}function Ti(t,e,i,n,r){var o=Ci(t,n,r);return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,i,0,t.RGBA,t.UNSIGNED_BYTE,null),o}function wi(t,e,i,n){var r=Ci(t,i,n);return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),r}var Ri=function(t){function e(e,i){t.call(this),this.canvas_=e,this.gl_=i,this.bufferCache_={},this.shaderCache_={},this.programCache_={},this.currentProgram_=null,this.hitDetectionFramebuffer_=null,this.hitDetectionTexture_=null,this.hitDetectionRenderbuffer_=null,this.hasOESElementIndexUint=Object(q.c)(ni.k,"OES_element_index_uint"),this.hasOESElementIndexUint&&i.getExtension("OES_element_index_uint"),Object(d.a)(this.canvas_,Oi.LOST,this.handleWebGLContextLost,this),Object(d.a)(this.canvas_,Oi.RESTORED,this.handleWebGLContextRestored,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bindBuffer=function(t,e){var i=this.getGL(),r=e.getArray(),o=String(Object(n.b)(e));if(o in this.bufferCache_){var s=this.bufferCache_[o];i.bindBuffer(t,s.buffer)}else{var a,c=i.createBuffer();i.bindBuffer(t,c),t==ni.a?a=new Float32Array(r):t==ni.j&&(a=this.hasOESElementIndexUint?new Uint32Array(r):new Uint16Array(r)),i.bufferData(t,a,e.getUsage()),this.bufferCache_[o]={buf:e,buffer:c}}},e.prototype.deleteBuffer=function(t){var e=this.getGL(),i=String(Object(n.b)(t)),r=this.bufferCache_[i];e.isContextLost()||e.deleteBuffer(r.buffer),delete this.bufferCache_[i]},e.prototype.disposeInternal=function(){Object(d.d)(this.canvas_);var t=this.getGL();if(!t.isContextLost()){for(var e in this.bufferCache_)t.deleteBuffer(this.bufferCache_[e].buffer);for(var i in this.programCache_)t.deleteProgram(this.programCache_[i]);for(var n in this.shaderCache_)t.deleteShader(this.shaderCache_[n]);t.deleteFramebuffer(this.hitDetectionFramebuffer_),t.deleteRenderbuffer(this.hitDetectionRenderbuffer_),t.deleteTexture(this.hitDetectionTexture_)}},e.prototype.getCanvas=function(){return this.canvas_},e.prototype.getGL=function(){return this.gl_},e.prototype.getHitDetectionFramebuffer=function(){return this.hitDetectionFramebuffer_||this.initHitDetectionFramebuffer_(),this.hitDetectionFramebuffer_},e.prototype.getShader=function(t){var e=String(Object(n.b)(t));if(e in this.shaderCache_)return this.shaderCache_[e];var i=this.getGL(),r=i.createShader(t.getType());return i.shaderSource(r,t.getSource()),i.compileShader(r),this.shaderCache_[e]=r,r},e.prototype.getProgram=function(t,e){var i=Object(n.b)(t)+"/"+Object(n.b)(e);if(i in this.programCache_)return this.programCache_[i];var r=this.getGL(),o=r.createProgram();return r.attachShader(o,this.getShader(t)),r.attachShader(o,this.getShader(e)),r.linkProgram(o),this.programCache_[i]=o,o},e.prototype.handleWebGLContextLost=function(){Object(lt.b)(this.bufferCache_),Object(lt.b)(this.shaderCache_),Object(lt.b)(this.programCache_),this.currentProgram_=null,this.hitDetectionFramebuffer_=null,this.hitDetectionTexture_=null,this.hitDetectionRenderbuffer_=null},e.prototype.handleWebGLContextRestored=function(){},e.prototype.initHitDetectionFramebuffer_=function(){var t=this.gl_,e=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,e);var i=Ti(t,1,1),n=t.createRenderbuffer();t.bindRenderbuffer(t.RENDERBUFFER,n),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,1,1),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,n),t.bindTexture(t.TEXTURE_2D,null),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null),this.hitDetectionFramebuffer_=e,this.hitDetectionTexture_=i,this.hitDetectionRenderbuffer_=n},e.prototype.useProgram=function(t){return t!=this.currentProgram_&&(this.getGL().useProgram(t),this.currentProgram_=t,!0)},e}(ge.a),Mi=function(t){function e(e,i){t.call(this,e,i),this.anchorX=void 0,this.anchorY=void 0,this.groupIndices=[],this.hitDetectionGroupIndices=[],this.height=void 0,this.imageHeight=void 0,this.imageWidth=void 0,this.defaultLocations=null,this.opacity=void 0,this.originX=void 0,this.originY=void 0,this.rotateWithView=void 0,this.rotation=void 0,this.scale=void 0,this.width=void 0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDeleteResourcesFunction=function(t){var e=this.verticesBuffer,i=this.indicesBuffer,n=this.getTextures(!0),r=t.getGL();return function(){var o,s;if(!r.isContextLost())for(o=0,s=n.length;o<s;++o)r.deleteTexture(n[o]);t.deleteBuffer(e),t.deleteBuffer(i)}},e.prototype.drawCoordinates=function(t,e,i,n){var r,o,s,a,c,h,l=this.anchorX,u=this.anchorY,_=this.height,d=this.imageHeight,p=this.imageWidth,f=this.opacity,g=this.originX,v=this.originY,m=this.rotateWithView?1:0,y=-this.rotation,b=this.scale,E=this.width,x=Math.cos(y),O=Math.sin(y),C=this.indices.length,T=this.vertices.length;for(r=e;r<i;r+=n)c=t[r]-this.origin[0],h=t[r+1]-this.origin[1],o=T/8,s=-b*l,a=-b*(_-u),this.vertices[T++]=c,this.vertices[T++]=h,this.vertices[T++]=s*x-a*O,this.vertices[T++]=s*O+a*x,this.vertices[T++]=g/p,this.vertices[T++]=(v+_)/d,this.vertices[T++]=f,this.vertices[T++]=m,s=b*(E-l),a=-b*(_-u),this.vertices[T++]=c,this.vertices[T++]=h,this.vertices[T++]=s*x-a*O,this.vertices[T++]=s*O+a*x,this.vertices[T++]=(g+E)/p,this.vertices[T++]=(v+_)/d,this.vertices[T++]=f,this.vertices[T++]=m,s=b*(E-l),a=b*u,this.vertices[T++]=c,this.vertices[T++]=h,this.vertices[T++]=s*x-a*O,this.vertices[T++]=s*O+a*x,this.vertices[T++]=(g+E)/p,this.vertices[T++]=v/d,this.vertices[T++]=f,this.vertices[T++]=m,s=-b*l,a=b*u,this.vertices[T++]=c,this.vertices[T++]=h,this.vertices[T++]=s*x-a*O,this.vertices[T++]=s*O+a*x,this.vertices[T++]=g/p,this.vertices[T++]=v/d,this.vertices[T++]=f,this.vertices[T++]=m,this.indices[C++]=o,this.indices[C++]=o+1,this.indices[C++]=o+2,this.indices[C++]=o,this.indices[C++]=o+2,this.indices[C++]=o+3;return T},e.prototype.createTextures=function(t,e,i,r){var o,s,a,c,h=e.length;for(c=0;c<h;++c)s=e[c],(a=Object(n.b)(s).toString())in i?o=i[a]:(o=wi(r,s,ni.c,ni.c),i[a]=o),t[c]=o},e.prototype.setUpProgram=function(t,e,i,n){var r,o=e.getProgram(Ei,xi);return this.defaultLocations?r=this.defaultLocations:(r=new function(t,e){this.u_projectionMatrix=t.getUniformLocation(e,ni.g?"u_projectionMatrix":"h"),this.u_offsetScaleMatrix=t.getUniformLocation(e,ni.g?"u_offsetScaleMatrix":"i"),this.u_offsetRotateMatrix=t.getUniformLocation(e,ni.g?"u_offsetRotateMatrix":"j"),this.u_opacity=t.getUniformLocation(e,ni.g?"u_opacity":"k"),this.u_image=t.getUniformLocation(e,ni.g?"u_image":"l"),this.a_position=t.getAttribLocation(e,ni.g?"a_position":"c"),this.a_texCoord=t.getAttribLocation(e,ni.g?"a_texCoord":"d"),this.a_offsets=t.getAttribLocation(e,ni.g?"a_offsets":"e"),this.a_opacity=t.getAttribLocation(e,ni.g?"a_opacity":"f"),this.a_rotateWithView=t.getAttribLocation(e,ni.g?"a_rotateWithView":"g")}(t,o),this.defaultLocations=r),e.useProgram(o),t.enableVertexAttribArray(r.a_position),t.vertexAttribPointer(r.a_position,2,ni.l,!1,32,0),t.enableVertexAttribArray(r.a_offsets),t.vertexAttribPointer(r.a_offsets,2,ni.l,!1,32,8),t.enableVertexAttribArray(r.a_texCoord),t.vertexAttribPointer(r.a_texCoord,2,ni.l,!1,32,16),t.enableVertexAttribArray(r.a_opacity),t.vertexAttribPointer(r.a_opacity,1,ni.l,!1,32,24),t.enableVertexAttribArray(r.a_rotateWithView),t.vertexAttribPointer(r.a_rotateWithView,1,ni.l,!1,32,28),r},e.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_position),t.disableVertexAttribArray(e.a_offsets),t.disableVertexAttribArray(e.a_texCoord),t.disableVertexAttribArray(e.a_opacity),t.disableVertexAttribArray(e.a_rotateWithView)},e.prototype.drawReplay=function(t,e,i,n){var r,o,s,a=n?this.getHitDetectionTextures():this.getTextures(),c=n?this.hitDetectionGroupIndices:this.groupIndices;if(Object(lt.d)(i))for(r=0,o=a.length,s=0;r<o;++r){t.bindTexture(ni.z,a[r]);var h=c[r];this.drawElements(t,e,s,h),s=h}else this.drawReplaySkipping(t,e,i,a,c)},e.prototype.drawReplaySkipping=function(t,e,i,r,o){var s,a,c=0;for(s=0,a=r.length;s<a;++s){t.bindTexture(ni.z,r[s]);for(var h=s>0?o[s-1]:0,l=o[s],u=h,_=h;c<this.startIndices.length&&this.startIndices[c]<=l;){var d=this.startIndicesFeature[c];void 0!==i[Object(n.b)(d).toString()]?(u!==_&&this.drawElements(t,e,u,_),_=u=c===this.startIndices.length-1?l:this.startIndices[c+1]):_=c===this.startIndices.length-1?l:this.startIndices[c+1],c++}u!==_&&this.drawElements(t,e,u,_)}},e.prototype.drawHitDetectionReplayOneByOne=function(t,e,i,r,o){var s,a,c,h,l,u=this.startIndices.length-1,_=this.getHitDetectionTextures();for(s=_.length-1;s>=0;--s)for(t.bindTexture(ni.z,_[s]),a=s>0?this.hitDetectionGroupIndices[s-1]:0,h=this.hitDetectionGroupIndices[s];u>=0&&this.startIndices[u]>=a;){if(c=this.startIndices[u],l=this.startIndicesFeature[u],void 0===i[Object(n.b)(l).toString()]&&l.getGeometry()&&(void 0===o||Object(vt.E)(o,l.getGeometry().getExtent()))){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawElements(t,e,c,h);var d=r(l);if(d)return d}h=c,u--}},e.prototype.finish=function(t){this.anchorX=void 0,this.anchorY=void 0,this.height=void 0,this.imageHeight=void 0,this.imageWidth=void 0,this.indices=null,this.opacity=void 0,this.originX=void 0,this.originY=void 0,this.rotateWithView=void 0,this.rotation=void 0,this.scale=void 0,this.vertices=null,this.width=void 0},e.prototype.getTextures=function(t){},e.prototype.getHitDetectionTextures=function(){},e}(ui),Pi=function(t){function e(e,i){t.call(this,e,i),this.images_=[],this.hitDetectionImages_=[],this.textures_=[],this.hitDetectionTextures_=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawMultiPoint=function(t,e){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e);var i=t.getFlatCoordinates(),n=t.getStride();this.drawCoordinates(i,0,i.length,n)},e.prototype.drawPoint=function(t,e){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e);var i=t.getFlatCoordinates(),n=t.getStride();this.drawCoordinates(i,0,i.length,n)},e.prototype.finish=function(e){var i=e.getGL();this.groupIndices.push(this.indices.length),this.hitDetectionGroupIndices.push(this.indices.length),this.verticesBuffer=new yi(this.vertices);var n=this.indices;this.indicesBuffer=new yi(n);var r={};this.createTextures(this.textures_,this.images_,r,i),this.createTextures(this.hitDetectionTextures_,this.hitDetectionImages_,r,i),this.images_=null,this.hitDetectionImages_=null,t.prototype.finish.call(this,e)},e.prototype.setImageStyle=function(t){var e,i=t.getAnchor(),r=t.getImage(1),o=t.getImageSize(),s=t.getHitDetectionImage(1),a=t.getOpacity(),c=t.getOrigin(),h=t.getRotateWithView(),l=t.getRotation(),u=t.getSize(),_=t.getScale();0===this.images_.length?this.images_.push(r):(e=this.images_[this.images_.length-1],Object(n.b)(e)!=Object(n.b)(r)&&(this.groupIndices.push(this.indices.length),this.images_.push(r))),0===this.hitDetectionImages_.length?this.hitDetectionImages_.push(s):(e=this.hitDetectionImages_[this.hitDetectionImages_.length-1],Object(n.b)(e)!=Object(n.b)(s)&&(this.hitDetectionGroupIndices.push(this.indices.length),this.hitDetectionImages_.push(s))),this.anchorX=i[0],this.anchorY=i[1],this.height=u[1],this.imageHeight=o[1],this.imageWidth=o[0],this.opacity=a,this.originX=c[0],this.originY=c[1],this.rotation=l,this.rotateWithView=h,this.scale=_,this.width=u[0]},e.prototype.getTextures=function(t){return t?this.textures_.concat(this.hitDetectionTextures_):this.textures_},e.prototype.getHitDetectionTextures=function(){return this.hitDetectionTextures_},e}(Mi),Ii=i(39),Di=i(50);function Li(t,e,i,n){var r=i-n;return t[e]===t[r]&&t[e+1]===t[r+1]&&(i-e)/n>3&&!!Object(Di.a)(t,e,i,n)}var Si=new si(ni.g?"precision mediump float;\nvarying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_color;\nuniform vec2 u_size;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  if (v_round > 0.0) {\n    vec2 windowCoords = vec2((v_roundVertex.x + 1.0) / 2.0 * u_size.x * u_pixelRatio,\n        (v_roundVertex.y + 1.0) / 2.0 * u_size.y * u_pixelRatio);\n    if (length(windowCoords - gl_FragCoord.xy) > v_halfWidth * u_pixelRatio) {\n      discard;\n    }\n  }\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;varying float a;varying vec2 aVertex;varying float c;uniform float m;uniform vec4 n;uniform vec2 o;uniform float p;void main(void){if(a>0.0){vec2 windowCoords=vec2((aVertex.x+1.0)/2.0*o.x*p,(aVertex.y+1.0)/2.0*o.y*p);if(length(windowCoords-gl_FragCoord.xy)>c*p){discard;}} gl_FragColor=n;float alpha=n.a*m;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}"),Ai=new ai(ni.g?"varying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\nattribute vec2 a_lastPos;\nattribute vec2 a_position;\nattribute vec2 a_nextPos;\nattribute float a_direction;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_miterLimit;\n\nbool nearlyEquals(in float value, in float ref) {\n  float epsilon = 0.000000000001;\n  return value >= ref - epsilon && value <= ref + epsilon;\n}\n\nvoid alongNormal(out vec2 offset, in vec2 nextP, in float turnDir, in float direction) {\n  vec2 dirVect = nextP - a_position;\n  vec2 normal = normalize(vec2(-turnDir * dirVect.y, turnDir * dirVect.x));\n  offset = u_lineWidth / 2.0 * normal * direction;\n}\n\nvoid miterUp(out vec2 offset, out float round, in bool isRound, in float direction) {\n  float halfWidth = u_lineWidth / 2.0;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_nextPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n  offset = normal * direction * miterLength;\n  round = 0.0;\n  if (isRound) {\n    round = 1.0;\n  } else if (miterLength > u_miterLimit + u_lineWidth) {\n    offset = halfWidth * tmpNormal * direction;\n  }\n}\n\nbool miterDown(out vec2 offset, in vec4 projPos, in mat4 offsetMatrix, in float direction) {\n  bool degenerate = false;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_lastPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  vec2 longOffset, shortOffset, longVertex;\n  vec4 shortProjVertex;\n  float halfWidth = u_lineWidth / 2.0;\n  if (length(a_nextPos - a_position) > length(a_lastPos - a_position)) {\n    longOffset = tmpNormal * direction * halfWidth;\n    shortOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_nextPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_lastPos, 0.0, 1.0);\n  } else {\n    shortOffset = tmpNormal * direction * halfWidth;\n    longOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_lastPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_nextPos, 0.0, 1.0);\n  }\n  //Intersection algorithm based on theory by Paul Bourke (http://paulbourke.net/geometry/pointlineplane/).\n  vec4 p1 = u_projectionMatrix * vec4(longVertex, 0.0, 1.0) + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p2 = projPos + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p3 = shortProjVertex + offsetMatrix * vec4(-shortOffset, 0.0, 0.0);\n  vec4 p4 = shortProjVertex + offsetMatrix * vec4(shortOffset, 0.0, 0.0);\n  float denom = (p4.y - p3.y) * (p2.x - p1.x) - (p4.x - p3.x) * (p2.y - p1.y);\n  float firstU = ((p4.x - p3.x) * (p1.y - p3.y) - (p4.y - p3.y) * (p1.x - p3.x)) / denom;\n  float secondU = ((p2.x - p1.x) * (p1.y - p3.y) - (p2.y - p1.y) * (p1.x - p3.x)) / denom;\n  float epsilon = 0.000000000001;\n  if (firstU > epsilon && firstU < 1.0 - epsilon && secondU > epsilon && secondU < 1.0 - epsilon) {\n    shortProjVertex.x = p1.x + firstU * (p2.x - p1.x);\n    shortProjVertex.y = p1.y + firstU * (p2.y - p1.y);\n    offset = shortProjVertex.xy;\n    degenerate = true;\n  } else {\n    float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n    offset = normal * direction * miterLength;\n  }\n  return degenerate;\n}\n\nvoid squareCap(out vec2 offset, out float round, in bool isRound, in vec2 nextP,\n    in float turnDir, in float direction) {\n  round = 0.0;\n  vec2 dirVect = a_position - nextP;\n  vec2 firstNormal = normalize(dirVect);\n  vec2 secondNormal = vec2(turnDir * firstNormal.y * direction, -turnDir * firstNormal.x * direction);\n  vec2 hypotenuse = normalize(firstNormal - secondNormal);\n  vec2 normal = vec2(turnDir * hypotenuse.y * direction, -turnDir * hypotenuse.x * direction);\n  float length = sqrt(v_halfWidth * v_halfWidth * 2.0);\n  offset = normal * length;\n  if (isRound) {\n    round = 1.0;\n  }\n}\n\nvoid main(void) {\n  bool degenerate = false;\n  float direction = float(sign(a_direction));\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  vec2 offset;\n  vec4 projPos = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n  bool round = nearlyEquals(mod(a_direction, 2.0), 0.0);\n\n  v_round = 0.0;\n  v_halfWidth = u_lineWidth / 2.0;\n  v_roundVertex = projPos.xy;\n\n  if (nearlyEquals(mod(a_direction, 3.0), 0.0) || nearlyEquals(mod(a_direction, 17.0), 0.0)) {\n    alongNormal(offset, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 5.0), 0.0) || nearlyEquals(mod(a_direction, 13.0), 0.0)) {\n    alongNormal(offset, a_lastPos, -1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 23.0), 0.0)) {\n    miterUp(offset, v_round, round, direction);\n  } else if (nearlyEquals(mod(a_direction, 19.0), 0.0)) {\n    degenerate = miterDown(offset, projPos, offsetMatrix, direction);\n  } else if (nearlyEquals(mod(a_direction, 7.0), 0.0)) {\n    squareCap(offset, v_round, round, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 11.0), 0.0)) {\n    squareCap(offset, v_round, round, a_lastPos, -1.0, direction);\n  }\n  if (!degenerate) {\n    vec4 offsets = offsetMatrix * vec4(offset, 0.0, 0.0);\n    gl_Position = projPos + offsets;\n  } else {\n    gl_Position = vec4(offset, 0.0, 1.0);\n  }\n}\n\n\n":"varying float a;varying vec2 aVertex;varying float c;attribute vec2 d;attribute vec2 e;attribute vec2 f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;bool nearlyEquals(in float value,in float ref){float epsilon=0.000000000001;return value>=ref-epsilon&&value<=ref+epsilon;}void alongNormal(out vec2 offset,in vec2 nextP,in float turnDir,in float direction){vec2 dirVect=nextP-e;vec2 normal=normalize(vec2(-turnDir*dirVect.y,turnDir*dirVect.x));offset=k/2.0*normal*direction;}void miterUp(out vec2 offset,out float round,in bool isRound,in float direction){float halfWidth=k/2.0;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=f-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;round=0.0;if(isRound){round=1.0;}else if(miterLength>l+k){offset=halfWidth*tmpNormal*direction;}} bool miterDown(out vec2 offset,in vec4 projPos,in mat4 offsetMatrix,in float direction){bool degenerate=false;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=d-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));vec2 longOffset,shortOffset,longVertex;vec4 shortProjVertex;float halfWidth=k/2.0;if(length(f-e)>length(d-e)){longOffset=tmpNormal*direction*halfWidth;shortOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=f;shortProjVertex=h*vec4(d,0.0,1.0);}else{shortOffset=tmpNormal*direction*halfWidth;longOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=d;shortProjVertex=h*vec4(f,0.0,1.0);}vec4 p1=h*vec4(longVertex,0.0,1.0)+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p2=projPos+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p3=shortProjVertex+offsetMatrix*vec4(-shortOffset,0.0,0.0);vec4 p4=shortProjVertex+offsetMatrix*vec4(shortOffset,0.0,0.0);float denom=(p4.y-p3.y)*(p2.x-p1.x)-(p4.x-p3.x)*(p2.y-p1.y);float firstU=((p4.x-p3.x)*(p1.y-p3.y)-(p4.y-p3.y)*(p1.x-p3.x))/denom;float secondU=((p2.x-p1.x)*(p1.y-p3.y)-(p2.y-p1.y)*(p1.x-p3.x))/denom;float epsilon=0.000000000001;if(firstU>epsilon&&firstU<1.0-epsilon&&secondU>epsilon&&secondU<1.0-epsilon){shortProjVertex.x=p1.x+firstU*(p2.x-p1.x);shortProjVertex.y=p1.y+firstU*(p2.y-p1.y);offset=shortProjVertex.xy;degenerate=true;}else{float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;}return degenerate;}void squareCap(out vec2 offset,out float round,in bool isRound,in vec2 nextP,in float turnDir,in float direction){round=0.0;vec2 dirVect=e-nextP;vec2 firstNormal=normalize(dirVect);vec2 secondNormal=vec2(turnDir*firstNormal.y*direction,-turnDir*firstNormal.x*direction);vec2 hypotenuse=normalize(firstNormal-secondNormal);vec2 normal=vec2(turnDir*hypotenuse.y*direction,-turnDir*hypotenuse.x*direction);float length=sqrt(c*c*2.0);offset=normal*length;if(isRound){round=1.0;}} void main(void){bool degenerate=false;float direction=float(sign(g));mat4 offsetMatrix=i*j;vec2 offset;vec4 projPos=h*vec4(e,0.0,1.0);bool round=nearlyEquals(mod(g,2.0),0.0);a=0.0;c=k/2.0;aVertex=projPos.xy;if(nearlyEquals(mod(g,3.0),0.0)||nearlyEquals(mod(g,17.0),0.0)){alongNormal(offset,f,1.0,direction);}else if(nearlyEquals(mod(g,5.0),0.0)||nearlyEquals(mod(g,13.0),0.0)){alongNormal(offset,d,-1.0,direction);}else if(nearlyEquals(mod(g,23.0),0.0)){miterUp(offset,a,round,direction);}else if(nearlyEquals(mod(g,19.0),0.0)){degenerate=miterDown(offset,projPos,offsetMatrix,direction);}else if(nearlyEquals(mod(g,7.0),0.0)){squareCap(offset,a,round,f,1.0,direction);}else if(nearlyEquals(mod(g,11.0),0.0)){squareCap(offset,a,round,d,-1.0,direction);}if(!degenerate){vec4 offsets=offsetMatrix*vec4(offset,0.0,0.0);gl_Position=projPos+offsets;}else{gl_Position=vec4(offset,0.0,1.0);}}"),ji=function(t){function e(e,i){t.call(this,e,i),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:void 0,miterLimit:void 0,changed:!1}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawCoordinates_=function(t,e,i,n){var r,o,s,a,c,h,l,u,_=this.vertices.length,d=this.indices.length,p="bevel"===this.state_.lineJoin?0:"miter"===this.state_.lineJoin?1:2,f="butt"===this.state_.lineCap?0:"square"===this.state_.lineCap?1:2,g=Li(t,e,i,n),v=d,m=1;for(r=e,o=i;r<o;r+=n){if(c=_/7,h=l,l=u||[t[r],t[r+1]],r===e){if(u=[t[r+n],t[r+n+1]],i-e==2*n&&Object(q.a)(l,u))break;if(!g){f&&(_=this.addVertices_([0,0],l,u,7*m*f,_),_=this.addVertices_([0,0],l,u,7*-m*f,_),this.indices[d++]=c+2,this.indices[d++]=c,this.indices[d++]=c+1,this.indices[d++]=c+1,this.indices[d++]=c+3,this.indices[d++]=c+2),_=this.addVertices_([0,0],l,u,3*m*(f||1),_),v=(_=this.addVertices_([0,0],l,u,3*-m*(f||1),_))/7-1;continue}h=[t[i-2*n],t[i-2*n+1]],s=u}else{if(r===i-n){if(g){u=s;break}h=h||[0,0],_=this.addVertices_(h,l,[0,0],5*m*(f||1),_),_=this.addVertices_(h,l,[0,0],5*-m*(f||1),_),this.indices[d++]=c,this.indices[d++]=v-1,this.indices[d++]=v,this.indices[d++]=v,this.indices[d++]=c+1,this.indices[d++]=c,f&&(_=this.addVertices_(h,l,[0,0],11*m*f,_),_=this.addVertices_(h,l,[0,0],11*-m*f,_),this.indices[d++]=c+2,this.indices[d++]=c,this.indices[d++]=c+1,this.indices[d++]=c+1,this.indices[d++]=c+3,this.indices[d++]=c+2);break}u=[t[r+n],t[r+n+1]]}a=gi(h[0],h[1],l[0],l[1],u[0],u[1])?-1:1,_=this.addVertices_(h,l,u,13*a*(p||1),_),_=this.addVertices_(h,l,u,17*a*(p||1),_),_=this.addVertices_(h,l,u,19*-a*(p||1),_),r>e&&(this.indices[d++]=c,this.indices[d++]=v-1,this.indices[d++]=v,this.indices[d++]=c+2,this.indices[d++]=c,this.indices[d++]=m*a>0?v:v-1),this.indices[d++]=c,this.indices[d++]=c+2,this.indices[d++]=c+1,v=c+2,m=a,p&&(_=this.addVertices_(h,l,u,23*a*p,_),this.indices[d++]=c+1,this.indices[d++]=c+3,this.indices[d++]=c)}g&&(c=c||_/7,a=Object(Ii.a)([h[0],h[1],l[0],l[1],u[0],u[1]],0,6,2)?1:-1,_=this.addVertices_(h,l,u,13*a*(p||1),_),_=this.addVertices_(h,l,u,19*-a*(p||1),_),this.indices[d++]=c,this.indices[d++]=v-1,this.indices[d++]=v,this.indices[d++]=c+1,this.indices[d++]=c,this.indices[d++]=m*a>0?v:v-1)},e.prototype.addVertices_=function(t,e,i,n,r){return this.vertices[r++]=t[0],this.vertices[r++]=t[1],this.vertices[r++]=e[0],this.vertices[r++]=e[1],this.vertices[r++]=i[0],this.vertices[r++]=i[1],this.vertices[r++]=n,r},e.prototype.isValid_=function(t,e,i,n){var r=i-e;if(r<2*n)return!1;if(r===2*n){var o=[t[e],t[e+1]],s=[t[e+n],t[e+n+1]];return!Object(q.a)(o,s)}return!0},e.prototype.drawLineString=function(t,e){var i=t.getFlatCoordinates(),n=t.getStride();this.isValid_(i,0,i.length,n)&&(i=Object(ii.d)(i,0,i.length,n,-this.origin[0],-this.origin[1]),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e),this.drawCoordinates_(i,0,i.length,n))},e.prototype.drawMultiLineString=function(t,e){var i=this.indices.length,n=t.getEnds();n.unshift(0);var r,o,s=t.getFlatCoordinates(),a=t.getStride();if(n.length>1)for(r=1,o=n.length;r<o;++r)if(this.isValid_(s,n[r-1],n[r],a)){var c=Object(ii.d)(s,n[r-1],n[r],a,-this.origin[0],-this.origin[1]);this.drawCoordinates_(c,0,c.length,a)}this.indices.length>i&&(this.startIndices.push(i),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(i),this.state_.changed=!1))},e.prototype.drawPolygonCoordinates=function(t,e,i){var n,r;if(Li(t,0,t.length,i)||(t.push(t[0]),t.push(t[1])),this.drawCoordinates_(t,0,t.length,i),e.length)for(n=0,r=e.length;n<r;++n)Li(e[n],0,e[n].length,i)||(e[n].push(e[n][0]),e[n].push(e[n][1])),this.drawCoordinates_(e[n],0,e[n].length,i)},e.prototype.setPolygonStyle=function(t,e){var i=void 0===e?this.indices.length:e;this.startIndices.push(i),this.startIndicesFeature.push(t),this.state_.changed&&(this.styleIndices_.push(i),this.state_.changed=!1)},e.prototype.getCurrentIndex=function(){return this.indices.length},e.prototype.finish=function(t){this.verticesBuffer=new yi(this.vertices),this.indicesBuffer=new yi(this.indices),this.startIndices.push(this.indices.length),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},e.prototype.getDeleteResourcesFunction=function(t){var e=this.verticesBuffer,i=this.indicesBuffer;return function(){t.deleteBuffer(e),t.deleteBuffer(i)}},e.prototype.setUpProgram=function(t,e,i,n){var r,o=e.getProgram(Si,Ai);return this.defaultLocations_?r=this.defaultLocations_:(r=new function(t,e){this.u_projectionMatrix=t.getUniformLocation(e,ni.g?"u_projectionMatrix":"h"),this.u_offsetScaleMatrix=t.getUniformLocation(e,ni.g?"u_offsetScaleMatrix":"i"),this.u_offsetRotateMatrix=t.getUniformLocation(e,ni.g?"u_offsetRotateMatrix":"j"),this.u_lineWidth=t.getUniformLocation(e,ni.g?"u_lineWidth":"k"),this.u_miterLimit=t.getUniformLocation(e,ni.g?"u_miterLimit":"l"),this.u_opacity=t.getUniformLocation(e,ni.g?"u_opacity":"m"),this.u_color=t.getUniformLocation(e,ni.g?"u_color":"n"),this.u_size=t.getUniformLocation(e,ni.g?"u_size":"o"),this.u_pixelRatio=t.getUniformLocation(e,ni.g?"u_pixelRatio":"p"),this.a_lastPos=t.getAttribLocation(e,ni.g?"a_lastPos":"d"),this.a_position=t.getAttribLocation(e,ni.g?"a_position":"e"),this.a_nextPos=t.getAttribLocation(e,ni.g?"a_nextPos":"f"),this.a_direction=t.getAttribLocation(e,ni.g?"a_direction":"g")}(t,o),this.defaultLocations_=r),e.useProgram(o),t.enableVertexAttribArray(r.a_lastPos),t.vertexAttribPointer(r.a_lastPos,2,ni.l,!1,28,0),t.enableVertexAttribArray(r.a_position),t.vertexAttribPointer(r.a_position,2,ni.l,!1,28,8),t.enableVertexAttribArray(r.a_nextPos),t.vertexAttribPointer(r.a_nextPos,2,ni.l,!1,28,16),t.enableVertexAttribArray(r.a_direction),t.vertexAttribPointer(r.a_direction,1,ni.l,!1,28,24),t.uniform2fv(r.u_size,i),t.uniform1f(r.u_pixelRatio,n),r},e.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_lastPos),t.disableVertexAttribArray(e.a_position),t.disableVertexAttribArray(e.a_nextPos),t.disableVertexAttribArray(e.a_direction)},e.prototype.drawReplay=function(t,e,i,n){var r,o,s,a,c=t.getParameter(t.DEPTH_FUNC),h=t.getParameter(t.DEPTH_WRITEMASK);if(n||(t.enable(t.DEPTH_TEST),t.depthMask(!0),t.depthFunc(t.NOTEQUAL)),Object(lt.d)(i))for(s=this.startIndices[this.startIndices.length-1],r=this.styleIndices_.length-1;r>=0;--r)o=this.styleIndices_[r],a=this.styles_[r],this.setStrokeStyle_(t,a[0],a[1],a[2]),this.drawElements(t,e,o,s),t.clear(t.DEPTH_BUFFER_BIT),s=o;else this.drawReplaySkipping_(t,e,i);n||(t.disable(t.DEPTH_TEST),t.clear(t.DEPTH_BUFFER_BIT),t.depthMask(h),t.depthFunc(c))},e.prototype.drawReplaySkipping_=function(t,e,i){var r,o,s,a,c,h,l,u;for(l=this.startIndices.length-2,s=o=this.startIndices[l+1],r=this.styleIndices_.length-1;r>=0;--r){for(a=this.styles_[r],this.setStrokeStyle_(t,a[0],a[1],a[2]),c=this.styleIndices_[r];l>=0&&this.startIndices[l]>=c;)u=this.startIndices[l],h=this.startIndicesFeature[l],i[Object(n.b)(h).toString()]&&(o!==s&&(this.drawElements(t,e,o,s),t.clear(t.DEPTH_BUFFER_BIT)),s=u),l--,o=u;o!==s&&(this.drawElements(t,e,o,s),t.clear(t.DEPTH_BUFFER_BIT)),o=s=c}},e.prototype.drawHitDetectionReplayOneByOne=function(t,e,i,r,o){var s,a,c,h,l,u,_;for(_=this.startIndices.length-2,c=this.startIndices[_+1],s=this.styleIndices_.length-1;s>=0;--s)for(h=this.styles_[s],this.setStrokeStyle_(t,h[0],h[1],h[2]),l=this.styleIndices_[s];_>=0&&this.startIndices[_]>=l;){if(a=this.startIndices[_],u=this.startIndicesFeature[_],void 0===i[Object(n.b)(u).toString()]&&u.getGeometry()&&(void 0===o||Object(vt.E)(o,u.getGeometry().getExtent()))){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawElements(t,e,a,c);var d=r(u);if(d)return d}_--,c=a}},e.prototype.setStrokeStyle_=function(t,e,i,n){t.uniform4fv(this.defaultLocations_.u_color,e),t.uniform1f(this.defaultLocations_.u_lineWidth,i),t.uniform1f(this.defaultLocations_.u_miterLimit,n)},e.prototype.setFillStrokeStyle=function(t,e){var i=e.getLineCap();this.state_.lineCap=void 0!==i?i:"round";var n=e.getLineDash();this.state_.lineDash=n||di;var r=e.getLineDashOffset();this.state_.lineDashOffset=r||0;var o=e.getLineJoin();this.state_.lineJoin=void 0!==o?o:"round";var s=e.getColor();s=s instanceof CanvasGradient||s instanceof CanvasPattern?pi:Object(ei.a)(s).map(function(t,e){return 3!=e?t/255:t})||pi;var a=e.getWidth();a=void 0!==a?a:1;var c=e.getMiterLimit();c=void 0!==c?c:10,this.state_.strokeColor&&Object(q.a)(this.state_.strokeColor,s)&&this.state_.lineWidth===a&&this.state_.miterLimit===c||(this.state_.changed=!0,this.state_.strokeColor=s,this.state_.lineWidth=a,this.state_.miterLimit=c,this.styles_.push([s,a,c]))},e}(ui),ki=i(34),Fi=new si(ni.g?"precision mediump float;\n\n\n\nuniform vec4 u_color;\nuniform float u_opacity;\n\nvoid main(void) {\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;uniform vec4 e;uniform float f;void main(void){gl_FragColor=e;float alpha=e.a*f;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}"),Ui=new ai(ni.g?"\n\nattribute vec2 a_position;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n}\n\n\n":"attribute vec2 a;uniform mat4 b;uniform mat4 c;uniform mat4 d;void main(void){gl_Position=b*vec4(a,0.0,1.0);}"),Ni=i(46),Bi=function(t){this.first_,this.last_,this.head_,this.circular_=void 0===t||t,this.length_=0};Bi.prototype.insertItem=function(t){var e={prev:void 0,next:void 0,data:t},i=this.head_;if(i){var n=i.next;e.prev=i,e.next=n,i.next=e,n&&(n.prev=e),i===this.last_&&(this.last_=e)}else this.first_=e,this.last_=e,this.circular_&&(e.next=e,e.prev=e);this.head_=e,this.length_++},Bi.prototype.removeItem=function(){var t=this.head_;if(t){var e=t.next,i=t.prev;e&&(e.prev=i),i&&(i.next=e),this.head_=e||i,this.first_===this.last_?(this.head_=void 0,this.first_=void 0,this.last_=void 0):this.first_===t?this.first_=this.head_:this.last_===t&&(this.last_=i?this.head_.prev:this.head_),this.length_--}},Bi.prototype.firstItem=function(){if(this.head_=this.first_,this.head_)return this.head_.data},Bi.prototype.lastItem=function(){if(this.head_=this.last_,this.head_)return this.head_.data},Bi.prototype.nextItem=function(){if(this.head_&&this.head_.next)return this.head_=this.head_.next,this.head_.data},Bi.prototype.getNextItem=function(){if(this.head_&&this.head_.next)return this.head_.next.data},Bi.prototype.prevItem=function(){if(this.head_&&this.head_.prev)return this.head_=this.head_.prev,this.head_.data},Bi.prototype.getPrevItem=function(){if(this.head_&&this.head_.prev)return this.head_.prev.data},Bi.prototype.getCurrItem=function(){if(this.head_)return this.head_.data},Bi.prototype.setFirstItem=function(){this.circular_&&this.head_&&(this.first_=this.head_,this.last_=this.head_.prev)},Bi.prototype.concat=function(t){if(t.head_){if(this.head_){var e=this.head_.next;this.head_.next=t.first_,t.first_.prev=this.head_,e.prev=t.last_,t.last_.next=e,this.length_+=t.length_}else this.head_=t.head_,this.first_=t.first_,this.last_=t.last_,this.length_=t.length_;t.head_=void 0,t.first_=void 0,t.last_=void 0,t.length_=0}},Bi.prototype.getLength=function(){return this.length_};var Wi=Bi,zi=i(47),Gi=function(t){function e(e,i){t.call(this,e,i),this.lineStringReplay=new ji(e,i),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.state_={fillColor:null,changed:!1}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawCoordinates_=function(t,e,i){var n=new Wi,r=new zi.a;this.processFlatCoordinates_(t,i,n,r,!0);var o=this.getMaxCoords_(n);if(e.length){var s,a,c=[];for(s=0,a=e.length;s<a;++s){var h={list:new Wi,maxCoords:void 0,rtree:new zi.a};c.push(h),this.processFlatCoordinates_(e[s],i,h.list,h.rtree,!1),this.classifyPoints_(h.list,h.rtree,!0),h.maxCoords=this.getMaxCoords_(h.list)}for(c.sort(function(t,e){return e.maxCoords[0]===t.maxCoords[0]?t.maxCoords[1]-e.maxCoords[1]:e.maxCoords[0]-t.maxCoords[0]}),s=0;s<c.length;++s){var l=c[s].list,u=l.firstItem(),_=u,d=void 0;do{if(this.getIntersections_(_,r).length){d=!0;break}_=l.nextItem()}while(u!==_);d||this.bridgeHole_(l,c[s].maxCoords[0],n,o[0],r)&&(r.concat(c[s].rtree),this.classifyPoints_(n,r,!1))}}else this.classifyPoints_(n,r,!1);this.triangulate_(n,r)},e.prototype.processFlatCoordinates_=function(t,e,i,n,r){var o,s,a,c,h,l=Object(Ii.a)(t,0,t.length,e),u=this.vertices.length/2,_=[],d=[];if(r===l){for(c=a=this.createPoint_(t[0],t[1],u++),o=e,s=t.length;o<s;o+=e)h=this.createPoint_(t[o],t[o+1],u++),d.push(this.insertItem_(c,h,i)),_.push([Math.min(c.x,h.x),Math.min(c.y,h.y),Math.max(c.x,h.x),Math.max(c.y,h.y)]),c=h;d.push(this.insertItem_(h,a,i)),_.push([Math.min(c.x,h.x),Math.min(c.y,h.y),Math.max(c.x,h.x),Math.max(c.y,h.y)])}else{var p=t.length-e;for(c=a=this.createPoint_(t[p],t[p+1],u++),o=p-e,s=0;o>=s;o-=e)h=this.createPoint_(t[o],t[o+1],u++),d.push(this.insertItem_(c,h,i)),_.push([Math.min(c.x,h.x),Math.min(c.y,h.y),Math.max(c.x,h.x),Math.max(c.y,h.y)]),c=h;d.push(this.insertItem_(h,a,i)),_.push([Math.min(c.x,h.x),Math.min(c.y,h.y),Math.max(c.x,h.x),Math.max(c.y,h.y)])}n.load(_,d)},e.prototype.getMaxCoords_=function(t){var e=t.firstItem(),i=e,n=[i.p0.x,i.p0.y];do{(i=t.nextItem()).p0.x>n[0]&&(n=[i.p0.x,i.p0.y])}while(i!==e);return n},e.prototype.classifyPoints_=function(t,e,i){var n=t.firstItem(),r=n,o=t.nextItem(),s=!1;do{var a=i?gi(o.p1.x,o.p1.y,r.p1.x,r.p1.y,r.p0.x,r.p0.y):gi(r.p0.x,r.p0.y,r.p1.x,r.p1.y,o.p1.x,o.p1.y);void 0===a?(this.removeItem_(r,o,t,e),s=!0,o===n&&(n=t.getNextItem()),o=r,t.prevItem()):r.p1.reflex!==a&&(r.p1.reflex=a,s=!0),r=o,o=t.nextItem()}while(r!==n);return s},e.prototype.bridgeHole_=function(t,e,i,n,r){for(var o=t.firstItem();o.p1.x!==e;)o=t.nextItem();var s,a,c,h,l=o.p1,u={x:n,y:l.y,i:-1},_=1/0,d=this.getIntersections_({p0:l,p1:u},r,!0);for(s=0,a=d.length;s<a;++s){var p=d[s],f=this.calculateIntersection_(l,u,p.p0,p.p1,!0),g=Math.abs(l.x-f[0]);g<_&&void 0!==gi(l.x,l.y,p.p0.x,p.p0.y,p.p1.x,p.p1.y)&&(_=g,h={x:f[0],y:f[1],i:-1},o=p)}if(_===1/0)return!1;if(c=o.p1,_>0){var v=this.getPointsInTriangle_(l,h,o.p1,r);if(v.length){var m=1/0;for(s=0,a=v.length;s<a;++s){var y=v[s],b=Math.atan2(l.y-y.y,u.x-y.x);(b<m||b===m&&y.x<c.x)&&(m=b,c=y)}}}for(o=i.firstItem();o.p1.x!==c.x||o.p1.y!==c.y;)o=i.nextItem();var E={x:l.x,y:l.y,i:l.i,reflex:void 0},x={x:o.p1.x,y:o.p1.y,i:o.p1.i,reflex:void 0};return t.getNextItem().p0=E,this.insertItem_(l,o.p1,t,r),this.insertItem_(x,E,t,r),o.p1=x,t.setFirstItem(),i.concat(t),!0},e.prototype.triangulate_=function(t,e){for(var i=!1,n=this.isSimple_(t,e);t.getLength()>3;)if(n){if(!this.clipEars_(t,e,n,i)&&!this.classifyPoints_(t,e,i)&&!this.resolveSelfIntersections_(t,e,!0))break}else if(!this.clipEars_(t,e,n,i)&&!this.classifyPoints_(t,e,i)&&!this.resolveSelfIntersections_(t,e)){if(!(n=this.isSimple_(t,e))){this.splitPolygon_(t,e);break}i=!this.isClockwise_(t),this.classifyPoints_(t,e,i)}if(3===t.getLength()){var r=this.indices.length;this.indices[r++]=t.getPrevItem().p0.i,this.indices[r++]=t.getCurrItem().p0.i,this.indices[r++]=t.getNextItem().p0.i}},e.prototype.clipEars_=function(t,e,i,n){var r,o,s,a=this.indices.length,c=t.firstItem(),h=t.getPrevItem(),l=c,u=t.nextItem(),_=t.getNextItem(),d=!1;do{if(r=l.p0,o=l.p1,s=u.p1,!1===o.reflex){var p=void 0;p=i?0===this.getPointsInTriangle_(r,o,s,e,!0).length:n?this.diagonalIsInside_(_.p1,s,o,r,h.p0):this.diagonalIsInside_(h.p0,r,o,s,_.p1),(i||0===this.getIntersections_({p0:r,p1:s},e).length)&&p&&(i||!1===r.reflex||!1===s.reflex||Object(Ii.a)([h.p0.x,h.p0.y,r.x,r.y,o.x,o.y,s.x,s.y,_.p1.x,_.p1.y],0,10,2)===!n)&&(this.indices[a++]=r.i,this.indices[a++]=o.i,this.indices[a++]=s.i,this.removeItem_(l,u,t,e),u===c&&(c=_),d=!0)}h=t.getPrevItem(),l=t.getCurrItem(),u=t.nextItem(),_=t.getNextItem()}while(l!==c&&t.getLength()>3);return d},e.prototype.resolveSelfIntersections_=function(t,e,i){var n=t.firstItem();t.nextItem();var r=n,o=t.nextItem(),s=!1;do{var a=this.calculateIntersection_(r.p0,r.p1,o.p0,o.p1,i);if(a){var c=!1,h=this.vertices.length,l=this.indices.length,u=h/2,_=t.prevItem();t.removeItem(),e.remove(_),c=_===n;var d=void 0;if(i?(a[0]===r.p0.x&&a[1]===r.p0.y?(t.prevItem(),d=r.p0,o.p0=d,e.remove(r),c=c||r===n):(d=o.p1,r.p1=d,e.remove(o),c=c||o===n),t.removeItem()):(d=this.createPoint_(a[0],a[1],u),r.p1=d,o.p0=d,e.update([Math.min(r.p0.x,r.p1.x),Math.min(r.p0.y,r.p1.y),Math.max(r.p0.x,r.p1.x),Math.max(r.p0.y,r.p1.y)],r),e.update([Math.min(o.p0.x,o.p1.x),Math.min(o.p0.y,o.p1.y),Math.max(o.p0.x,o.p1.x),Math.max(o.p0.y,o.p1.y)],o)),this.indices[l++]=_.p0.i,this.indices[l++]=_.p1.i,this.indices[l++]=d.i,s=!0,c)break}r=t.getPrevItem(),o=t.nextItem()}while(r!==n);return s},e.prototype.isSimple_=function(t,e){var i=t.firstItem(),n=i;do{if(this.getIntersections_(n,e).length)return!1;n=t.nextItem()}while(n!==i);return!0},e.prototype.isClockwise_=function(t){var e=2*t.getLength(),i=new Array(e),n=t.firstItem(),r=n,o=0;do{i[o++]=r.p0.x,i[o++]=r.p0.y,r=t.nextItem()}while(r!==n);return Object(Ii.a)(i,0,e,2)},e.prototype.splitPolygon_=function(t,e){var i=t.firstItem(),n=i;do{var r=this.getIntersections_(n,e);if(r.length){var o=r[0],s=this.vertices.length/2,a=this.calculateIntersection_(n.p0,n.p1,o.p0,o.p1),c=this.createPoint_(a[0],a[1],s),h=new Wi,l=new zi.a;this.insertItem_(c,n.p1,h,l),n.p1=c,e.update([Math.min(n.p0.x,c.x),Math.min(n.p0.y,c.y),Math.max(n.p0.x,c.x),Math.max(n.p0.y,c.y)],n);for(var u=t.nextItem();u!==o;)this.insertItem_(u.p0,u.p1,h,l),e.remove(u),t.removeItem(),u=t.getCurrItem();this.insertItem_(o.p0,c,h,l),o.p0=c,e.update([Math.min(o.p1.x,c.x),Math.min(o.p1.y,c.y),Math.max(o.p1.x,c.x),Math.max(o.p1.y,c.y)],o),this.classifyPoints_(t,e,!1),this.triangulate_(t,e),this.classifyPoints_(h,l,!1),this.triangulate_(h,l);break}n=t.nextItem()}while(n!==i)},e.prototype.createPoint_=function(t,e,i){var n=this.vertices.length;return this.vertices[n++]=t,this.vertices[n++]=e,{x:t,y:e,i:i,reflex:void 0}},e.prototype.insertItem_=function(t,e,i,n){var r={p0:t,p1:e};return i.insertItem(r),n&&n.insert([Math.min(t.x,e.x),Math.min(t.y,e.y),Math.max(t.x,e.x),Math.max(t.y,e.y)],r),r},e.prototype.removeItem_=function(t,e,i,n){i.getCurrItem()===e&&(i.removeItem(),t.p1=e.p1,n.remove(e),n.update([Math.min(t.p0.x,t.p1.x),Math.min(t.p0.y,t.p1.y),Math.max(t.p0.x,t.p1.x),Math.max(t.p0.y,t.p1.y)],t))},e.prototype.getPointsInTriangle_=function(t,e,i,n,r){for(var o=[],s=n.getInExtent([Math.min(t.x,e.x,i.x),Math.min(t.y,e.y,i.y),Math.max(t.x,e.x,i.x),Math.max(t.y,e.y,i.y)]),a=0,c=s.length;a<c;++a)for(var h in s[a]){var l=s[a][h];"object"!=typeof l||r&&!l.reflex||l.x===t.x&&l.y===t.y||l.x===e.x&&l.y===e.y||l.x===i.x&&l.y===i.y||-1!==o.indexOf(l)||!Object(ki.b)([t.x,t.y,e.x,e.y,i.x,i.y],0,6,2,l.x,l.y)||o.push(l)}return o},e.prototype.getIntersections_=function(t,e,i){for(var n=t.p0,r=t.p1,o=e.getInExtent([Math.min(n.x,r.x),Math.min(n.y,r.y),Math.max(n.x,r.x),Math.max(n.y,r.y)]),s=[],a=0,c=o.length;a<c;++a){var h=o[a];t!==h&&(i||h.p0!==r||h.p1!==n)&&this.calculateIntersection_(n,r,h.p0,h.p1,i)&&s.push(h)}return s},e.prototype.calculateIntersection_=function(t,e,i,n,r){var o=(n.y-i.y)*(e.x-t.x)-(n.x-i.x)*(e.y-t.y);if(0!==o){var s=((n.x-i.x)*(t.y-i.y)-(n.y-i.y)*(t.x-i.x))/o,a=((e.x-t.x)*(t.y-i.y)-(e.y-t.y)*(t.x-i.x))/o;if(!r&&s>fi&&s<1-fi&&a>fi&&a<1-fi||r&&s>=0&&s<=1&&a>=0&&a<=1)return[t.x+s*(e.x-t.x),t.y+s*(e.y-t.y)]}},e.prototype.diagonalIsInside_=function(t,e,i,n,r){if(void 0===e.reflex||void 0===n.reflex)return!1;var o=(i.x-n.x)*(e.y-n.y)>(i.y-n.y)*(e.x-n.x),s=(r.x-n.x)*(e.y-n.y)<(r.y-n.y)*(e.x-n.x),a=(t.x-e.x)*(n.y-e.y)>(t.y-e.y)*(n.x-e.x),c=(i.x-e.x)*(n.y-e.y)<(i.y-e.y)*(n.x-e.x),h=n.reflex?s||o:s&&o,l=e.reflex?c||a:c&&a;return h&&l},e.prototype.drawMultiPolygon=function(t,e){var i,n,r,o,s=t.getEndss(),a=t.getStride(),c=this.indices.length,h=this.lineStringReplay.getCurrentIndex(),l=t.getFlatCoordinates(),u=0;for(i=0,n=s.length;i<n;++i){var _=s[i];if(_.length>0){var d=Object(ii.d)(l,u,_[0],a,-this.origin[0],-this.origin[1]);if(d.length){var p=[],f=void 0;for(r=1,o=_.length;r<o;++r)_[r]!==_[r-1]&&(f=Object(ii.d)(l,_[r-1],_[r],a,-this.origin[0],-this.origin[1]),p.push(f));this.lineStringReplay.drawPolygonCoordinates(d,p,a),this.drawCoordinates_(d,p,a)}}u=_[_.length-1]}this.indices.length>c&&(this.startIndices.push(c),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(c),this.state_.changed=!1)),this.lineStringReplay.getCurrentIndex()>h&&this.lineStringReplay.setPolygonStyle(e,h)},e.prototype.drawPolygon=function(t,e){var i=t.getEnds(),n=t.getStride();if(i.length>0){var r=t.getFlatCoordinates().map(Number),o=Object(ii.d)(r,0,i[0],n,-this.origin[0],-this.origin[1]);if(o.length){var s,a,c,h=[];for(s=1,a=i.length;s<a;++s)i[s]!==i[s-1]&&(c=Object(ii.d)(r,i[s-1],i[s],n,-this.origin[0],-this.origin[1]),h.push(c));this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.lineStringReplay.setPolygonStyle(e),this.lineStringReplay.drawPolygonCoordinates(o,h,n),this.drawCoordinates_(o,h,n)}}},e.prototype.finish=function(t){this.verticesBuffer=new yi(this.vertices),this.indicesBuffer=new yi(this.indices),this.startIndices.push(this.indices.length),this.lineStringReplay.finish(t),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},e.prototype.getDeleteResourcesFunction=function(t){var e=this.verticesBuffer,i=this.indicesBuffer,n=this.lineStringReplay.getDeleteResourcesFunction(t);return function(){t.deleteBuffer(e),t.deleteBuffer(i),n()}},e.prototype.setUpProgram=function(t,e,i,n){var r,o=e.getProgram(Fi,Ui);return this.defaultLocations_?r=this.defaultLocations_:(r=new function(t,e){this.u_projectionMatrix=t.getUniformLocation(e,ni.g?"u_projectionMatrix":"b"),this.u_offsetScaleMatrix=t.getUniformLocation(e,ni.g?"u_offsetScaleMatrix":"c"),this.u_offsetRotateMatrix=t.getUniformLocation(e,ni.g?"u_offsetRotateMatrix":"d"),this.u_color=t.getUniformLocation(e,ni.g?"u_color":"e"),this.u_opacity=t.getUniformLocation(e,ni.g?"u_opacity":"f"),this.a_position=t.getAttribLocation(e,ni.g?"a_position":"a")}(t,o),this.defaultLocations_=r),e.useProgram(o),t.enableVertexAttribArray(r.a_position),t.vertexAttribPointer(r.a_position,2,ni.l,!1,8,0),r},e.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_position)},e.prototype.drawReplay=function(t,e,i,n){var r,o,s,a,c=t.getParameter(t.DEPTH_FUNC),h=t.getParameter(t.DEPTH_WRITEMASK);if(n||(t.enable(t.DEPTH_TEST),t.depthMask(!0),t.depthFunc(t.NOTEQUAL)),Object(lt.d)(i))for(s=this.startIndices[this.startIndices.length-1],r=this.styleIndices_.length-1;r>=0;--r)o=this.styleIndices_[r],a=this.styles_[r],this.setFillStyle_(t,a),this.drawElements(t,e,o,s),s=o;else this.drawReplaySkipping_(t,e,i);n||(t.disable(t.DEPTH_TEST),t.clear(t.DEPTH_BUFFER_BIT),t.depthMask(h),t.depthFunc(c))},e.prototype.drawHitDetectionReplayOneByOne=function(t,e,i,r,o){var s,a,c,h,l,u,_;for(_=this.startIndices.length-2,c=this.startIndices[_+1],s=this.styleIndices_.length-1;s>=0;--s)for(h=this.styles_[s],this.setFillStyle_(t,h),l=this.styleIndices_[s];_>=0&&this.startIndices[_]>=l;){if(a=this.startIndices[_],u=this.startIndicesFeature[_],void 0===i[Object(n.b)(u).toString()]&&u.getGeometry()&&(void 0===o||Object(vt.E)(o,u.getGeometry().getExtent()))){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawElements(t,e,a,c);var d=r(u);if(d)return d}_--,c=a}},e.prototype.drawReplaySkipping_=function(t,e,i){var r,o,s,a,c,h,l,u;for(l=this.startIndices.length-2,s=o=this.startIndices[l+1],r=this.styleIndices_.length-1;r>=0;--r){for(a=this.styles_[r],this.setFillStyle_(t,a),c=this.styleIndices_[r];l>=0&&this.startIndices[l]>=c;)u=this.startIndices[l],h=this.startIndicesFeature[l],i[Object(n.b)(h).toString()]&&(o!==s&&(this.drawElements(t,e,o,s),t.clear(t.DEPTH_BUFFER_BIT)),s=u),l--,o=u;o!==s&&(this.drawElements(t,e,o,s),t.clear(t.DEPTH_BUFFER_BIT)),o=s=c}},e.prototype.setFillStyle_=function(t,e){t.uniform4fv(this.defaultLocations_.u_color,e)},e.prototype.setFillStrokeStyle=function(t,e){var i=t?t.getColor():[0,0,0,0];if(i=i instanceof CanvasGradient||i instanceof CanvasPattern?_i:Object(ei.a)(i).map(function(t,e){return 3!=e?t/255:t})||_i,this.state_.fillColor&&Object(q.a)(i,this.state_.fillColor)||(this.state_.fillColor=i,this.state_.changed=!0,this.styles_.push(i)),e)this.lineStringReplay.setFillStrokeStyle(null,e);else{var n=new Ni.a({color:[0,0,0,0],lineWidth:0});this.lineStringReplay.setFillStrokeStyle(null,n)}},e}(ui),Ki=i(53),Hi=function(t,e){this.space_=e,this.emptyBlocks_=[{x:0,y:0,width:t,height:t}],this.entries_={},this.context_=Object(gt.a)(t,t),this.canvas_=this.context_.canvas};Hi.prototype.get=function(t){return this.entries_[t]||null},Hi.prototype.add=function(t,e,i,n,r){for(var o=0,s=this.emptyBlocks_.length;o<s;++o){var a=this.emptyBlocks_[o];if(a.width>=e+this.space_&&a.height>=i+this.space_){var c={offsetX:a.x+this.space_,offsetY:a.y+this.space_,image:this.canvas_};return this.entries_[t]=c,n.call(r,this.context_,a.x+this.space_,a.y+this.space_),this.split_(o,a,e+this.space_,i+this.space_),c}}return null},Hi.prototype.split_=function(t,e,i,n){var r,o;e.width-i>e.height-n?(r={x:e.x+i,y:e.y,width:e.width-i,height:e.height},o={x:e.x,y:e.y+n,width:i,height:e.height-n},this.updateBlocks_(t,r,o)):(r={x:e.x+i,y:e.y,width:e.width-i,height:n},o={x:e.x,y:e.y+n,width:e.width,height:e.height-n},this.updateBlocks_(t,r,o))},Hi.prototype.updateBlocks_=function(t,e,i){var n=[t,1];e.width>0&&e.height>0&&n.push(e),i.width>0&&i.height>0&&n.push(i),this.emptyBlocks_.splice.apply(this.emptyBlocks_,n)};var Yi=Hi,Vi=function(t){var e=t||{};this.currentSize_=void 0!==e.initialSize?e.initialSize:256,this.maxSize_=void 0!==e.maxSize?e.maxSize:void 0!==ni.p?ni.p:2048,this.space_=void 0!==e.space?e.space:1,this.atlases_=[new Yi(this.currentSize_,this.space_)],this.currentHitSize_=this.currentSize_,this.hitAtlases_=[new Yi(this.currentHitSize_,this.space_)]};Vi.prototype.getInfo=function(t){var e=this.getInfo_(this.atlases_,t);if(!e)return null;var i=this.getInfo_(this.hitAtlases_,t);return this.mergeInfos_(e,i)},Vi.prototype.getInfo_=function(t,e){for(var i=0,n=t.length;i<n;++i){var r=t[i].get(e);if(r)return r}return null},Vi.prototype.mergeInfos_=function(t,e){return{offsetX:t.offsetX,offsetY:t.offsetY,image:t.image,hitImage:e.image}},Vi.prototype.add=function(t,e,i,n,r,o){if(e+this.space_>this.maxSize_||i+this.space_>this.maxSize_)return null;var s=this.add_(!1,t,e,i,n,o);if(!s)return null;var a=void 0!==r?r:mt.c,c=this.add_(!0,t,e,i,a,o);return this.mergeInfos_(s,c)},Vi.prototype.add_=function(t,e,i,n,r,o){var s,a,c,h,l=t?this.hitAtlases_:this.atlases_;for(c=0,h=l.length;c<h;++c){if(a=(s=l[c]).add(e,i,n,r,o))return a;if(!a&&c===h-1){var u=void 0;t?(u=Math.min(2*this.currentHitSize_,this.maxSize_),this.currentHitSize_=u):(u=Math.min(2*this.currentSize_,this.maxSize_),this.currentSize_=u),s=new Yi(u,this.space_),l.push(s),++h}}return null};var Xi=Vi,qi=function(t){function e(e,i){t.call(this,e,i),this.images_=[],this.textures_=[],this.measureCanvas_=Object(gt.a)(0,0).canvas,this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:0,miterLimit:void 0,fillColor:null,font:void 0,scale:void 0},this.text_="",this.textAlign_=void 0,this.textBaseline_=void 0,this.offsetX_=void 0,this.offsetY_=void 0,this.atlases_={},this.currAtlas_=void 0,this.scale=1,this.opacity=1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawText=function(t,e){if(this.text_){var i=null,r=2,o=2;switch(t.getType()){case Ve.a.POINT:case Ve.a.MULTI_POINT:r=(i=t.getFlatCoordinates()).length,o=t.getStride();break;case Ve.a.CIRCLE:i=t.getCenter();break;case Ve.a.LINE_STRING:i=t.getFlatMidpoint();break;case Ve.a.MULTI_LINE_STRING:r=(i=t.getFlatMidpoints()).length;break;case Ve.a.POLYGON:i=t.getFlatInteriorPoint();break;case Ve.a.MULTI_POLYGON:r=(i=t.getFlatInteriorPoints()).length}this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e);var s,a,c,h,l,u,_,d,p=this.currAtlas_,f=this.text_.split("\n"),g=this.getTextSize_(f),v=Math.round(g[0]*this.textAlign_-this.offsetX_),m=Math.round(g[1]*this.textBaseline_-this.offsetY_),y=this.state_.lineWidth/2*this.state_.scale;for(s=0,a=f.length;s<a;++s)for(l=0,u=p.height*s,c=0,h=(_=f[s].split("")).length;c<h;++c){if(d=p.atlas.getInfo(_[c])){var b=d.image;if(this.anchorX=v-l,this.anchorY=m-u,this.originX=0===c?d.offsetX-y:d.offsetX,this.originY=d.offsetY,this.height=p.height,this.width=0===c||c===_.length-1?p.width[_[c]]+y:p.width[_[c]],this.imageHeight=b.height,this.imageWidth=b.width,0===this.images_.length)this.images_.push(b);else{var E=this.images_[this.images_.length-1];Object(n.b)(E)!=Object(n.b)(b)&&(this.groupIndices.push(this.indices.length),this.images_.push(b))}this.drawText_(i,0,r,o)}l+=this.width}}},e.prototype.getTextSize_=function(t){var e=this,i=this.currAtlas_,n=t.length*i.height;return[t.map(function(t){for(var n=0,r=0,o=t.length;r<o;++r){var s=t[r];i.width[s]||e.addCharToAtlas_(s),n+=i.width[s]?i.width[s]:0}return n}).reduce(function(t,e){return Math.max(t,e)}),n]},e.prototype.drawText_=function(t,e,i,n){for(var r=e,o=i;r<o;r+=n)this.drawCoordinates(t,e,i,n)},e.prototype.addCharToAtlas_=function(t){if(1===t.length){var e=this.currAtlas_,i=this.state_,n=this.measureCanvas_.getContext("2d");n.font=i.font;var r=Math.ceil(n.measureText(t).width*i.scale);e.atlas.add(t,r,e.height,function(e,n,r){e.font=i.font,e.fillStyle=i.fillColor,e.strokeStyle=i.strokeColor,e.lineWidth=i.lineWidth,e.lineCap=i.lineCap,e.lineJoin=i.lineJoin,e.miterLimit=i.miterLimit,e.textAlign="left",e.textBaseline="top",h.a&&i.lineDash&&(e.setLineDash(i.lineDash),e.lineDashOffset=i.lineDashOffset),1!==i.scale&&e.setTransform(i.scale,0,0,i.scale,0,0),i.strokeColor&&e.strokeText(t,n,r),i.fillColor&&e.fillText(t,n,r)})&&(e.width[t]=r)}},e.prototype.finish=function(e){var i=e.getGL();this.groupIndices.push(this.indices.length),this.hitDetectionGroupIndices=this.groupIndices,this.verticesBuffer=new yi(this.vertices),this.indicesBuffer=new yi(this.indices),this.createTextures(this.textures_,this.images_,{},i),this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:0,miterLimit:void 0,fillColor:null,font:void 0,scale:void 0},this.text_="",this.textAlign_=void 0,this.textBaseline_=void 0,this.offsetX_=void 0,this.offsetY_=void 0,this.images_=null,this.atlases_={},this.currAtlas_=void 0,t.prototype.finish.call(this,e)},e.prototype.setTextStyle=function(t){var e=this.state_,i=t.getFill(),n=t.getStroke();if(t&&t.getText()&&(i||n)){if(i){var r=i.getColor();e.fillColor=Object(Ki.a)(r||_i)}else e.fillColor=null;if(n){var o=n.getColor();e.strokeColor=Object(Ki.a)(o||pi),e.lineWidth=n.getWidth()||1,e.lineCap=n.getLineCap()||"round",e.lineDashOffset=n.getLineDashOffset()||0,e.lineJoin=n.getLineJoin()||"round",e.miterLimit=n.getMiterLimit()||10;var s=n.getLineDash();e.lineDash=s?s.slice():di}else e.strokeColor=null,e.lineWidth=0;e.font=t.getFont()||"10px sans-serif",e.scale=t.getScale()||1,this.text_=t.getText();var a=Je[t.getTextAlign()],c=Je[t.getTextBaseline()];this.textAlign_=void 0===a?.5:a,this.textBaseline_=void 0===c?.5:c,this.offsetX_=t.getOffsetX()||0,this.offsetY_=t.getOffsetY()||0,this.rotateWithView=!!t.getRotateWithView(),this.rotation=t.getRotation()||0,this.currAtlas_=this.getAtlas_(e)}else this.text_=""},e.prototype.getAtlas_=function(t){var e=[];for(var i in t)(t[i]||0===t[i])&&(Array.isArray(t[i])?e=e.concat(t[i]):e.push(t[i]));var n=this.calculateHash_(e);if(!this.atlases_[n]){var r=this.measureCanvas_.getContext("2d");r.font=t.font;var o=Math.ceil((1.5*r.measureText("M").width+t.lineWidth/2)*t.scale);this.atlases_[n]={atlas:new Xi({space:t.lineWidth+1}),width:{},height:o}}return this.atlases_[n]},e.prototype.calculateHash_=function(t){for(var e="",i=0,n=t.length;i<n;++i)e+=t[i];return e},e.prototype.getTextures=function(t){return this.textures_},e.prototype.getHitDetectionTextures=function(){return this.textures_},e}(Mi),Zi=[1,1],$i={Circle:bi,Image:Pi,LineString:ji,Polygon:Gi,Text:qi},Ji=function(t){function e(e,i,n){t.call(this),this.maxExtent_=i,this.tolerance_=e,this.renderBuffer_=n,this.replaysByZIndex_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addDeclutter=function(t,e){},e.prototype.getDeleteResourcesFunction=function(t){var e,i=[];for(e in this.replaysByZIndex_){var n=this.replaysByZIndex_[e];for(var r in n)i.push(n[r].getDeleteResourcesFunction(t))}return function(){for(var t,e=arguments,n=i.length,r=0;r<n;r++)t=i[r].apply(this,e);return t}},e.prototype.finish=function(t){var e;for(e in this.replaysByZIndex_){var i=this.replaysByZIndex_[e];for(var n in i)i[n].finish(t)}},e.prototype.getReplay=function(t,e){var i=void 0!==t?t.toString():"0",n=this.replaysByZIndex_[i];void 0===n&&(n={},this.replaysByZIndex_[i]=n);var r=n[e];return void 0===r&&(r=new(0,$i[e])(this.tolerance_,this.maxExtent_),n[e]=r),r},e.prototype.isEmpty=function(){return Object(lt.d)(this.replaysByZIndex_)},e.prototype.replay=function(t,e,i,n,r,o,s,a){var c,h,l,u,_,d,p=Object.keys(this.replaysByZIndex_).map(Number);for(p.sort(q.f),c=0,h=p.length;c<h;++c)for(_=this.replaysByZIndex_[p[c].toString()],l=0,u=$e.length;l<u;++l)void 0!==(d=_[$e[l]])&&d.replay(t,e,i,n,r,o,s,a,void 0,!1)},e.prototype.replayHitDetection_=function(t,e,i,n,r,o,s,a,c,h,l){var u,_,d,p,f,g,v=Object.keys(this.replaysByZIndex_).map(Number);for(v.sort(function(t,e){return e-t}),u=0,_=v.length;u<_;++u)for(p=this.replaysByZIndex_[v[u].toString()],d=$e.length-1;d>=0;--d)if(void 0!==(f=p[$e[d]])&&(g=f.replay(t,e,i,n,r,o,s,a,c,h,l)))return g},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r,o,s,a,c,h){var l,u=e.getGL();return u.bindFramebuffer(u.FRAMEBUFFER,e.getHitDetectionFramebuffer()),void 0!==this.renderBuffer_&&(l=Object(vt.c)(Object(vt.l)(t),n*this.renderBuffer_)),this.replayHitDetection_(e,t,n,r,Zi,s,a,c,function(t){var e=new Uint8Array(4);if(u.readPixels(0,0,1,1,u.RGBA,u.UNSIGNED_BYTE,e),e[3]>0){var i=h(t);if(i)return i}},!0,l)},e.prototype.hasFeatureAtCoordinate=function(t,e,i,n,r,o,s,a,c){var h=e.getGL();return h.bindFramebuffer(h.FRAMEBUFFER,e.getHitDetectionFramebuffer()),void 0!==this.replayHitDetection_(e,t,n,r,Zi,s,a,c,function(t){var e=new Uint8Array(4);return h.readPixels(0,0,1,1,h.RGBA,h.UNSIGNED_BYTE,e),e[3]>0},!1)},e}(ti),Qi=function(t){function e(e,i,n,r,o,s,a){t.call(this),this.context_=e,this.center_=i,this.extent_=s,this.pixelRatio_=a,this.size_=o,this.rotation_=r,this.resolution_=n,this.imageStyle_=null,this.fillStyle_=null,this.strokeStyle_=null,this.textStyle_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawText_=function(t,e){var i=this.context_,n=t.getReplay(0,Xe.TEXT);n.setTextStyle(this.textStyle_),n.drawText(e,null),n.finish(i),n.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),n.getDeleteResourcesFunction(i)()},e.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},e.prototype.drawGeometry=function(t){switch(t.getType()){case Ve.a.POINT:this.drawPoint(t,null);break;case Ve.a.LINE_STRING:this.drawLineString(t,null);break;case Ve.a.POLYGON:this.drawPolygon(t,null);break;case Ve.a.MULTI_POINT:this.drawMultiPoint(t,null);break;case Ve.a.MULTI_LINE_STRING:this.drawMultiLineString(t,null);break;case Ve.a.MULTI_POLYGON:this.drawMultiPolygon(t,null);break;case Ve.a.GEOMETRY_COLLECTION:this.drawGeometryCollection(t,null);break;case Ve.a.CIRCLE:this.drawCircle(t,null)}},e.prototype.drawFeature=function(t,e){var i=e.getGeometryFunction()(t);i&&Object(vt.E)(this.extent_,i.getExtent())&&(this.setStyle(e),this.drawGeometry(i))},e.prototype.drawGeometryCollection=function(t,e){var i,n,r=t.getGeometriesArray();for(i=0,n=r.length;i<n;++i)this.drawGeometry(r[i])},e.prototype.drawPoint=function(t,e){var i=this.context_,n=new Ji(1,this.extent_),r=n.getReplay(0,Xe.IMAGE);r.setImageStyle(this.imageStyle_),r.drawPoint(t,e),r.finish(i),r.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),r.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(n,t)},e.prototype.drawMultiPoint=function(t,e){var i=this.context_,n=new Ji(1,this.extent_),r=n.getReplay(0,Xe.IMAGE);r.setImageStyle(this.imageStyle_),r.drawMultiPoint(t,e),r.finish(i),r.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),r.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(n,t)},e.prototype.drawLineString=function(t,e){var i=this.context_,n=new Ji(1,this.extent_),r=n.getReplay(0,Xe.LINE_STRING);r.setFillStrokeStyle(null,this.strokeStyle_),r.drawLineString(t,e),r.finish(i),r.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),r.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(n,t)},e.prototype.drawMultiLineString=function(t,e){var i=this.context_,n=new Ji(1,this.extent_),r=n.getReplay(0,Xe.LINE_STRING);r.setFillStrokeStyle(null,this.strokeStyle_),r.drawMultiLineString(t,e),r.finish(i),r.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),r.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(n,t)},e.prototype.drawPolygon=function(t,e){var i=this.context_,n=new Ji(1,this.extent_),r=n.getReplay(0,Xe.POLYGON);r.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),r.drawPolygon(t,e),r.finish(i),r.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),r.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(n,t)},e.prototype.drawMultiPolygon=function(t,e){var i=this.context_,n=new Ji(1,this.extent_),r=n.getReplay(0,Xe.POLYGON);r.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),r.drawMultiPolygon(t,e),r.finish(i),r.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),r.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(n,t)},e.prototype.drawCircle=function(t,e){var i=this.context_,n=new Ji(1,this.extent_),r=n.getReplay(0,Xe.CIRCLE);r.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),r.drawCircle(t,e),r.finish(i),r.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),r.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(n,t)},e.prototype.setImageStyle=function(t){this.imageStyle_=t},e.prototype.setFillStrokeStyle=function(t,e){this.fillStyle_=t,this.strokeStyle_=e},e.prototype.setTextStyle=function(t){this.textStyle_=t},e}(Ze),tn=i(19),en=function(t){function e(e){t.call(this),this.layer_=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createLoadedTileFinder=function(t,e,i){return function(n,r){return t.forEachLoadedTile(e,n,r,function(t){i[n]||(i[n]={}),i[n][t.tileCoord.toString()]=t})}},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleImageChange_=function(t){t.target.getState()===tn.a.LOADED&&this.renderIfReadyAndVisible()},e.prototype.loadImage=function(t){var e=t.getState();return e!=tn.a.LOADED&&e!=tn.a.ERROR&&Object(d.a)(t,l.a.CHANGE,this.handleImageChange_,this),e==tn.a.IDLE&&(t.load(),e=t.getState()),e==tn.a.LOADED},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==bt.a.READY&&this.changed()},e.prototype.scheduleExpireCache=function(t,e){if(e.canExpireCache()){var i=function(t,e,i){var r=Object(n.b)(t).toString();r in i.usedTiles&&t.expireCache(i.viewState.projection,i.usedTiles[r])}.bind(null,e);t.postRenderFunctions.push(i)}},e.prototype.updateUsedTiles=function(t,e,i,r){var o=Object(n.b)(e).toString(),s=i.toString();o in t?s in t[o]?t[o][s].extend(r):t[o][s]=r:(t[o]={},t[o][s]=r)},e.prototype.manageTilePyramid=function(t,e,i,r,o,s,a,c,h,l){var u=Object(n.b)(e).toString();u in t.wantedTiles||(t.wantedTiles[u]={});var _,d,p,f,g,v,m=t.wantedTiles[u],y=t.tileQueue;for(v=i.getMinZoom();v<=a;++v)for(d=i.getTileRangeForExtentAndZ(s,v,d),p=i.getResolution(v),f=d.minX;f<=d.maxX;++f)for(g=d.minY;g<=d.maxY;++g)a-v<=c?((_=e.getTile(v,f,g,r,o)).getState()==ct.a.IDLE&&(m[_.getKey()]=!0,y.isKeyQueued(_.getKey())||y.enqueue([_,u,i.getTileCoordCenter(_.tileCoord),p])),void 0!==h&&h.call(l,_)):e.useTile(v,f,g,o)},e}(i(57).a);en.prototype.forEachFeatureAtCoordinate=mt.c,en.prototype.hasFeatureAtCoordinate=mt.a;var nn=en,rn=new si(ni.g?"precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform float u_opacity;\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_texture, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  gl_FragColor.a = texColor.a * u_opacity;\n}\n":"precision mediump float;varying vec2 a;uniform float f;uniform sampler2D g;void main(void){vec4 texColor=texture2D(g,a);gl_FragColor.rgb=texColor.rgb;gl_FragColor.a=texColor.a*f;}"),on=new ai(ni.g?"varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nuniform mat4 u_texCoordMatrix;\nuniform mat4 u_projectionMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0., 1.);\n  v_texCoord = (u_texCoordMatrix * vec4(a_texCoord, 0., 1.)).st;\n}\n\n\n":"varying vec2 a;attribute vec2 b;attribute vec2 c;uniform mat4 d;uniform mat4 e;void main(void){gl_Position=e*vec4(b,0.,1.);a=(d*vec4(c,0.,1.)).st;}"),sn=function(t){function e(e,i){t.call(this,i),this.mapRenderer=e,this.arrayBuffer_=new yi([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]),this.texture=null,this.framebuffer=null,this.framebufferDimension=void 0,this.texCoordMatrix=Object(Ct.c)(),this.projectionMatrix=Object(Ct.c)(),this.tmpMat4_=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.defaultLocations_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bindFramebuffer=function(t,e){var i=this.mapRenderer.getGL();if(void 0===this.framebufferDimension||this.framebufferDimension!=e){var n=function(t,e,i){t.isContextLost()||(t.deleteFramebuffer(e),t.deleteTexture(i))}.bind(null,i,this.framebuffer,this.texture);t.postRenderFunctions.push(n);var r=Ti(i,e,e),o=i.createFramebuffer();i.bindFramebuffer(ni.n,o),i.framebufferTexture2D(ni.n,ni.d,ni.z,r,0),this.texture=r,this.framebuffer=o,this.framebufferDimension=e}else i.bindFramebuffer(ni.n,this.framebuffer)},e.prototype.composeFrame=function(t,e,i){this.dispatchComposeEvent_(Ye.a.PRECOMPOSE,i,t),i.bindBuffer(ni.a,this.arrayBuffer_);var n,r=i.getGL(),o=i.getProgram(rn,on);this.defaultLocations_?n=this.defaultLocations_:(n=new function(t,e){this.u_texCoordMatrix=t.getUniformLocation(e,ni.g?"u_texCoordMatrix":"d"),this.u_projectionMatrix=t.getUniformLocation(e,ni.g?"u_projectionMatrix":"e"),this.u_opacity=t.getUniformLocation(e,ni.g?"u_opacity":"f"),this.u_texture=t.getUniformLocation(e,ni.g?"u_texture":"g"),this.a_position=t.getAttribLocation(e,ni.g?"a_position":"b"),this.a_texCoord=t.getAttribLocation(e,ni.g?"a_texCoord":"c")}(r,o),this.defaultLocations_=n),i.useProgram(o)&&(r.enableVertexAttribArray(n.a_position),r.vertexAttribPointer(n.a_position,2,ni.l,!1,16,0),r.enableVertexAttribArray(n.a_texCoord),r.vertexAttribPointer(n.a_texCoord,2,ni.l,!1,16,8),r.uniform1i(n.u_texture,0)),r.uniformMatrix4fv(n.u_texCoordMatrix,!1,li(this.tmpMat4_,this.getTexCoordMatrix())),r.uniformMatrix4fv(n.u_projectionMatrix,!1,li(this.tmpMat4_,this.getProjectionMatrix())),r.uniform1f(n.u_opacity,e.opacity),r.bindTexture(ni.z,this.getTexture()),r.drawArrays(ni.F,0,4),this.dispatchComposeEvent_(Ye.a.POSTCOMPOSE,i,t)},e.prototype.dispatchComposeEvent_=function(t,e,i){var n=this.getLayer();if(n.hasListener(t)){var r=i.viewState,o=r.resolution,s=i.pixelRatio,a=i.extent,c=r.center,h=r.rotation,l=i.size,u=new Qi(e,c,o,h,l,a,s),_=new He(t,u,i,null,e);n.dispatchEvent(_)}},e.prototype.getTexCoordMatrix=function(){return this.texCoordMatrix},e.prototype.getTexture=function(){return this.texture},e.prototype.getProjectionMatrix=function(){return this.projectionMatrix},e.prototype.handleWebGLContextLost=function(){this.texture=null,this.framebuffer=null,this.framebufferDimension=void 0},e.prototype.prepareFrame=function(t,e,i){},e.prototype.forEachLayerAtPixel=function(t,e,i,n){},e}(nn),an=function(t){function e(e,i){t.call(this,e,i),this.image_=null,this.hitCanvasContext_=null,this.hitTransformationMatrix_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createTexture_=function(t){var e=t.getImage();return wi(this.mapRenderer.getGL(),e,ni.c,ni.c)},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r){var o=this.getLayer(),s=o.getSource(),a=e.viewState.resolution,c=e.viewState.rotation,h=e.skippedFeatureUids;return s.forEachFeatureAtCoordinate(t,a,c,i,h,function(t){return n.call(r,t,o)})},e.prototype.prepareFrame=function(t,e,i){var n=this.mapRenderer.getGL(),r=t.pixelRatio,o=t.viewState,s=o.center,a=o.resolution,c=o.rotation,h=this.image_,l=this.texture,u=this.getLayer().getSource(),_=t.viewHints,d=t.extent;if(void 0!==e.extent&&(d=Object(vt.A)(d,e.extent)),!_[ft.a.ANIMATING]&&!_[ft.a.INTERACTING]&&!Object(vt.G)(d)){var p=o.projection;if(!Ge.a){var f=u.getProjection();f&&(p=f)}var g=u.getImage(d,a,r,p);if(g&&this.loadImage(g)&&(h=g,l=this.createTexture_(g),this.texture)){var v=function(t,e){t.isContextLost()||t.deleteTexture(e)}.bind(null,n,this.texture);t.postRenderFunctions.push(v)}}if(h){var m=this.mapRenderer.getContext().getCanvas();this.updateProjectionMatrix_(m.width,m.height,r,s,a,c,h.getExtent()),this.hitTransformationMatrix_=null;var y=this.texCoordMatrix;Object(Ct.f)(y),Object(Ct.h)(y,1,-1),Object(Ct.j)(y,0,-1),this.image_=h,this.texture=l}return!!h},e.prototype.updateProjectionMatrix_=function(t,e,i,n,r,o,s){var a=t*r,c=e*r,h=this.projectionMatrix;Object(Ct.f)(h),Object(Ct.h)(h,2*i/a,2*i/c),Object(Ct.g)(h,-o),Object(Ct.j)(h,s[0]-n[0],s[1]-n[1]),Object(Ct.h)(h,(s[2]-s[0])/2,(s[3]-s[1])/2),Object(Ct.j)(h,1,1)},e.prototype.hasFeatureAtCoordinate=function(t,e){return void 0!==this.forEachFeatureAtCoordinate(t,e,0,mt.b,this)},e.prototype.forEachLayerAtPixel=function(t,e,i,n){if(this.image_&&this.image_.getImage()){if(this.getLayer().getSource().forEachFeatureAtCoordinate!==mt.c){var r=Object(Ct.a)(e.pixelToCoordinateTransform,t.slice());return this.forEachFeatureAtCoordinate(r,e,0,mt.b,this)?i.call(n,this.getLayer(),null):void 0}var o=[this.image_.getImage().width,this.image_.getImage().height];this.hitTransformationMatrix_||(this.hitTransformationMatrix_=this.getHitTransformationMatrix_(e.size,o));var s=Object(Ct.a)(this.hitTransformationMatrix_,t.slice());if(!(s[0]<0||s[0]>o[0]||s[1]<0||s[1]>o[1])){this.hitCanvasContext_||(this.hitCanvasContext_=Object(gt.a)(1,1)),this.hitCanvasContext_.clearRect(0,0,1,1),this.hitCanvasContext_.drawImage(this.image_.getImage(),s[0],s[1],1,1,0,0,1,1);var a=this.hitCanvasContext_.getImageData(0,0,1,1).data;return a[3]>0?i.call(n,this.getLayer(),a):void 0}}},e.prototype.getHitTransformationMatrix_=function(t,e){var i=Object(Ct.c)();Object(Ct.j)(i,-1,-1),Object(Ct.h)(i,2/t[0],2/t[1]),Object(Ct.j)(i,0,t[1]),Object(Ct.h)(i,1,-1);var n=Object(Ct.d)(this.projectionMatrix.slice()),r=Object(Ct.c)();return Object(Ct.j)(r,0,e[1]),Object(Ct.h)(r,1,-1),Object(Ct.h)(r,e[0]/2,e[1]/2),Object(Ct.j)(r,1,1),Object(Ct.e)(r,n),Object(Ct.e)(r,i),r},e}(sn);an.handles=function(t){return t.getType()===Ke.a.IMAGE},an.create=function(t,e){return new an(t,e)};var cn=an,hn=i(55),ln=function(t){function e(e){t.call(this),this.map_=e,this.layerRenderers_={},this.layerRendererListeners_={},this.layerRendererConstructors_=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.registerLayerRenderers=function(t){this.layerRendererConstructors_.push.apply(this.layerRendererConstructors_,t)},e.prototype.getLayerRendererConstructors=function(){return this.layerRendererConstructors_},e.prototype.calculateMatrices2D=function(t){var e=t.viewState,i=t.coordinateToPixelTransform,n=t.pixelToCoordinateTransform;Object(Ct.b)(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),Object(Ct.d)(Object(Ct.i)(n,i))},e.prototype.removeLayerRenderers=function(){for(var t in this.layerRenderers_)this.removeLayerRendererByKey_(t).dispose()},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,r,o,s,a){var c,h=e.viewState,l=h.resolution;function u(t,i){var s=Object(n.b)(t).toString(),a=e.layerStates[Object(n.b)(i)].managed;if(!(s in e.skippedFeatureUids)||a)return r.call(o,t,a?i:null)}var _=h.projection,d=t;if(_.canWrapX()){var p=_.getExtent(),f=Object(vt.D)(p),g=t[0];(g<p[0]||g>p[2])&&(d=[g+f*Math.ceil((p[0]-g)/f),t[1]])}var v,m=e.layerStatesArray;for(v=m.length-1;v>=0;--v){var y=m[v],b=y.layer;if(Object(Mt.b)(y,l)&&s.call(a,b)){var E=this.getLayerRenderer(b);if(b.getSource()&&(c=E.forEachFeatureAtCoordinate(b.getSource().getWrapX()?d:t,e,i,u,o)),c)return c}}},e.prototype.forEachLayerAtPixel=function(t,e,i,n,r,o,s){},e.prototype.hasFeatureAtCoordinate=function(t,e,i,n,r){return void 0!==this.forEachFeatureAtCoordinate(t,e,i,mt.b,this,n,r)},e.prototype.getLayerRenderer=function(t){var e=Object(n.b)(t).toString();if(e in this.layerRenderers_)return this.layerRenderers_[e];for(var i,r=0,o=this.layerRendererConstructors_.length;r<o;++r){var s=this.layerRendererConstructors_[r];if(s.handles(t)){i=s.create(this,t);break}}if(!i)throw new Error("Unable to create renderer for layer: "+t.getType());return this.layerRenderers_[e]=i,this.layerRendererListeners_[e]=Object(d.a)(i,l.a.CHANGE,this.handleLayerRendererChange_,this),i},e.prototype.getLayerRendererByKey=function(t){return this.layerRenderers_[t]},e.prototype.getLayerRenderers=function(){return this.layerRenderers_},e.prototype.getMap=function(){return this.map_},e.prototype.handleLayerRendererChange_=function(){this.map_.render()},e.prototype.removeLayerRendererByKey_=function(t){var e=this.layerRenderers_[t];return delete this.layerRenderers_[t],Object(d.e)(this.layerRendererListeners_[t]),delete this.layerRendererListeners_[t],e},e.prototype.removeUnusedLayerRenderers_=function(t,e){for(var i in this.layerRenderers_)e&&i in e.layerStates||this.removeLayerRendererByKey_(i).dispose()},e.prototype.scheduleExpireIconCache=function(t){t.postRenderFunctions.push(un)},e.prototype.scheduleRemoveUnusedLayerRenderers=function(t){for(var e in this.layerRenderers_)if(!(e in t.layerStates))return void t.postRenderFunctions.push(this.removeUnusedLayerRenderers_.bind(this))},e}(ge.a);function un(t,e){hn.a.expire()}function _n(t,e){return t.zIndex-e.zIndex}ln.prototype.renderFrame=mt.c;var dn=ln,pn=i(49),fn=function(t){function e(e){t.call(this,e);var i=e.getViewport();this.canvas_=document.createElement("CANVAS"),this.canvas_.style.width="100%",this.canvas_.style.height="100%",this.canvas_.style.display="block",this.canvas_.className=Rt.e,i.insertBefore(this.canvas_,i.childNodes[0]||null),this.clipTileCanvasWidth_=0,this.clipTileCanvasHeight_=0,this.clipTileContext_=Object(gt.a)(),this.renderedVisible_=!0,this.gl_=Object(ni.K)(this.canvas_,{antialias:!0,depth:!0,failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!1,stencil:!0}),this.context_=new Ri(this.canvas_,this.gl_),Object(d.a)(this.canvas_,Oi.LOST,this.handleWebGLContextLost,this),Object(d.a)(this.canvas_,Oi.RESTORED,this.handleWebGLContextRestored,this),this.textureCache_=new pn.a,this.focus_=null,this.tileTextureQueue_=new _t(function(t){var e=t[1],i=t[2],n=e[0]-this.focus_[0],r=e[1]-this.focus_[1];return 65536*Math.log(i)+Math.sqrt(n*n+r*r)/i}.bind(this),function(t){return t[0].getKey()}),this.loadNextTileTexture_=function(t,e){if(!this.tileTextureQueue_.isEmpty()){this.tileTextureQueue_.reprioritize();var i=this.tileTextureQueue_.dequeue(),n=i[0],r=i[3],o=i[4];this.bindTileTexture(n,r,o,ni.o,ni.o)}return!1}.bind(this),this.textureCacheFrameMarkerCount_=0,this.initializeGL_()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bindTileTexture=function(t,e,i,n,r){var o=this.getGL(),s=t.getKey();if(this.textureCache_.containsKey(s)){var a=this.textureCache_.get(s);o.bindTexture(ni.z,a.texture),a.magFilter!=n&&(o.texParameteri(ni.z,ni.A,n),a.magFilter=n),a.minFilter!=r&&(o.texParameteri(ni.z,ni.B,r),a.minFilter=r)}else{var c=o.createTexture();if(o.bindTexture(ni.z,c),i>0){var h=this.clipTileContext_.canvas,l=this.clipTileContext_;this.clipTileCanvasWidth_!==e[0]||this.clipTileCanvasHeight_!==e[1]?(h.width=e[0],h.height=e[1],this.clipTileCanvasWidth_=e[0],this.clipTileCanvasHeight_=e[1]):l.clearRect(0,0,e[0],e[1]),l.drawImage(t.getImage(),i,i,e[0],e[1],0,0,e[0],e[1]),o.texImage2D(ni.z,0,ni.s,ni.s,ni.G,h)}else o.texImage2D(ni.z,0,ni.s,ni.s,ni.G,t.getImage());o.texParameteri(ni.z,ni.A,n),o.texParameteri(ni.z,ni.B,r),o.texParameteri(ni.z,ni.C,ni.c),o.texParameteri(ni.z,ni.D,ni.c),this.textureCache_.set(s,{texture:c,magFilter:n,minFilter:r})}},e.prototype.dispatchComposeEvent_=function(t,e){var i=this.getMap();if(i.hasListener(t)){var n=this.context_,r=e.extent,o=e.size,s=e.viewState,a=e.pixelRatio,c=s.resolution,h=s.center,l=s.rotation,u=new Qi(n,h,c,l,o,r,a),_=new He(t,u,e,null,n);i.dispatchEvent(_)}},e.prototype.disposeInternal=function(){var e=this.getGL();e.isContextLost()||this.textureCache_.forEach(function(t){t&&e.deleteTexture(t.texture)}),this.context_.dispose(),t.prototype.disposeInternal.call(this)},e.prototype.expireCache_=function(t,e){for(var i,n=this.getGL();this.textureCache_.getCount()-this.textureCacheFrameMarkerCount_>1024;){if(i=this.textureCache_.peekLast())n.deleteTexture(i.texture);else{if(+this.textureCache_.peekLastKey()==e.index)break;--this.textureCacheFrameMarkerCount_}this.textureCache_.pop()}},e.prototype.getContext=function(){return this.context_},e.prototype.getGL=function(){return this.gl_},e.prototype.getTileTextureQueue=function(){return this.tileTextureQueue_},e.prototype.handleWebGLContextLost=function(t){t.preventDefault(),this.textureCache_.clear(),this.textureCacheFrameMarkerCount_=0;var e=this.getLayerRenderers();for(var i in e)e[i].handleWebGLContextLost()},e.prototype.handleWebGLContextRestored=function(){this.initializeGL_(),this.getMap().render()},e.prototype.initializeGL_=function(){var t=this.gl_;t.activeTexture(ni.y),t.blendFuncSeparate(ni.u,ni.r,ni.q,ni.r),t.disable(ni.f),t.disable(ni.h),t.disable(ni.t),t.disable(ni.w)},e.prototype.isTileTextureLoaded=function(t){return this.textureCache_.containsKey(t.getKey())},e.prototype.renderFrame=function(t){var e=this.getContext(),i=this.getGL();if(i.isContextLost())return!1;if(!t)return this.renderedVisible_&&(this.canvas_.style.display="none",this.renderedVisible_=!1),!1;this.focus_=t.focus,this.textureCache_.set((-t.index).toString(),null),++this.textureCacheFrameMarkerCount_,this.dispatchComposeEvent_(Ye.a.PRECOMPOSE,t);var n=[],r=t.layerStatesArray;Object(q.h)(r,_n);var o,s,a,c=t.viewState.resolution;for(o=0,s=r.length;o<s;++o)a=r[o],Object(Mt.b)(a,c)&&a.sourceState==bt.a.READY&&this.getLayerRenderer(a.layer).prepareFrame(t,a,e)&&n.push(a);var h=t.size[0]*t.pixelRatio,l=t.size[1]*t.pixelRatio;for(this.canvas_.width==h&&this.canvas_.height==l||(this.canvas_.width=h,this.canvas_.height=l),i.bindFramebuffer(ni.n,null),i.clearColor(0,0,0,0),i.clear(ni.e),i.enable(ni.b),i.viewport(0,0,this.canvas_.width,this.canvas_.height),o=0,s=n.length;o<s;++o)a=n[o],this.getLayerRenderer(a.layer).composeFrame(t,a,e);this.renderedVisible_||(this.canvas_.style.display="",this.renderedVisible_=!0),this.calculateMatrices2D(t),this.textureCache_.getCount()-this.textureCacheFrameMarkerCount_>1024&&t.postRenderFunctions.push(this.expireCache_.bind(this)),this.tileTextureQueue_.isEmpty()||(t.postRenderFunctions.push(this.loadNextTileTexture_),t.animate=!0),this.dispatchComposeEvent_(Ye.a.POSTCOMPOSE,t),this.scheduleRemoveUnusedLayerRenderers(t),this.scheduleExpireIconCache(t)},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r,o,s){var a;if(this.getGL().isContextLost())return!1;var c,h=e.viewState,l=e.layerStatesArray;for(c=l.length-1;c>=0;--c){var u=l[c],_=u.layer;if(Object(Mt.b)(u,h.resolution)&&o.call(s,_)&&(a=this.getLayerRenderer(_).forEachFeatureAtCoordinate(t,e,i,n,r)))return a}},e.prototype.hasFeatureAtCoordinate=function(t,e,i,n,r){var o=!1;if(this.getGL().isContextLost())return!1;var s,a=e.viewState,c=e.layerStatesArray;for(s=c.length-1;s>=0;--s){var h=c[s],l=h.layer;if(Object(Mt.b)(h,a.resolution)&&n.call(r,l)&&(o=this.getLayerRenderer(l).hasFeatureAtCoordinate(t,e)))return!0}return o},e.prototype.forEachLayerAtPixel=function(t,e,i,n,r,o,s){if(this.getGL().isContextLost())return!1;var a,c,h=e.viewState,l=e.layerStatesArray;for(c=l.length-1;c>=0;--c){var u=l[c],_=u.layer;if(Object(Mt.b)(u,h.resolution)&&o.call(r,_)&&(a=this.getLayerRenderer(_).forEachLayerAtPixel(t,e,n,r)))return a}},e}(dn),gn=i(48),vn=new si(ni.g?"precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  gl_FragColor = texture2D(u_texture, v_texCoord);\n}\n":"precision mediump float;varying vec2 a;uniform sampler2D e;void main(void){gl_FragColor=texture2D(e,a);}"),mn=new ai(ni.g?"varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nuniform vec4 u_tileOffset;\n\nvoid main(void) {\n  gl_Position = vec4(a_position * u_tileOffset.xy + u_tileOffset.zw, 0., 1.);\n  v_texCoord = a_texCoord;\n}\n\n\n":"varying vec2 a;attribute vec2 b;attribute vec2 c;uniform vec4 d;void main(void){gl_Position=vec4(b*d.xy+d.zw,0.,1.);a=c;}"),yn=function(t){function e(e,i){t.call(this,e,i),this.fragmentShader_=vn,this.vertexShader_=mn,this.locations_=null,this.renderArrayBuffer_=new yi([0,0,0,1,1,0,1,1,0,1,0,0,1,1,1,0]),this.renderedTileRange_=null,this.renderedFramebufferExtent_=null,this.renderedRevision_=-1,this.tmpSize_=[0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.mapRenderer.getContext().deleteBuffer(this.renderArrayBuffer_),t.prototype.disposeInternal.call(this)},e.prototype.createLoadedTileFinder=function(t,e,i){var n=this.mapRenderer;return function(r,o){return t.forEachLoadedTile(e,r,o,function(t){var e=n.isTileTextureLoaded(t);return e&&(i[r]||(i[r]={}),i[r][t.tileCoord.toString()]=t),e})}},e.prototype.handleWebGLContextLost=function(){t.prototype.handleWebGLContextLost.call(this),this.locations_=null},e.prototype.prepareFrame=function(t,e,i){var n,r=this.mapRenderer,o=i.getGL(),s=t.viewState,a=s.projection,c=this.getLayer(),h=c.getSource(),l=h.getTileGridForProjection(a),u=l.getZForResolution(s.resolution),_=l.getResolution(u),d=h.getTilePixelSize(u,t.pixelRatio,a),p=d[0]/Object(Ot.c)(l.getTileSize(u),this.tmpSize_)[0],f=_/p,g=h.getTilePixelRatio(p)*h.getGutter(a),v=s.center,m=t.extent,y=l.getTileRangeForExtentAndZ(m,u);if(this.renderedTileRange_&&this.renderedTileRange_.equals(y)&&this.renderedRevision_==h.getRevision())n=this.renderedFramebufferExtent_;else{var b=y.getSize(),E=Math.max(b[0]*d[0],b[1]*d[1]),x=Object(Ft.e)(E),O=f*x,C=l.getOrigin(u),T=C[0]+y.minX*d[0]*f,w=C[1]+y.minY*d[1]*f;n=[T,w,T+O,w+O],this.bindFramebuffer(t,x),o.viewport(0,0,x,x),o.clearColor(0,0,0,0),o.clear(ni.e),o.disable(ni.b);var R=i.getProgram(this.fragmentShader_,this.vertexShader_);i.useProgram(R),this.locations_||(this.locations_=new function(t,e){this.u_tileOffset=t.getUniformLocation(e,ni.g?"u_tileOffset":"d"),this.u_texture=t.getUniformLocation(e,ni.g?"u_texture":"e"),this.a_position=t.getAttribLocation(e,ni.g?"a_position":"b"),this.a_texCoord=t.getAttribLocation(e,ni.g?"a_texCoord":"c")}(o,R)),i.bindBuffer(ni.a,this.renderArrayBuffer_),o.enableVertexAttribArray(this.locations_.a_position),o.vertexAttribPointer(this.locations_.a_position,2,ni.l,!1,16,0),o.enableVertexAttribArray(this.locations_.a_texCoord),o.vertexAttribPointer(this.locations_.a_texCoord,2,ni.l,!1,16,8),o.uniform1i(this.locations_.u_texture,0);var M={};M[u]={};var P,I,D,L,S,A,j=this.createLoadedTileFinder(h,a,M),k=c.getUseInterimTilesOnError(),F=!0,U=Object(vt.i)(),N=new gn.b(0,0,0,0);for(L=y.minX;L<=y.maxX;++L)for(S=y.minY;S<=y.maxY;++S)if(I=h.getTile(u,L,S,p,a),void 0===e.extent||(A=l.getTileCoordExtent(I.tileCoord,U),Object(vt.E)(A,e.extent))){if((D=I.getState())==ct.a.LOADED||D==ct.a.EMPTY||D==ct.a.ERROR&&!k||(I=I.getInterimTile()),(D=I.getState())==ct.a.LOADED){if(r.isTileTextureLoaded(I)){M[u][I.tileCoord.toString()]=I;continue}}else if(D==ct.a.EMPTY||D==ct.a.ERROR&&!k)continue;F=!1,l.forEachTileCoordParentTileRange(I.tileCoord,j,null,N,U)||(P=l.getTileCoordChildTileRange(I.tileCoord,N,U))&&j(u+1,P)}var B=Object.keys(M).map(Number);B.sort(q.f);for(var W=new Float32Array(4),z=0,G=B.length;z<G;++z){var K=M[B[z]];for(var H in K)I=K[H],A=l.getTileCoordExtent(I.tileCoord,U),W[0]=2*(A[2]-A[0])/O,W[1]=2*(A[3]-A[1])/O,W[2]=2*(A[0]-n[0])/O-1,W[3]=2*(A[1]-n[1])/O-1,o.uniform4fv(this.locations_.u_tileOffset,W),r.bindTileTexture(I,d,g*p,ni.o,ni.o),o.drawArrays(ni.F,0,4)}F?(this.renderedTileRange_=y,this.renderedFramebufferExtent_=n,this.renderedRevision_=h.getRevision()):(this.renderedTileRange_=null,this.renderedFramebufferExtent_=null,this.renderedRevision_=-1,t.animate=!0)}this.updateUsedTiles(t.usedTiles,h,u,y);var Y=r.getTileTextureQueue();this.manageTilePyramid(t,h,l,p,a,m,u,c.getPreload(),function(t){t.getState()!=ct.a.LOADED||r.isTileTextureLoaded(t)||Y.isKeyQueued(t.getKey())||Y.enqueue([t,l.getTileCoordCenter(t.tileCoord),l.getResolution(t.tileCoord[0]),d,g*p])},this),this.scheduleExpireCache(t,h);var V=this.texCoordMatrix;return Object(Ct.f)(V),Object(Ct.j)(V,(Math.round(v[0]/_)*_-n[0])/(n[2]-n[0]),(Math.round(v[1]/_)*_-n[1])/(n[3]-n[1])),0!==s.rotation&&Object(Ct.g)(V,s.rotation),Object(Ct.h)(V,t.size[0]*s.resolution/(n[2]-n[0]),t.size[1]*s.resolution/(n[3]-n[1])),Object(Ct.j)(V,-.5,-.5),!0},e.prototype.forEachLayerAtPixel=function(t,e,i,n){if(this.framebuffer){var r=[t[0]/e.size[0],(e.size[1]-t[1])/e.size[1]],o=Object(Ct.a)(this.texCoordMatrix,r.slice()),s=[o[0]*this.framebufferDimension,o[1]*this.framebufferDimension],a=this.mapRenderer.getContext().getGL();a.bindFramebuffer(a.FRAMEBUFFER,this.framebuffer);var c=new Uint8Array(4);return a.readPixels(s[0],s[1],1,1,a.RGBA,a.UNSIGNED_BYTE,c),c[3]>0?i.call(n,this.getLayer(),c):void 0}},e}(sn);yn.handles=function(t){return t.getType()===Ke.a.TILE},yn.create=function(t,e){return new yn(t,e)};var bn=yn,En=.5,xn={Point:function(t,e,i,n){var r=i.getImage();if(r){if(r.getImageState()!=tn.a.LOADED)return;var o=t.getReplay(i.getZIndex(),Xe.IMAGE);o.setImageStyle(r,t.addDeclutter(!1)),o.drawPoint(e,n)}var s=i.getText();if(s){var a=t.getReplay(i.getZIndex(),Xe.TEXT);a.setTextStyle(s,t.addDeclutter(!!r)),a.drawText(e,n)}},LineString:function(t,e,i,n){var r=i.getStroke();if(r){var o=t.getReplay(i.getZIndex(),Xe.LINE_STRING);o.setFillStrokeStyle(null,r),o.drawLineString(e,n)}var s=i.getText();if(s){var a=t.getReplay(i.getZIndex(),Xe.TEXT);a.setTextStyle(s,t.addDeclutter(!1)),a.drawText(e,n)}},Polygon:function(t,e,i,n){var r=i.getFill(),o=i.getStroke();if(r||o){var s=t.getReplay(i.getZIndex(),Xe.POLYGON);s.setFillStrokeStyle(r,o),s.drawPolygon(e,n)}var a=i.getText();if(a){var c=t.getReplay(i.getZIndex(),Xe.TEXT);c.setTextStyle(a,t.addDeclutter(!1)),c.drawText(e,n)}},MultiPoint:function(t,e,i,n){var r=i.getImage();if(r){if(r.getImageState()!=tn.a.LOADED)return;var o=t.getReplay(i.getZIndex(),Xe.IMAGE);o.setImageStyle(r,t.addDeclutter(!1)),o.drawMultiPoint(e,n)}var s=i.getText();if(s){var a=t.getReplay(i.getZIndex(),Xe.TEXT);a.setTextStyle(s,t.addDeclutter(!!r)),a.drawText(e,n)}},MultiLineString:function(t,e,i,n){var r=i.getStroke();if(r){var o=t.getReplay(i.getZIndex(),Xe.LINE_STRING);o.setFillStrokeStyle(null,r),o.drawMultiLineString(e,n)}var s=i.getText();if(s){var a=t.getReplay(i.getZIndex(),Xe.TEXT);a.setTextStyle(s,t.addDeclutter(!1)),a.drawText(e,n)}},MultiPolygon:function(t,e,i,n){var r=i.getFill(),o=i.getStroke();if(o||r){var s=t.getReplay(i.getZIndex(),Xe.POLYGON);s.setFillStrokeStyle(r,o),s.drawMultiPolygon(e,n)}var a=i.getText();if(a){var c=t.getReplay(i.getZIndex(),Xe.TEXT);c.setTextStyle(a,t.addDeclutter(!1)),c.drawText(e,n)}},GeometryCollection:function(t,e,i,n){var r,o,s=e.getGeometriesArray();for(r=0,o=s.length;r<o;++r){var a=xn[s[r].getType()];a(t,s[r],i,n)}},Circle:function(t,e,i,n){var r=i.getFill(),o=i.getStroke();if(r||o){var s=t.getReplay(i.getZIndex(),Xe.CIRCLE);s.setFillStrokeStyle(r,o),s.drawCircle(e,n)}var a=i.getText();if(a){var c=t.getReplay(i.getZIndex(),Xe.TEXT);c.setTextStyle(a,t.addDeclutter(!1)),c.drawText(e,n)}}};function On(t,e){return Object(n.b)(t)-Object(n.b)(e)}function Cn(t,e){var i=Tn(t,e);return i*i}function Tn(t,e){return En*t/e}function wn(t,e,i,n,r,o){var s=!1,a=i.getImage();if(a){var c=a.getImageState();c==tn.a.LOADED||c==tn.a.ERROR?a.unlistenImageChange(r,o):(c==tn.a.IDLE&&a.load(),c=a.getImageState(),a.listenImageChange(r,o),s=!0)}return function(t,e,i,n){var r=i.getGeometryFunction()(e);if(r){var o=r.getSimplifiedGeometry(n);if(i.getRenderer())!function t(e,i,n,r){if(i.getType()!=Ve.a.GEOMETRY_COLLECTION){var o=e.getReplay(n.getZIndex(),Xe.DEFAULT);o.drawCustom(i,r,n.getRenderer())}else for(var s=i.getGeometries(),a=0,c=s.length;a<c;++a)t(e,s[a],n,r)}(t,o,i,e);else{var s=xn[o.getType()];s(t,o,i,e)}}}(t,e,i,n),s}var Rn=function(t){function e(e,i){t.call(this,e,i),this.dirty_=!1,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Object(vt.i)(),this.renderedRenderOrder_=null,this.replayGroup_=null,this.layerState_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.composeFrame=function(t,e,i){this.layerState_=e;var n=t.viewState,r=this.replayGroup_,o=t.size,s=t.pixelRatio,a=this.mapRenderer.getGL();r&&!r.isEmpty()&&(a.enable(a.SCISSOR_TEST),a.scissor(0,0,o[0]*s,o[1]*s),r.replay(i,n.center,n.resolution,n.rotation,o,s,e.opacity,e.managed?t.skippedFeatureUids:{}),a.disable(a.SCISSOR_TEST))},e.prototype.disposeInternal=function(){var e=this.replayGroup_;if(e){var i=this.mapRenderer.getContext();e.getDeleteResourcesFunction(i)(),this.replayGroup_=null}t.prototype.disposeInternal.call(this)},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,r,o){if(this.replayGroup_&&this.layerState_){var s=this.mapRenderer.getContext(),a=e.viewState,c=this.getLayer(),h=this.layerState_,l={};return this.replayGroup_.forEachFeatureAtCoordinate(t,s,a.center,a.resolution,a.rotation,e.size,e.pixelRatio,h.opacity,{},function(t){var e=Object(n.b)(t).toString();if(!(e in l))return l[e]=!0,r.call(o,t,c)})}},e.prototype.hasFeatureAtCoordinate=function(t,e){if(this.replayGroup_&&this.layerState_){var i=this.mapRenderer.getContext(),n=e.viewState,r=this.layerState_;return this.replayGroup_.hasFeatureAtCoordinate(t,i,n.center,n.resolution,n.rotation,e.size,e.pixelRatio,r.opacity,e.skippedFeatureUids)}return!1},e.prototype.forEachLayerAtPixel=function(t,e,i,n){var r=Object(Ct.a)(e.pixelToCoordinateTransform,t.slice());return this.hasFeatureAtCoordinate(r,e)?i.call(n,this.getLayer(),null):void 0},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.prepareFrame=function(t,e,i){var n=this.getLayer(),r=n.getSource(),o=t.viewHints[ft.a.ANIMATING],s=t.viewHints[ft.a.INTERACTING],a=n.getUpdateWhileAnimating(),c=n.getUpdateWhileInteracting();if(!this.dirty_&&!a&&o||!c&&s)return!0;var h=t.extent,l=t.viewState,u=l.projection,_=l.resolution,d=t.pixelRatio,p=n.getRevision(),f=n.getRenderBuffer(),g=n.getRenderOrder();void 0===g&&(g=On);var v=Object(vt.c)(h,f*_);if(!this.dirty_&&this.renderedResolution_==_&&this.renderedRevision_==p&&this.renderedRenderOrder_==g&&Object(vt.g)(this.renderedExtent_,v))return!0;this.replayGroup_&&t.postRenderFunctions.push(this.replayGroup_.getDeleteResourcesFunction(i)),this.dirty_=!1;var m=new Ji(Tn(_,d),v,n.getRenderBuffer());r.loadFeatures(v,_,u);var y=function(t){var e,i=t.getStyleFunction()||n.getStyleFunction();if(i&&(e=i(t,_)),e){var r=this.renderFeature(t,_,d,e,m);this.dirty_=this.dirty_||r}};if(g){var b=[];r.forEachFeatureInExtent(v,function(t){b.push(t)},this),b.sort(g),b.forEach(y.bind(this))}else r.forEachFeatureInExtent(v,y,this);return m.finish(i),this.renderedResolution_=_,this.renderedRevision_=p,this.renderedRenderOrder_=g,this.renderedExtent_=v,this.replayGroup_=m,!0},e.prototype.renderFeature=function(t,e,i,n,r){if(!n)return!1;var o=!1;if(Array.isArray(n))for(var s=n.length-1;s>=0;--s)o=wn(r,t,n[s],Cn(e,i),this.handleStyleImageChange_,this)||o;else o=wn(r,t,n,Cn(e,i),this.handleStyleImageChange_,this)||o;return o},e}(sn);Rn.handles=function(t){return t.getType()===Ke.a.VECTOR},Rn.create=function(t,e){return new Rn(t,e)};var Mn=Rn,Pn=function(t){function e(e){(e=Object(lt.a)({},e)).controls||(e.controls=function(t){var e={},i=new r.a;return(void 0===e.zoom||e.zoom)&&i.push(new At(e.zoomOptions)),(void 0===e.rotate||e.rotate)&&i.push(new St(e.rotateOptions)),(void 0===e.attribution||e.attribution)&&i.push(new It(e.attributionOptions)),i}()),e.interactions||(e.interactions=function(t){var e={},i=new r.a,n=new kt(-.005,.05,100);return(void 0===e.altShiftDragRotate||e.altShiftDragRotate)&&i.push(new fe),(void 0===e.doubleClickZoom||e.doubleClickZoom)&&i.push(new Kt({delta:e.zoomDelta,duration:e.zoomDuration})),(void 0===e.dragPan||e.dragPan)&&i.push(new le({kinetic:n})),(void 0===e.pinchRotate||e.pinchRotate)&&i.push(new Ue),(void 0===e.pinchZoom||e.pinchZoom)&&i.push(new ze({constrainResolution:e.constrainResolution,duration:e.zoomDuration})),(void 0===e.keyboard||e.keyboard)&&(i.push(new Pe),i.push(new De({delta:e.zoomDelta,duration:e.zoomDuration}))),(void 0===e.mouseWheelZoom||e.mouseWheelZoom)&&i.push(new Ae({constrainResolution:e.constrainResolution,duration:e.zoomDuration})),(void 0===e.shiftDragZoom||e.shiftDragZoom)&&i.push(new we({duration:e.zoomDuration})),i}()),t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createRenderer=function(){var t=new fn(this);return t.registerLayerRenderers([cn,bn,Mn]),t},e}(Tt);e.default=Pn},function(t,e,i){"use strict";i.r(e);var n=i(30),r=i(3),o=i(8),s=i(24),a=i(32),c=i(4),h=function(t){function e(e,i,n){t.call(this);var r=n||{};this.tileCoord=e,this.state=i,this.interimTile=null,this.key="",this.transition_=void 0===r.transition?250:r.transition,this.transitionStarts_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.changed=function(){this.dispatchEvent(c.a.CHANGE)},e.prototype.getKey=function(){return this.key+"/"+this.tileCoord},e.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==o.a.LOADED)return t;t=t.interimTile}while(t);return this},e.prototype.refreshInterimChain=function(){if(this.interimTile){var t=this.interimTile,e=this;do{if(t.getState()==o.a.LOADED){t.interimTile=null;break}t.getState()==o.a.LOADING?e=t:t.getState()==o.a.IDLE?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}},e.prototype.getTileCoord=function(){return this.tileCoord},e.prototype.getState=function(){return this.state},e.prototype.setState=function(t){this.state=t,this.changed()},e.prototype.load=function(){},e.prototype.getAlpha=function(t,e){if(!this.transition_)return 1;var i=this.transitionStarts_[t];if(i){if(-1===i)return 1}else i=e,this.transitionStarts_[t]=i;var n=e-i+1e3/60;return n>=this.transition_?1:Object(s.a)(n/this.transition_)},e.prototype.inTransition=function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]},e.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},e}(a.a),l=i(14),u=i(1);function _(){var t=Object(l.a)(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}var d=function(t){function e(e,i,n,r,o,s){t.call(this,e,i,s),this.crossOrigin_=r,this.src_=n,this.image_=new Image,null!==r&&(this.image_.crossOrigin=r),this.imageListenerKeys_=null,this.tileLoadFunction_=o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.state==o.a.LOADING&&(this.unlistenImage_(),this.image_=_()),this.interimTile&&this.interimTile.dispose(),this.state=o.a.ABORT,this.changed(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.image_},e.prototype.getKey=function(){return this.src_},e.prototype.handleImageError_=function(){this.state=o.a.ERROR,this.unlistenImage_(),this.image_=_(),this.changed()},e.prototype.handleImageLoad_=function(){this.image_.naturalWidth&&this.image_.naturalHeight?this.state=o.a.LOADED:this.state=o.a.EMPTY,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state==o.a.ERROR&&(this.state=o.a.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==o.a.IDLE&&(this.state=o.a.LOADING,this.changed(),this.imageListenerKeys_=[Object(u.b)(this.image_,c.a.ERROR,this.handleImageError_,this),Object(u.b)(this.image_,c.a.LOAD,this.handleImageLoad_,this)],this.tileLoadFunction_(this,this.src_))},e.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(u.e),this.imageListenerKeys_=null},e}(h);function p(t,e,i,n){return void 0!==n?(n[0]=t,n[1]=e,n[2]=i,n):[t,e,i]}function f(t,e,i){return t+"/"+e+"/"+i}function g(t){return f(t[0],t[1],t[2])}var v=function(t){function e(e){t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.expireCache=function(t){for(;this.canExpireCache();){var e=this.peekLast(),i=e.tileCoord[0].toString();if(i in t&&t[i].contains(e.tileCoord))break;this.pop().dispose()}},e.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var t=function(t){return t.split("/").map(Number)}(this.peekFirstKey())[0];this.forEach(function(e){e.tileCoord[0]!==t&&(this.remove(g(e.tileCoord)),e.dispose())},this)}},e}(i(49).a),m=i(16),y=i(2),b=i(5);function E(t,e,i,n){var r=i-t,o=n-e,s=Math.sqrt(r*r+o*o);return[Math.round(i+r/s),Math.round(n+o/s)]}var x=function(t,e,i,n,r){this.sourceProj_=t,this.targetProj_=e;var o={},s=Object(m.getTransform)(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];return o[e]||(o[e]=s(t)),o[e]},this.maxSourceExtent_=n,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&Object(y.D)(n)==Object(y.D)(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Object(y.D)(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Object(y.D)(this.targetProj_.getExtent()):null;var a=Object(y.B)(i),c=Object(y.C)(i),h=Object(y.v)(i),l=Object(y.u)(i),u=this.transformInv_(a),_=this.transformInv_(c),d=this.transformInv_(h),p=this.transformInv_(l);if(this.addQuad_(a,c,h,l,u,_,d,p,10),this.wrapsXInSource_){var f=1/0;this.triangles_.forEach(function(t,e,i){f=Math.min(f,t.source[0][0],t.source[1][0],t.source[2][0])}),this.triangles_.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-f>this.sourceWorldWidth_/2){var e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];e[0][0]-f>this.sourceWorldWidth_/2&&(e[0][0]-=this.sourceWorldWidth_),e[1][0]-f>this.sourceWorldWidth_/2&&(e[1][0]-=this.sourceWorldWidth_),e[2][0]-f>this.sourceWorldWidth_/2&&(e[2][0]-=this.sourceWorldWidth_);var i=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-i<this.sourceWorldWidth_/2&&(t.source=e)}}.bind(this))}o={}};x.prototype.addTriangle_=function(t,e,i,n,r,o){this.triangles_.push({source:[n,r,o],target:[t,e,i]})},x.prototype.addQuad_=function(t,e,i,n,r,o,s,a,c){var h=Object(y.b)([r,o,s,a]),l=this.sourceWorldWidth_?Object(y.D)(h)/this.sourceWorldWidth_:null,u=this.sourceWorldWidth_,_=this.sourceProj_.canWrapX()&&l>.5&&l<1,d=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){var p=Object(y.b)([t,e,i,n]);d|=Object(y.D)(p)/this.targetWorldWidth_>.25}!_&&this.sourceProj_.isGlobal()&&l&&(d|=l>.25)}if(d||!this.maxSourceExtent_||Object(y.E)(h,this.maxSourceExtent_)){if(!(d||isFinite(r[0])&&isFinite(r[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(a[0])&&isFinite(a[1]))){if(!(c>0))return;d=!0}if(c>0){if(!d){var f,g=[(t[0]+i[0])/2,(t[1]+i[1])/2],v=this.transformInv_(g);f=_?(Object(b.d)(r[0],u)+Object(b.d)(s[0],u))/2-Object(b.d)(v[0],u):(r[0]+s[0])/2-v[0];var m=(r[1]+s[1])/2-v[1];d=f*f+m*m>this.errorThresholdSquared_}if(d){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){var E=[(e[0]+i[0])/2,(e[1]+i[1])/2],x=this.transformInv_(E),O=[(n[0]+t[0])/2,(n[1]+t[1])/2],C=this.transformInv_(O);this.addQuad_(t,e,E,O,r,o,x,C,c-1),this.addQuad_(O,E,i,n,C,x,s,a,c-1)}else{var T=[(t[0]+e[0])/2,(t[1]+e[1])/2],w=this.transformInv_(T),R=[(i[0]+n[0])/2,(i[1]+n[1])/2],M=this.transformInv_(R);this.addQuad_(t,T,R,n,r,w,M,a,c-1),this.addQuad_(T,e,i,R,w,o,s,M,c-1)}return}}if(_){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(t,i,n,r,s,a),this.addTriangle_(t,e,i,r,o,s)}},x.prototype.calculateSourceExtent=function(){var t=Object(y.i)();return this.triangles_.forEach(function(e,i,n){var r=e.source;Object(y.q)(t,r[0]),Object(y.q)(t,r[1]),Object(y.q)(t,r[2])}),t},x.prototype.getTriangles=function(){return this.triangles_};var O=x,C=function(t){function e(e,i,r,s,a,c,h,l,u,_,d){t.call(this,a,o.a.IDLE),this.renderEdges_=void 0!==d&&d,this.pixelRatio_=h,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=i,this.targetTileGrid_=s,this.wrappedTileCoord_=c||a,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;var p=s.getTileCoordExtent(this.wrappedTileCoord_),f=this.targetTileGrid_.getExtent(),g=this.sourceTileGrid_.getExtent(),v=f?Object(y.A)(p,f):p;if(0!==Object(y.t)(v)){var E=e.getExtent();E&&(g=g?Object(y.A)(g,E):E);var x=s.getResolution(this.wrappedTileCoord_[0]),C=function(t,e,i,n){var r=Object(m.transform)(i,e,t),o=Object(m.getPointResolution)(e,n,i),s=e.getMetersPerUnit();void 0!==s&&(o*=s);var a=t.getMetersPerUnit();void 0!==a&&(o/=a);var c=t.getExtent();if(!c||Object(y.f)(c,r)){var h=Object(m.getPointResolution)(t,o,r)/o;isFinite(h)&&h>0&&(o/=h)}return o}(e,r,Object(y.w)(v),x);if(!isFinite(C)||C<=0)this.state=o.a.EMPTY;else{var T=void 0!==_?_:n.b;if(this.triangulation_=new O(e,r,v,g,C*T),0!==this.triangulation_.getTriangles().length){this.sourceZ_=i.getZForResolution(C);var w=this.triangulation_.calculateSourceExtent();if(g&&(e.canWrapX()?(w[1]=Object(b.a)(w[1],g[1],g[3]),w[3]=Object(b.a)(w[3],g[1],g[3])):w=Object(y.A)(w,g)),Object(y.t)(w)){for(var R=i.getTileRangeForExtentAndZ(w,this.sourceZ_),M=R.minX;M<=R.maxX;M++)for(var P=R.minY;P<=R.maxY;P++){var I=u(this.sourceZ_,M,P,h);I&&this.sourceTiles_.push(I)}0===this.sourceTiles_.length&&(this.state=o.a.EMPTY)}else this.state=o.a.EMPTY}else this.state=o.a.EMPTY}}else this.state=o.a.EMPTY}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.state==o.a.LOADING&&this.unlistenSources_(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.canvas_},e.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach(function(e,i,n){e&&e.getState()==o.a.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===t.length)this.state=o.a.ERROR;else{var e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),n="number"==typeof i?i:i[0],r="number"==typeof i?i:i[1],s=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),c=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=function(t,e,i,n,r,o,s,a,c,h,u){var _=Object(l.a)(Math.round(i*t),Math.round(i*e));if(0===c.length)return _.canvas;_.scale(i,i);var d=Object(y.i)();c.forEach(function(t,e,i){Object(y.p)(d,t.extent)});var p=Object(y.D)(d),f=Object(y.z)(d),g=Object(l.a)(Math.round(i*p/n),Math.round(i*f/n)),v=i/n;c.forEach(function(t,e,i){var n=t.extent[0]-d[0],r=-(t.extent[3]-d[3]),o=Object(y.D)(t.extent),s=Object(y.z)(t.extent);g.drawImage(t.image,h,h,t.image.width-2*h,t.image.height-2*h,n*v,r*v,o*v,s*v)});var m=Object(y.B)(s);return a.getTriangles().forEach(function(t,e,r){var s=t.source,a=t.target,c=s[0][0],h=s[0][1],l=s[1][0],u=s[1][1],p=s[2][0],f=s[2][1],v=(a[0][0]-m[0])/o,y=-(a[0][1]-m[1])/o,x=(a[1][0]-m[0])/o,O=-(a[1][1]-m[1])/o,C=(a[2][0]-m[0])/o,T=-(a[2][1]-m[1])/o,w=c,R=h;c=0,h=0;var M=[[l-=w,u-=R,0,0,x-v],[p-=w,f-=R,0,0,C-v],[0,0,l,u,O-y],[0,0,p,f,T-y]],P=Object(b.f)(M);if(P){_.save(),_.beginPath();var I=(v+x+C)/3,D=(y+O+T)/3,L=E(I,D,v,y),S=E(I,D,x,O),A=E(I,D,C,T);_.moveTo(S[0],S[1]),_.lineTo(L[0],L[1]),_.lineTo(A[0],A[1]),_.clip(),_.transform(P[0],P[2],P[1],P[3],v,y),_.translate(d[0]-w,d[3]-R),_.scale(n/i,-n/i),_.drawImage(g.canvas,0,0),_.restore()}}),u&&(_.save(),_.strokeStyle="black",_.lineWidth=1,a.getTriangles().forEach(function(t,e,i){var n=t.target,r=(n[0][0]-m[0])/o,s=-(n[0][1]-m[1])/o,a=(n[1][0]-m[0])/o,c=-(n[1][1]-m[1])/o,h=(n[2][0]-m[0])/o,l=-(n[2][1]-m[1])/o;_.beginPath(),_.moveTo(a,c),_.lineTo(r,s),_.lineTo(h,l),_.closePath(),_.stroke()}),_.restore()),_.canvas}(n,r,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),s,c,this.triangulation_,t,this.gutter_,this.renderEdges_),this.state=o.a.LOADED}this.changed()},e.prototype.load=function(){if(this.state==o.a.IDLE){this.state=o.a.LOADING,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(e,i,n){var r=e.getState();if(r==o.a.IDLE||r==o.a.LOADING){t++;var s=Object(u.a)(e,c.a.CHANGE,function(i){var n=e.getState();n!=o.a.LOADED&&n!=o.a.ERROR&&n!=o.a.EMPTY||(Object(u.e)(s),0==--t&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(s)}}.bind(this)),this.sourceTiles_.forEach(function(t,e,i){t.getState()==o.a.IDLE&&t.load()}),0===t&&setTimeout(this.reproject_.bind(this),0)}},e.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(u.e),this.sourcesListenerKeys_=null},e}(h),T=i(11);function w(t,e){var i=/\{z\}/g,n=/\{x\}/g,r=/\{y\}/g,o=/\{-y\}/g;return function(s,a,c){return s?t.replace(i,s[0].toString()).replace(n,s[1].toString()).replace(r,function(){return(-s[2]-1).toString()}).replace(o,function(){var t=s[0],i=e.getFullTileRange(t);return Object(T.a)(i,55),(i.getHeight()+s[2]).toString()}):void 0}}function R(t,e){for(var i=t.length,n=new Array(i),r=0;r<i;++r)n[r]=w(t[r],e);return function(t){return 1===t.length?t[0]:function(e,i,n){if(e){var r=function(t){return(t[1]<<t[0])+t[2]}(e),o=Object(b.d)(r,t.length);return t[o](e,i,n)}}}(n)}function M(t,e,i){}var P=i(9),I=i(17),D=i(29),L=i(62),S=i(44),A=i(45),j=i(10),k=i(18),F=i(48),U=i(13),N=[0,0,0],B=function(t){var e;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,Object(T.a)(Object(U.d)(this.resolutions_,function(t,e){return e-t},!0),17),!t.origins)for(var i=0,n=this.resolutions_.length-1;i<n;++i)if(e){if(this.resolutions_[i]/this.resolutions_[i+1]!==e){e=void 0;break}}else e=this.resolutions_[i]/this.resolutions_[i+1];this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,Object(T.a)(this.origins_.length==this.resolutions_.length,20));var r=t.extent;void 0===r||this.origin_||this.origins_||(this.origin_=Object(y.B)(r)),Object(T.a)(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,Object(T.a)(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:S.b,Object(T.a)(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==r?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map(function(t,e){return new F.b(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1))},this):r&&this.calculateTileRanges_(r)};B.prototype.forEachTileCoord=function(t,e,i){for(var n=this.getTileRangeForExtentAndZ(t,e),r=n.minX,o=n.maxX;r<=o;++r)for(var s=n.minY,a=n.maxY;s<=a;++s)i([e,r,s])},B.prototype.forEachTileCoordParentTileRange=function(t,e,i,n,r){var o,s,a,c=null,h=t[0]-1;for(2===this.zoomFactor_?(s=t[1],a=t[2]):c=this.getTileCoordExtent(t,r);h>=this.minZoom;){if(2===this.zoomFactor_?(s=Math.floor(s/2),a=Math.floor(a/2),o=Object(F.a)(s,s,a,a,n)):o=this.getTileRangeForExtentAndZ(c,h,n),e.call(i,h,o))return!0;--h}return!1},B.prototype.getExtent=function(){return this.extent_},B.prototype.getMaxZoom=function(){return this.maxZoom},B.prototype.getMinZoom=function(){return this.minZoom},B.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},B.prototype.getResolution=function(t){return this.resolutions_[t]},B.prototype.getResolutions=function(){return this.resolutions_},B.prototype.getTileCoordChildTileRange=function(t,e,i){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var n=2*t[1],r=2*t[2];return Object(F.a)(n,n+1,r,r+1,e)}var o=this.getTileCoordExtent(t,i);return this.getTileRangeForExtentAndZ(o,t[0]+1,e)}return null},B.prototype.getTileRangeExtent=function(t,e,i){var n=this.getOrigin(t),r=this.getResolution(t),o=Object(D.c)(this.getTileSize(t),this.tmpSize_),s=n[0]+e.minX*o[0]*r,a=n[0]+(e.maxX+1)*o[0]*r,c=n[1]+e.minY*o[1]*r,h=n[1]+(e.maxY+1)*o[1]*r;return Object(y.j)(s,c,a,h,i)},B.prototype.getTileRangeForExtentAndZ=function(t,e,i){var n=N;this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n);var r=n[1],o=n[2];return this.getTileCoordForXYAndZ_(t[2],t[3],e,!0,n),Object(F.a)(r,n[1],o,n[2],i)},B.prototype.getTileCoordCenter=function(t){var e=this.getOrigin(t[0]),i=this.getResolution(t[0]),n=Object(D.c)(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*n[0]*i,e[1]+(t[2]+.5)*n[1]*i]},B.prototype.getTileCoordExtent=function(t,e){var i=this.getOrigin(t[0]),n=this.getResolution(t[0]),r=Object(D.c)(this.getTileSize(t[0]),this.tmpSize_),o=i[0]+t[1]*r[0]*n,s=i[1]+t[2]*r[1]*n,a=o+r[0]*n,c=s+r[1]*n;return Object(y.j)(o,s,a,c,e)},B.prototype.getTileCoordForCoordAndResolution=function(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)},B.prototype.getTileCoordForXYAndResolution_=function(t,e,i,n,r){var o=this.getZForResolution(i),s=i/this.getResolution(o),a=this.getOrigin(o),c=Object(D.c)(this.getTileSize(o),this.tmpSize_),h=n?.5:0,l=n?0:.5,u=Math.floor((t-a[0])/i+h),_=Math.floor((e-a[1])/i+l),d=s*u/c[0],f=s*_/c[1];return n?(d=Math.ceil(d)-1,f=Math.ceil(f)-1):(d=Math.floor(d),f=Math.floor(f)),p(o,d,f,r)},B.prototype.getTileCoordForXYAndZ_=function(t,e,i,n,r){var o=this.getOrigin(i),s=this.getResolution(i),a=Object(D.c)(this.getTileSize(i),this.tmpSize_),c=n?.5:0,h=n?0:.5,l=Math.floor((t-o[0])/s+c),u=Math.floor((e-o[1])/s+h),_=l/a[0],d=u/a[1];return n?(_=Math.ceil(_)-1,d=Math.ceil(d)-1):(_=Math.floor(_),d=Math.floor(d)),p(i,_,d,r)},B.prototype.getTileCoordForCoordAndZ=function(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)},B.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},B.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},B.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:null},B.prototype.getZForResolution=function(t,e){var i=Object(U.e)(this.resolutions_,t,e||0);return Object(b.a)(i,this.minZoom,this.maxZoom)},B.prototype.calculateTileRanges_=function(t){for(var e=this.resolutions_.length,i=new Array(e),n=this.minZoom;n<e;++n)i[n]=this.getTileRangeForExtentAndZ(t,n);this.fullTileRanges_=i};var W=B;function z(t){var e=t.getDefaultTileGrid();return e||(e=function(t,e,i,n){return function(t,e,i,n){var r=A.a.TOP_LEFT,o=G(t,void 0,i);return new W({extent:t,origin:Object(y.x)(t,r),resolutions:o,tileSize:i})}(K(t),0,void 0)}(t),t.setDefaultTileGrid(e)),e}function G(t,e,i){for(var n=void 0!==e?e:S.a,r=Object(y.z)(t),o=Object(y.D)(t),s=Object(D.c)(void 0!==i?i:S.b),a=Math.max(o/s[0],r/s[1]),c=n+1,h=new Array(c),l=0;l<c;++l)h[l]=a/Math.pow(2,l);return h}function K(t){var e=(t=Object(m.get)(t)).getExtent();if(!e){var i=180*k.a[k.b.DEGREES]/t.getMetersPerUnit();e=Object(y.j)(-i,-i,i,i)}return e}var H=function(t){function e(e){t.call(this,{attributions:e.attributions,extent:e.extent,projection:e.projection,state:e.state,wrapX:e.wrapX}),this.opaque_=void 0!==e.opaque&&e.opaque,this.tilePixelRatio_=void 0!==e.tilePixelRatio?e.tilePixelRatio:1,this.tileGrid=void 0!==e.tileGrid?e.tileGrid:null,this.tileCache=new v(e.cacheSize),this.tmpSize=[0,0],this.key_="",this.tileOptions={transition:e.transition}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},e.prototype.expireCache=function(t,e){var i=this.getTileCacheForProjection(t);i&&i.expireCache(e)},e.prototype.forEachLoadedTile=function(t,e,i,n){var r=this.getTileCacheForProjection(t);if(!r)return!1;for(var s,a,c,h=!0,l=i.minX;l<=i.maxX;++l)for(var u=i.minY;u<=i.maxY;++u)a=f(e,l,u),c=!1,r.containsKey(a)&&(c=(s=r.get(a)).getState()===o.a.LOADED)&&(c=!1!==n(s)),c||(h=!1);return h},e.prototype.getGutter=function(t){return 0},e.prototype.getKey=function(){return this.key_},e.prototype.setKey=function(t){this.key_!==t&&(this.key_=t,this.changed())},e.prototype.getOpaque=function(t){return this.opaque_},e.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},e.prototype.getTile=function(t,e,i,n,r){},e.prototype.getTileGrid=function(){return this.tileGrid},e.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:z(t)},e.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();return e&&!Object(m.equivalent)(e,t)?null:this.tileCache},e.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_},e.prototype.getTilePixelSize=function(t,e,i){var n=this.getTileGridForProjection(i),r=this.getTilePixelRatio(e),o=Object(D.c)(n.getTileSize(t),this.tmpSize);return 1==r?o:Object(D.b)(o,r,this.tmpSize)},e.prototype.getTileCoordForTileUrlFunction=function(t,e){var i=void 0!==e?e:this.getProjection(),n=this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(t=function(t,e,i){var n=e[0],r=t.getTileCoordCenter(e),o=K(i);if(Object(y.f)(o,r))return e;var s=Object(y.D)(o),a=Math.ceil((o[0]-r[0])/s);return r[0]+=s*a,t.getTileCoordForCoordAndZ(r,n)}(n,t,i)),function(t,e){var i=t[0],n=t[1],r=t[2];if(e.getMinZoom()>i||i>e.getMaxZoom())return!1;var o,s=e.getExtent();return!(o=s?e.getTileRangeForExtentAndZ(s,i):e.getFullTileRange(i))||o.containsXY(n,r)}(t,n)?t:null},e.prototype.refresh=function(){this.tileCache.clear(),this.changed()},e}(L.a);H.prototype.useTile=P.c;var Y=function(t){function e(e,i){t.call(this,e),this.tile=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(I.a),V=function(t){function e(e){t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,extent:e.extent,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition}),this.tileLoadFunction=e.tileLoadFunction,this.tileUrlFunction=this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):M,this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),e.tileUrlFunction&&this.setTileUrlFunction(e.tileUrlFunction),this.tileLoadingKeys_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},e.prototype.getTileUrlFunction=function(){return this.tileUrlFunction},e.prototype.getUrls=function(){return this.urls},e.prototype.handleTileChange=function(t){var e,i=t.target,n=Object(r.b)(i),s=i.getState();s==o.a.LOADING?(this.tileLoadingKeys_[n]=!0,e="tileloadstart"):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],e=s==o.a.ERROR?"tileloaderror":s==o.a.LOADED||s==o.a.ABORT?"tileloadend":void 0),void 0!=e&&this.dispatchEvent(new Y(e,i))},e.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},e.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()},e.prototype.setUrl=function(t){var e=this.urls=function(t){var e=[],i=/\{([a-z])-([a-z])\}/.exec(t);if(i){var n,r=i[1].charCodeAt(0),o=i[2].charCodeAt(0);for(n=r;n<=o;++n)e.push(t.replace(i[0],String.fromCharCode(n)));return e}if(i=i=/\{(\d+)-(\d+)\}/.exec(t)){for(var s=parseInt(i[2],10),a=parseInt(i[1],10);a<=s;a++)e.push(t.replace(i[0],a.toString()));return e}return e.push(t),e}(t);this.setTileUrlFunction(this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):R(e,this.tileGrid),t)},e.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");this.setTileUrlFunction(this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):R(t,this.tileGrid),e)},e.prototype.useTile=function(t,e,i){var n=f(t,e,i);this.tileCache.containsKey(n)&&this.tileCache.get(n)},e}(H);function X(t,e){t.getImage().src=e}V.prototype.fixedTileUrlFunction;var q=function(t){function e(e){var i=e||{},n=void 0!==i.projection?i.projection:"EPSG:3857",r=void 0!==i.tileGrid?i.tileGrid:function(t){var e={};return Object(j.a)(e,void 0!==t?t:{}),void 0===e.extent&&(e.extent=Object(m.get)("EPSG:3857").getExtent()),e.resolutions=G(e.extent,e.maxZoom,e.tileSize),delete e.maxZoom,new W(e)}({extent:K(n),maxZoom:i.maxZoom,minZoom:i.minZoom,tileSize:i.tileSize});t.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,opaque:i.opaque,projection:n,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileGrid:r,tileLoadFunction:i.tileLoadFunction,tilePixelRatio:i.tilePixelRatio,tileUrlFunction:i.tileUrlFunction,url:i.url,urls:i.urls,wrapX:void 0===i.wrapX||i.wrapX,transition:i.transition})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(function(t){function e(e){t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,extent:e.extent,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:X,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition}),this.crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null,this.tileClass=void 0!==e.tileClass?e.tileClass:d,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.canExpireCache=function(){if(!n.a)return t.prototype.canExpireCache.call(this);if(this.tileCache.canExpireCache())return!0;for(var e in this.tileCacheForProjection)if(this.tileCacheForProjection[e].canExpireCache())return!0;return!1},e.prototype.expireCache=function(e,i){if(n.a){var r=this.getTileCacheForProjection(e);for(var o in this.tileCache.expireCache(this.tileCache==r?i:{}),this.tileCacheForProjection){var s=this.tileCacheForProjection[o];s.expireCache(s==r?i:{})}}else t.prototype.expireCache.call(this,e,i)},e.prototype.getGutter=function(t){return n.a&&this.getProjection()&&t&&!Object(m.equivalent)(this.getProjection(),t)?0:this.getGutterInternal()},e.prototype.getGutterInternal=function(){return 0},e.prototype.getOpaque=function(e){return!(n.a&&this.getProjection()&&e&&!Object(m.equivalent)(this.getProjection(),e))&&t.prototype.getOpaque.call(this,e)},e.prototype.getTileGridForProjection=function(e){if(!n.a)return t.prototype.getTileGridForProjection.call(this,e);var i=this.getProjection();if(!this.tileGrid||i&&!Object(m.equivalent)(i,e)){var o=Object(r.b)(e).toString();return o in this.tileGridForProjection||(this.tileGridForProjection[o]=z(e)),this.tileGridForProjection[o]}return this.tileGrid},e.prototype.getTileCacheForProjection=function(e){if(!n.a)return t.prototype.getTileCacheForProjection.call(this,e);var i=this.getProjection();if(!i||Object(m.equivalent)(i,e))return this.tileCache;var o=Object(r.b)(e).toString();return o in this.tileCacheForProjection||(this.tileCacheForProjection[o]=new v(this.tileCache.highWaterMark)),this.tileCacheForProjection[o]},e.prototype.createTile_=function(t,e,i,n,r,s){var a=[t,e,i],h=this.getTileCoordForTileUrlFunction(a,r),l=h?this.tileUrlFunction(h,n,r):void 0,_=new this.tileClass(a,void 0!==l?o.a.IDLE:o.a.EMPTY,void 0!==l?l:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return _.key=s,Object(u.a)(_,c.a.CHANGE,this.handleTileChange,this),_},e.prototype.getTile=function(t,e,i,r,o){var s=this.getProjection();if(n.a&&s&&o&&!Object(m.equivalent)(s,o)){var a,c=this.getTileCacheForProjection(o),h=[t,e,i],l=g(h);c.containsKey(l)&&(a=c.get(l));var u=this.getKey();if(a&&a.key==u)return a;var _=this.getTileGridForProjection(s),d=this.getTileGridForProjection(o),p=this.getTileCoordForTileUrlFunction(h,o),f=new C(s,_,o,d,h,p,this.getTilePixelRatio(r),this.getGutterInternal(),function(t,e,i,n){return this.getTileInternal(t,e,i,n,s)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_);return f.key=u,a?(f.interimTile=a,f.refreshInterimChain(),c.replace(l,f)):c.set(l,f),f}return this.getTileInternal(t,e,i,r,s||o)},e.prototype.getTileInternal=function(t,e,i,n,r){var s=null,a=f(t,e,i),c=this.getKey();if(this.tileCache.containsKey(a)){if((s=this.tileCache.get(a)).key!=c){var h=s;s=this.createTile_(t,e,i,n,r,c),h.getState()==o.a.IDLE?s.interimTile=h.interimTile:s.interimTile=h,s.refreshInterimChain(),this.tileCache.replace(a,s)}}else s=this.createTile_(t,e,i,n,r,c),this.tileCache.set(a,s);return s},e.prototype.setRenderReprojectionEdges=function(t){if(n.a&&this.renderReprojectionEdges_!=t){for(var e in this.renderReprojectionEdges_=t,this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}},e.prototype.setTileGridForProjection=function(t,e){if(n.a){var i=Object(m.get)(t);if(i){var o=Object(r.b)(i).toString();o in this.tileGridForProjection||(this.tileGridForProjection[o]=e)}}},e}(V)),Z='&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.',$=(function(t){function e(e){var i,n=e||{};i=void 0!==n.attributions?n.attributions:[Z];var r=void 0!==n.crossOrigin?n.crossOrigin:"anonymous",o=void 0!==n.url?n.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";t.call(this,{attributions:i,cacheSize:n.cacheSize,crossOrigin:r,opaque:void 0===n.opaque||n.opaque,maxZoom:void 0!==n.maxZoom?n.maxZoom:19,reprojectionErrorThreshold:n.reprojectionErrorThreshold,tileLoadFunction:n.tileLoadFunction,url:o,wrapX:n.wrapX})}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e}(q),['Map tiles by <a href="https://stamen.com/">Stamen Design</a>, under <a href="https://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.',Z]),J={terrain:{extension:"jpg",opaque:!0},"terrain-background":{extension:"jpg",opaque:!0},"terrain-labels":{extension:"png",opaque:!1},"terrain-lines":{extension:"png",opaque:!1},"toner-background":{extension:"png",opaque:!0},toner:{extension:"png",opaque:!0},"toner-hybrid":{extension:"png",opaque:!1},"toner-labels":{extension:"png",opaque:!1},"toner-lines":{extension:"png",opaque:!1},"toner-lite":{extension:"png",opaque:!0},watercolor:{extension:"jpg",opaque:!0}},Q={terrain:{minZoom:4,maxZoom:18},toner:{minZoom:0,maxZoom:20},watercolor:{minZoom:1,maxZoom:16}},tt=function(t){function e(e){var i=e.layer.indexOf("-"),n=-1==i?e.layer:e.layer.slice(0,i),r=Q[n],o=J[e.layer],s=void 0!==e.url?e.url:"https://stamen-tiles-{a-d}.a.ssl.fastly.net/"+e.layer+"/{z}/{x}/{y}."+o.extension;t.call(this,{attributions:$,cacheSize:e.cacheSize,crossOrigin:"anonymous",maxZoom:void 0!=e.maxZoom?e.maxZoom:r.maxZoom,minZoom:void 0!=e.minZoom?e.minZoom:r.minZoom,opaque:o.opaque,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,url:s,wrapX:e.wrapX})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(q);e.default=tt},function(t,e,i){"use strict";i.r(e);var n=i(3),r=i(23),o=i(25),s=i(36),a=i(13),c=i(11),h=i(1),l=i(17),u=i(4),_=i(2),d=i(9),p={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"};function f(t,e){return[[-1/0,-1/0,1/0,1/0]]}var g=i(10),v=i(62),m=i(33),y="addfeature",b="removefeature",E=i(47);i.d(e,"VectorSourceEvent",function(){return x});var x=function(t){function e(e,i){t.call(this,e),this.feature=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(l.a),O=function(t){function e(e){var i=e||{};t.call(this,{attributions:i.attributions,projection:void 0,state:m.a.READY,wrapX:void 0===i.wrapX||i.wrapX}),this.loader_=d.c,this.format_=i.format,this.overlaps_=void 0==i.overlaps||i.overlaps,this.url_=i.url,void 0!==i.loader?this.loader_=i.loader:void 0!==this.url_&&(Object(c.a)(this.format_,7),this.loader_=function(t,e){return function(t,e,i,n){return function(i,r,o){var s=new XMLHttpRequest;s.open("GET","function"==typeof t?t(i,r,o):t,!0),e.getType()==p.ARRAY_BUFFER&&(s.responseType="arraybuffer"),s.onload=function(t){if(!s.status||s.status>=200&&s.status<300){var i,r=e.getType();r==p.JSON||r==p.TEXT?i=s.responseText:r==p.XML?(i=s.responseXML)||(i=(new DOMParser).parseFromString(s.responseText,"application/xml")):r==p.ARRAY_BUFFER&&(i=s.response),i?function(t,e){this.addFeatures(t)}.call(this,e.readFeatures(i,{featureProjection:o}),e.readProjection(i),e.getLastExtent()):n.call(this)}else n.call(this)}.bind(this),s.onerror=function(){n.call(this)}.bind(this),s.send()}}(t,e,0,d.c)}(this.url_,this.format_)),this.strategy_=void 0!==i.strategy?i.strategy:f;var n,o,s=void 0===i.useSpatialIndex||i.useSpatialIndex;this.featuresRtree_=s?new E.a:null,this.loadedExtentsRtree_=new E.a,this.nullGeometryFeatures_={},this.idIndex_={},this.undefIdIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,i.features instanceof r.a?o=(n=i.features).getArray():Array.isArray(i.features)&&(o=i.features),s||void 0!==n||(n=new r.a(o)),void 0!==o&&this.addFeaturesInternal(o),void 0!==n&&this.bindFeaturesCollection_(n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(v.a);O.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},O.prototype.addFeatureInternal=function(t){var e=Object(n.b)(t).toString();if(this.addToIndex_(e,t)){this.setupChangeEvents_(e,t);var i=t.getGeometry();if(i){var r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new x(y,t))}},O.prototype.setupChangeEvents_=function(t,e){this.featureChangeKeys_[t]=[Object(h.a)(e,u.a.CHANGE,this.handleFeatureChange_,this),Object(h.a)(e,s.a.PROPERTYCHANGE,this.handleFeatureChange_,this)]},O.prototype.addToIndex_=function(t,e){var i=!0,n=e.getId();return void 0!==n?n.toString()in this.idIndex_?i=!1:this.idIndex_[n.toString()]=e:(Object(c.a)(!(t in this.undefIdIndex_),30),this.undefIdIndex_[t]=e),i},O.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},O.prototype.addFeaturesInternal=function(t){for(var e=[],i=[],r=[],o=0,s=t.length;o<s;o++){var a=t[o],c=Object(n.b)(a).toString();this.addToIndex_(c,a)&&i.push(a)}for(var h=0,l=i.length;h<l;h++){var u=i[h],_=Object(n.b)(u).toString();this.setupChangeEvents_(_,u);var d=u.getGeometry();if(d){var p=d.getExtent();e.push(p),r.push(u)}else this.nullGeometryFeatures_[_]=u}this.featuresRtree_&&this.featuresRtree_.load(e,r);for(var f=0,g=i.length;f<g;f++)this.dispatchEvent(new x(y,i[f]))},O.prototype.bindFeaturesCollection_=function(t){var e=!1;Object(h.a)(this,y,function(i){e||(e=!0,t.push(i.feature),e=!1)}),Object(h.a)(this,b,function(i){e||(e=!0,t.remove(i.feature),e=!1)}),Object(h.a)(t,o.a.ADD,function(t){e||(e=!0,this.addFeature(t.element),e=!1)},this),Object(h.a)(t,o.a.REMOVE,function(t){e||(e=!0,this.removeFeature(t.element),e=!1)},this),this.featuresCollection_=t},O.prototype.clear=function(t){if(t){for(var e in this.featureChangeKeys_)this.featureChangeKeys_[e].forEach(h.e);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.undefIdIndex_={})}else if(this.featuresRtree_)for(var i in this.featuresRtree_.forEach(this.removeFeatureInternal,this),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.loadedExtentsRtree_.clear(),this.nullGeometryFeatures_={};var n=new x("clear");this.dispatchEvent(n),this.changed()},O.prototype.forEachFeature=function(t){return this.featuresRtree_?this.featuresRtree_.forEach(t):this.featuresCollection_?this.featuresCollection_.forEach(t):void 0},O.prototype.forEachFeatureAtCoordinateDirect=function(t,e){var i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,function(i){return i.getGeometry().intersectsCoordinate(t)?e(i):void 0})},O.prototype.forEachFeatureInExtent=function(t,e){return this.featuresRtree_?this.featuresRtree_.forEachInExtent(t,e):this.featuresCollection_?this.featuresCollection_.forEach(e):void 0},O.prototype.forEachFeatureIntersectingExtent=function(t,e){return this.forEachFeatureInExtent(t,function(i){if(i.getGeometry().intersectsExtent(t)){var n=e(i);if(n)return n}})},O.prototype.getFeaturesCollection=function(){return this.featuresCollection_},O.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray():this.featuresRtree_&&(t=this.featuresRtree_.getAll(),Object(g.d)(this.nullGeometryFeatures_)||Object(a.b)(t,Object(g.c)(this.nullGeometryFeatures_))),t},O.prototype.getFeaturesAtCoordinate=function(t){var e=[];return this.forEachFeatureAtCoordinateDirect(t,function(t){e.push(t)}),e},O.prototype.getFeaturesInExtent=function(t){return this.featuresRtree_.getInExtent(t)},O.prototype.getClosestFeatureToCoordinate=function(t,e){var i=t[0],n=t[1],r=null,o=[NaN,NaN],s=1/0,a=[-1/0,-1/0,1/0,1/0],c=e||d.b;return this.featuresRtree_.forEachInExtent(a,function(t){if(c(t)){var e=t.getGeometry(),h=s;if((s=e.closestPointXY(i,n,o,s))<h){r=t;var l=Math.sqrt(s);a[0]=i-l,a[1]=n-l,a[2]=i+l,a[3]=n+l}}}),r},O.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},O.prototype.getFeatureById=function(t){var e=this.idIndex_[t.toString()];return void 0!==e?e:null},O.prototype.getFormat=function(){return this.format_},O.prototype.getOverlaps=function(){return this.overlaps_},O.prototype.getResolutions=function(){},O.prototype.getUrl=function(){return this.url_},O.prototype.handleFeatureChange_=function(t){var e=t.target,i=Object(n.b)(e).toString(),r=e.getGeometry();if(r){var o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,e)):this.featuresRtree_&&this.featuresRtree_.update(o,e)}else i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);var s=e.getId();if(void 0!==s){var a=s.toString();i in this.undefIdIndex_?(delete this.undefIdIndex_[i],this.idIndex_[a]=e):this.idIndex_[a]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[a]=e)}else i in this.undefIdIndex_||(this.removeFromIdIndex_(e),this.undefIdIndex_[i]=e);this.changed(),this.dispatchEvent(new x("changefeature",e))},O.prototype.hasFeature=function(t){var e=t.getId();return void 0!==e?e in this.idIndex_:Object(n.b)(t).toString()in this.undefIdIndex_},O.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&Object(g.d)(this.nullGeometryFeatures_)},O.prototype.loadFeatures=function(t,e,i){for(var n=this,r=this.loadedExtentsRtree_,o=this.strategy_(t,e),s=function(t,s){var a=o[t];r.forEachInExtent(a,function(t){return Object(_.g)(t.extent,a)})||(n.loader_.call(n,a,e,i),r.insert(a,{extent:a.slice()}))},a=0,c=o.length;a<c;++a)s(a)},O.prototype.removeLoadedExtent=function(t){var e,i=this.loadedExtentsRtree_;i.forEachInExtent(t,function(i){if(Object(_.o)(i.extent,t))return e=i,!0}),e&&i.remove(e)},O.prototype.removeFeature=function(t){var e=Object(n.b)(t).toString();e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t),this.changed()},O.prototype.removeFeatureInternal=function(t){var e=Object(n.b)(t).toString();this.featureChangeKeys_[e].forEach(h.e),delete this.featureChangeKeys_[e];var i=t.getId();void 0!==i?delete this.idIndex_[i.toString()]:delete this.undefIdIndex_[e],this.dispatchEvent(new x(b,t))},O.prototype.removeFromIdIndex_=function(t){var e=!1;for(var i in this.idIndex_)if(this.idIndex_[i]===t){delete this.idIndex_[i],e=!0;break}return e},O.prototype.setLoader=function(t){this.loader_=t},e.default=O},function(t,e,i){"use strict";i.r(e);var n=i(3),r=i(19),o=i(11),s=i(28),a=i(1),c=i(4),h={FRACTION:"fraction",PIXELS:"pixels"},l=i(14),u=i(32),_=i(55),d=function(t){function e(e,i,n,o,s,a){t.call(this),this.hitDetectionImage_=null,this.image_=e||new Image,null!==o&&(this.image_.crossOrigin=o),this.canvas_=a?document.createElement("CANVAS"):null,this.color_=a,this.imageListenerKeys_=null,this.imageState_=s,this.size_=n,this.src_=i,this.tainting_=!1,this.imageState_==r.a.LOADED&&this.determineTainting_()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.determineTainting_=function(){var t=Object(l.a)(1,1);try{t.drawImage(this.image_,0,0),t.getImageData(0,0,1,1)}catch(t){this.tainting_=!0}},e.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(c.a.CHANGE)},e.prototype.handleImageError_=function(){this.imageState_=r.a.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.handleImageLoad_=function(){this.imageState_=r.a.LOADED,this.size_&&(this.image_.width=this.size_[0],this.image_.height=this.size_[1]),this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.determineTainting_(),this.replaceColor_(),this.dispatchChangeEvent_()},e.prototype.getImage=function(t){return this.canvas_?this.canvas_:this.image_},e.prototype.getImageState=function(){return this.imageState_},e.prototype.getHitDetectionImage=function(t){if(!this.hitDetectionImage_)if(this.tainting_){var e=this.size_[0],i=this.size_[1],n=Object(l.a)(e,i);n.fillRect(0,0,e,i),this.hitDetectionImage_=n.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},e.prototype.getSize=function(){return this.size_},e.prototype.getSrc=function(){return this.src_},e.prototype.load=function(){if(this.imageState_==r.a.IDLE){this.imageState_=r.a.LOADING,this.imageListenerKeys_=[Object(a.b)(this.image_,c.a.ERROR,this.handleImageError_,this),Object(a.b)(this.image_,c.a.LOAD,this.handleImageLoad_,this)];try{this.image_.src=this.src_}catch(t){this.handleImageError_()}}},e.prototype.replaceColor_=function(){if(!this.tainting_&&null!==this.color_){this.canvas_.width=this.image_.width,this.canvas_.height=this.image_.height;var t=this.canvas_.getContext("2d");t.drawImage(this.image_,0,0);for(var e=t.getImageData(0,0,this.image_.width,this.image_.height),i=e.data,n=this.color_[0]/255,r=this.color_[1]/255,o=this.color_[2]/255,s=0,a=i.length;s<a;s+=4)i[s]*=n,i[s+1]*=r,i[s+2]*=o;t.putImageData(e,0,0)}},e.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(a.e),this.imageListenerKeys_=null},e}(u.a),p={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},f=function(t){function e(e){var i=e||{},a=void 0!==i.opacity?i.opacity:1,c=void 0!==i.rotation?i.rotation:0,l=void 0!==i.scale?i.scale:1,u=void 0!==i.rotateWithView&&i.rotateWithView,f=void 0===i.snapToPixel||i.snapToPixel;t.call(this,{opacity:a,rotation:c,scale:l,snapToPixel:f,rotateWithView:u}),this.anchor_=void 0!==i.anchor?i.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=void 0!==i.anchorOrigin?i.anchorOrigin:p.TOP_LEFT,this.anchorXUnits_=void 0!==i.anchorXUnits?i.anchorXUnits:h.FRACTION,this.anchorYUnits_=void 0!==i.anchorYUnits?i.anchorYUnits:h.FRACTION,this.crossOrigin_=void 0!==i.crossOrigin?i.crossOrigin:null;var g=void 0!==i.img?i.img:null,v=void 0!==i.imgSize?i.imgSize:null,m=i.src;Object(o.a)(!(void 0!==m&&g),4),Object(o.a)(!g||g&&v,5),void 0!==m&&0!==m.length||!g||(m=g.src||Object(n.b)(g).toString()),Object(o.a)(void 0!==m&&m.length>0,6);var y=void 0!==i.src?r.a.IDLE:r.a.LOADED;this.color_=void 0!==i.color?Object(s.a)(i.color):null,this.iconImage_=function(t,e,i,n,r,o){var s=_.a.get(e,n,o);return s||(s=new d(t,e,i,n,r,o),_.a.set(e,n,o,s)),s}(g,m,v,this.crossOrigin_,y,this.color_),this.offset_=void 0!==i.offset?i.offset:[0,0],this.offsetOrigin_=void 0!==i.offsetOrigin?i.offsetOrigin:p.TOP_LEFT,this.origin_=null,this.size_=void 0!==i.size?i.size:null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:this.getScale(),snapToPixel:this.getSnapToPixel(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},e.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var t=this.anchor_,e=this.getSize();if(this.anchorXUnits_==h.FRACTION||this.anchorYUnits_==h.FRACTION){if(!e)return null;t=this.anchor_.slice(),this.anchorXUnits_==h.FRACTION&&(t[0]*=e[0]),this.anchorYUnits_==h.FRACTION&&(t[1]*=e[1])}if(this.anchorOrigin_!=p.TOP_LEFT){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),this.anchorOrigin_!=p.TOP_RIGHT&&this.anchorOrigin_!=p.BOTTOM_RIGHT||(t[0]=-t[0]+e[0]),this.anchorOrigin_!=p.BOTTOM_LEFT&&this.anchorOrigin_!=p.BOTTOM_RIGHT||(t[1]=-t[1]+e[1])}return this.normalizedAnchor_=t,this.normalizedAnchor_},e.prototype.setAnchor=function(t){this.anchor_=t,this.normalizedAnchor_=null},e.prototype.getColor=function(){return this.color_},e.prototype.getImage=function(t){return this.iconImage_.getImage(t)},e.prototype.getImageSize=function(){return this.iconImage_.getSize()},e.prototype.getHitDetectionImageSize=function(){return this.getImageSize()},e.prototype.getImageState=function(){return this.iconImage_.getImageState()},e.prototype.getHitDetectionImage=function(t){return this.iconImage_.getHitDetectionImage(t)},e.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var t=this.offset_;if(this.offsetOrigin_!=p.TOP_LEFT){var e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),this.offsetOrigin_!=p.TOP_RIGHT&&this.offsetOrigin_!=p.BOTTOM_RIGHT||(t[0]=i[0]-e[0]-t[0]),this.offsetOrigin_!=p.BOTTOM_LEFT&&this.offsetOrigin_!=p.BOTTOM_RIGHT||(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_},e.prototype.getSrc=function(){return this.iconImage_.getSrc()},e.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},e.prototype.listenImageChange=function(t,e){return Object(a.a)(this.iconImage_,c.a.CHANGE,t,e)},e.prototype.load=function(){this.iconImage_.load()},e.prototype.unlistenImageChange=function(t,e){Object(a.c)(this.iconImage_,c.a.CHANGE,t,e)},e}(i(60).a);e.default=f},function(t,e,i){"use strict";i.r(e);var n=i(35),r=i(31),o="preload",s="useInterimTilesOnError",a=i(10),c=function(t){function e(e){var i=e||{},r=Object(a.a)({},i);delete r.preload,delete r.useInterimTilesOnError,t.call(this,r),this.setPreload(void 0!==i.preload?i.preload:0),this.setUseInterimTilesOnError(void 0===i.useInterimTilesOnError||i.useInterimTilesOnError),this.type=n.a.TILE}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getPreload=function(){return this.get(o)},e.prototype.setPreload=function(t){this.set(o,t)},e.prototype.getUseInterimTilesOnError=function(){return this.get(s)},e.prototype.setUseInterimTilesOnError=function(t){this.set(s,t)},e}(r.a);c.prototype.getSource,e.default=c},function(t,e,i){"use strict";i.r(e);var n=i(35),r=i(31),o={IMAGE:"image",VECTOR:"vector"},s=i(10),a=i(52);i.d(e,"RenderType",function(){return c});var c={IMAGE:"image",VECTOR:"vector"},h="renderOrder",l=function(t){function e(e){var i=e||{},r=Object(s.a)({},i);delete r.style,delete r.renderBuffer,delete r.updateWhileAnimating,delete r.updateWhileInteracting,t.call(this,r),this.declutter_=void 0!==i.declutter&&i.declutter,this.renderBuffer_=void 0!==i.renderBuffer?i.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(i.style),this.updateWhileAnimating_=void 0!==i.updateWhileAnimating&&i.updateWhileAnimating,this.updateWhileInteracting_=void 0!==i.updateWhileInteracting&&i.updateWhileInteracting,this.renderMode_=i.renderMode||o.VECTOR,this.type=n.a.VECTOR}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.setDeclutter=function(t){this.declutter_=t},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(h)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.setRenderOrder=function(t){this.set(h,t)},e.prototype.setStyle=function(t){this.style_=void 0!==t?t:a.createDefaultStyle,this.styleFunction_=null===t?void 0:Object(a.toFunction)(this.style_),this.changed()},e.prototype.getRenderMode=function(){return this.renderMode_},e}(r.a);l.prototype.getSource,e.default=l},function(t,e,i){"use strict";i.r(e);var n=i(42),r=i(12),o={BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right",CENTER_LEFT:"center-left",CENTER_CENTER:"center-center",CENTER_RIGHT:"center-right",TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right"},s=i(22),a=i(14),c=i(1),h=i(2),l={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"},u=function(t){function e(e){t.call(this),this.options=e,this.id=e.id,this.insertFirst=void 0===e.insertFirst||e.insertFirst,this.stopEvent=void 0===e.stopEvent||e.stopEvent,this.element=document.createElement("DIV"),this.element.className=void 0!==e.className?e.className:"ol-overlay-container "+s.d,this.element.style.position="absolute",this.autoPan=void 0!==e.autoPan&&e.autoPan,this.autoPanAnimation=e.autoPanAnimation||{},this.autoPanMargin=void 0!==e.autoPanMargin?e.autoPanMargin:20,this.rendered={bottom_:"",left_:"",right_:"",top_:"",visible:!0},this.mapPostrenderListenerKey=null,Object(c.a)(this,Object(r.b)(l.ELEMENT),this.handleElementChanged,this),Object(c.a)(this,Object(r.b)(l.MAP),this.handleMapChanged,this),Object(c.a)(this,Object(r.b)(l.OFFSET),this.handleOffsetChanged,this),Object(c.a)(this,Object(r.b)(l.POSITION),this.handlePositionChanged,this),Object(c.a)(this,Object(r.b)(l.POSITIONING),this.handlePositioningChanged,this),void 0!==e.element&&this.setElement(e.element),this.setOffset(void 0!==e.offset?e.offset:[0,0]),this.setPositioning(void 0!==e.positioning?e.positioning:o.TOP_LEFT),void 0!==e.position&&this.setPosition(e.position)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getElement=function(){return this.get(l.ELEMENT)},e.prototype.getId=function(){return this.id},e.prototype.getMap=function(){return this.get(l.MAP)},e.prototype.getOffset=function(){return this.get(l.OFFSET)},e.prototype.getPosition=function(){return this.get(l.POSITION)},e.prototype.getPositioning=function(){return this.get(l.POSITIONING)},e.prototype.handleElementChanged=function(){Object(a.d)(this.element);var t=this.getElement();t&&this.element.appendChild(t)},e.prototype.handleMapChanged=function(){this.mapPostrenderListenerKey&&(Object(a.e)(this.element),Object(c.e)(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var t=this.getMap();if(t){this.mapPostrenderListenerKey=Object(c.a)(t,n.a.POSTRENDER,this.render,this),this.updatePixelPosition();var e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element)}},e.prototype.render=function(){this.updatePixelPosition()},e.prototype.handleOffsetChanged=function(){this.updatePixelPosition()},e.prototype.handlePositionChanged=function(){this.updatePixelPosition(),this.get(l.POSITION)&&this.autoPan&&this.panIntoView()},e.prototype.handlePositioningChanged=function(){this.updatePixelPosition()},e.prototype.setElement=function(t){this.set(l.ELEMENT,t)},e.prototype.setMap=function(t){this.set(l.MAP,t)},e.prototype.setOffset=function(t){this.set(l.OFFSET,t)},e.prototype.setPosition=function(t){this.set(l.POSITION,t)},e.prototype.panIntoView=function(){var t=this.getMap();if(t&&t.getTargetElement()){var e=this.getRect(t.getTargetElement(),t.getSize()),i=this.getElement(),n=this.getRect(i,[Object(a.c)(i),Object(a.b)(i)]),r=this.autoPanMargin;if(!Object(h.g)(e,n)){var o=n[0]-e[0],s=e[2]-n[2],c=n[1]-e[1],l=e[3]-n[3],u=[0,0];if(o<0?u[0]=o-r:s<0&&(u[0]=Math.abs(s)+r),c<0?u[1]=c-r:l<0&&(u[1]=Math.abs(l)+r),0!==u[0]||0!==u[1]){var _=t.getView().getCenter(),d=t.getPixelFromCoordinate(_),p=[d[0]+u[0],d[1]+u[1]];t.getView().animate({center:t.getCoordinateFromPixel(p),duration:this.autoPanAnimation.duration,easing:this.autoPanAnimation.easing})}}}},e.prototype.getRect=function(t,e){var i=t.getBoundingClientRect(),n=i.left+window.pageXOffset,r=i.top+window.pageYOffset;return[n,r,n+e[0],r+e[1]]},e.prototype.setPositioning=function(t){this.set(l.POSITIONING,t)},e.prototype.setVisible=function(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)},e.prototype.updatePixelPosition=function(){var t=this.getMap(),e=this.getPosition();if(t&&t.isRendered()&&e){var i=t.getPixelFromCoordinate(e),n=t.getSize();this.updateRenderedPosition(i,n)}else this.setVisible(!1)},e.prototype.updateRenderedPosition=function(t,e){var i=this.element.style,n=this.getOffset(),r=this.getPositioning();this.setVisible(!0);var s=n[0],a=n[1];if(r==o.BOTTOM_RIGHT||r==o.CENTER_RIGHT||r==o.TOP_RIGHT){""!==this.rendered.left_&&(this.rendered.left_=i.left="");var c=Math.round(e[0]-t[0]-s)+"px";this.rendered.right_!=c&&(this.rendered.right_=i.right=c)}else{""!==this.rendered.right_&&(this.rendered.right_=i.right=""),r!=o.BOTTOM_CENTER&&r!=o.CENTER_CENTER&&r!=o.TOP_CENTER||(s-=this.element.offsetWidth/2);var h=Math.round(t[0]+s)+"px";this.rendered.left_!=h&&(this.rendered.left_=i.left=h)}if(r==o.BOTTOM_LEFT||r==o.BOTTOM_CENTER||r==o.BOTTOM_RIGHT){""!==this.rendered.top_&&(this.rendered.top_=i.top="");var l=Math.round(e[1]-t[1]-a)+"px";this.rendered.bottom_!=l&&(this.rendered.bottom_=i.bottom=l)}else{""!==this.rendered.bottom_&&(this.rendered.bottom_=i.bottom=""),r!=o.CENTER_LEFT&&r!=o.CENTER_CENTER&&r!=o.CENTER_RIGHT||(a-=this.element.offsetHeight/2);var u=Math.round(t[1]+a)+"px";this.rendered.top_!=u&&(this.rendered.top_=i.top=u)}},e.prototype.getOptions=function(){return this.options},e}(r.a);e.default=u}])},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(1),r=i(3),o=i(18),s=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],a=r.default("div")`
	background: rgb(0, 0, 0);
	border-bottom: 2px solid ${o.gray(.25)};
	border-top: 2px solid ${o.gray(.25)};
	display: grid;
	grid-template-columns: 30% 40% 30%;
`,c=r.default("select")`
	background: none;
	border-radius: 4px;
	border: 2px solid ${o.gray(.25)};
	color: white;
	height: 24px;
	outline: none;

	& option {
		color: #444;
	}
`,h=r.default("div")`
	align-items: center;
	display: grid;
	grid-gap: 1em;
	padding: 0 1em;
`,l=r.default(h)`
	grid-template-columns: 24px 24px 24px 72px;
`,u=r.default(h)`
	justify-content: center;
	grid-template-columns: 24px 24px 72px;
`,_=r.default(h)`
	justify-content: right;
	grid-template-columns: auto auto auto;
`;e.default=class extends n.PureComponent{constructor(){super(...arguments),this.playBackward=(()=>{this.props.timeline.animator.playBackward()}),this.playForward=(()=>{this.props.timeline.animator.playForward()})}render(){return null==this.props.timeline?n.createElement(a,null):n.createElement(a,null,n.createElement(l,null,n.createElement(o.default,{onClick:this.playBackward},""),n.createElement(o.default,{onClick:()=>this.props.timeline.animator.stop()},"II"),n.createElement(o.default,{onClick:this.playForward},""),n.createElement(c,{defaultValue:"1",onChange:t=>this.props.timeline.animator.speed(t.target.value)},this.props.timeline.animator.multipliers.map(t=>n.createElement("option",{key:t,value:t},`${t}x`)))),n.createElement(u,null,n.createElement(o.default,{onClick:this.props.zoomIn},"+"),n.createElement(o.default,{onClick:this.props.zoomOut},"-"),n.createElement(c,{onChange:t=>this.props.timeline.animator.zoomTo(this.props.controlBand,parseInt(t.target.value,10)),value:this.props.zoomLevel.toString()},s.map(t=>n.createElement("option",{key:t,value:t},`lvl ${t}`)))),n.createElement(_,null,n.createElement(o.default,{onClick:this.props.showBoth},"m/t"),n.createElement(o.default,{onClick:this.props.showMap},"M"),n.createElement(o.default,{onClick:this.props.showTimeline},"T")))}}},function(t,e){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){"use strict";var n=i(17);function r(){}t.exports=function(){function t(t,e,i,r,o,s){if(s!==n){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function e(){return t}t.isRequired=t;var i={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e};return i.checkPropTypes=r,i.PropTypes=i,i}},function(t,e,i){"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(3);function r(t){const e=255*t;return`rgb(${e}, ${e}, ${e})`}e.gray=r,e.default=n.default("button")`
	background: none;
	border-radius: 4px;
	border: 2px solid ${r(.25)};
	color: white;
	cursor: pointer;
	height: 24px; 
	outline: none;
`},function(module,exports,__webpack_require__){!function(t,e){module.exports=e()}(0,function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/build/",i(i.s="./src/index.ts")}({"./src/animator.ts":
/*!*************************!*\
  !*** ./src/animator.ts ***!
  \*************************/
/*! exports provided: Animator, default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Animator", function() { return Animator; });\n/* harmony import */ var _models_props__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./models/props */ "./src/models/props.ts");\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./constants */ "./src/constants.ts");\n\n\nvar Direction;\n(function (Direction) {\n    Direction[Direction["Backward"] = -1] = "Backward";\n    Direction[Direction["Stop"] = 0] = "Stop";\n    Direction[Direction["Forward"] = 1] = "Forward";\n})(Direction || (Direction = {}));\nclass Animator {\n    constructor() {\n        this.elapsedTimeThreshold = 2000;\n        this.goToDuration = 300;\n        this.zoomToDuration = 300;\n        this.multipliers = [.25, .5, 1, 2, 4, 8, 16];\n        this.multiplier = 1;\n        this.direction = Direction.Stop;\n        this.elapsedTimeTotal = 0;\n        this.models = [];\n        this.views = [];\n        this.animate = (timestamp) => {\n            const elapsedTime = this.prevTimestamp == null ? 0 : timestamp - this.prevTimestamp;\n            if (elapsedTime > 0 || this.prevTimestamp == null) {\n                if (this.centerMarker == null && this.zoomMarker == null) {\n                    _models_props__WEBPACK_IMPORTED_MODULE_0__["default"].center += (_models_props__WEBPACK_IMPORTED_MODULE_0__["default"].eventsBands[0].time / 7.5) * this.multiplier * this.direction;\n                }\n                else if (this.centerMarker != null) {\n                    const timeRemaining = this.goToDuration - this.elapsedTimeTotal;\n                    const centerDelta = Math.abs(this.centerMarker - _models_props__WEBPACK_IMPORTED_MODULE_0__["default"].center) / (timeRemaining / elapsedTime);\n                    if (timeRemaining < elapsedTime) {\n                        _models_props__WEBPACK_IMPORTED_MODULE_0__["default"].center = this.centerMarker;\n                        this.stop();\n                    }\n                    else\n                        _models_props__WEBPACK_IMPORTED_MODULE_0__["default"].center = _models_props__WEBPACK_IMPORTED_MODULE_0__["default"].center + (centerDelta * this.direction);\n                }\n                else if (this.zoomMarker != null) {\n                    const timeRemaining = this.zoomToDuration - this.elapsedTimeTotal;\n                    const zoomDelta = (this.zoomMarker - this.activeBand.zoomLevel) / (timeRemaining / elapsedTime);\n                    if (timeRemaining < elapsedTime) {\n                        this.activeBand.zoomLevel = this.zoomMarker;\n                        _models_props__WEBPACK_IMPORTED_MODULE_0__["default"].eventsBands.forEach(band => {\n                            if (band === this.activeBand)\n                                this.activeBand.zoomLevel = this.zoomMarker;\n                            else\n                                band.zoomLevel = this.zoomMarker + (band.config.zoomLevel - this.activeBand.config.zoomLevel);\n                        });\n                        this.adjustMinimapBands();\n                        document.dispatchEvent(new CustomEvent(_constants__WEBPACK_IMPORTED_MODULE_1__["ZOOM_DONE"]));\n                        this.stop();\n                    }\n                    else {\n                        for (const band of _models_props__WEBPACK_IMPORTED_MODULE_0__["default"].eventsBands) {\n                            band.zoomLevel = band.zoomLevel + zoomDelta;\n                        }\n                        this.adjustMinimapBands();\n                    }\n                }\n                this.models.forEach(model => model.update());\n                this.views.forEach(view => view.update());\n            }\n            this.elapsedTimeTotal += elapsedTime;\n            if (this.elapsedTimeTotal > this.elapsedTimeThreshold)\n                this.resetElapsedTimeTotal();\n            if (this.isPlaying() || this.zoomMarker != null) {\n                if ((_models_props__WEBPACK_IMPORTED_MODULE_0__["default"].center >= _models_props__WEBPACK_IMPORTED_MODULE_0__["default"].from && _models_props__WEBPACK_IMPORTED_MODULE_0__["default"].center <= _models_props__WEBPACK_IMPORTED_MODULE_0__["default"].to) || this.centerMarker != null || this.zoomMarker != null) {\n                    this.prevTimestamp = timestamp;\n                    requestAnimationFrame(this.animate);\n                }\n                else {\n                    this.stop();\n                }\n            }\n        };\n    }\n    registerModel(model) {\n        this.models.push(model);\n    }\n    registerView(view) {\n        this.views.push(view);\n    }\n    adjustMinimapBands() {\n        _models_props__WEBPACK_IMPORTED_MODULE_0__["default"].minimapBands.forEach(mmb => {\n            if (this.activeBand.zoomLevel < mmb.config.zoomLevel) {\n                mmb.zoomLevel = this.activeBand.zoomLevel;\n            }\n        });\n    }\n    resetElapsedTimeTotal() {\n        this.elapsedTimeTotal = 0;\n        document.dispatchEvent(new CustomEvent(_constants__WEBPACK_IMPORTED_MODULE_1__["CENTER_CHANGE_DONE"]));\n    }\n    accelerate() {\n        const index = this.multipliers.indexOf(this.multiplier);\n        if (index === this.multipliers.length - 1)\n            return this.multipliers[this.multipliers.length - 1];\n        this.multiplier = this.multipliers[index + 1];\n        return this.multiplier;\n    }\n    decelerate() {\n        const index = this.multipliers.indexOf(this.multiplier);\n        if (index === 0)\n            return this.multipliers[0];\n        this.multiplier = this.multipliers[index - 1];\n        return this.multiplier;\n    }\n    goTo(nextCenter) {\n        this.centerMarker = nextCenter;\n        if (nextCenter > _models_props__WEBPACK_IMPORTED_MODULE_0__["default"].center)\n            this.playForward();\n        else\n            this.playBackward();\n    }\n    zoomTo(band, nextZoomLevel) {\n        if (this.zoomMarker != null)\n            return;\n        if (nextZoomLevel < 0)\n            nextZoomLevel = 0;\n        if (band !== this.activeBand) {\n            this.stop();\n            this.activeBand = band;\n        }\n        if (this.activeBand.zoomLevel === nextZoomLevel)\n            return;\n        this.zoomMarker = nextZoomLevel;\n        this.nextFrame();\n    }\n    speed(multiplier) {\n        const multiplier2 = parseFloat(multiplier);\n        if (this.multipliers.indexOf(multiplier2) === -1)\n            return;\n        this.multiplier = multiplier2;\n    }\n    isPlaying() {\n        return this.direction !== Direction.Stop;\n    }\n    isPlayingForward() {\n        return this.direction === Direction.Forward;\n    }\n    isPlayingBackward() {\n        return this.direction === Direction.Backward;\n    }\n    nextFrame() {\n        requestAnimationFrame(this.animate);\n    }\n    playForward() {\n        this.direction = Direction.Forward;\n        this.nextFrame();\n    }\n    playBackward() {\n        this.direction = Direction.Backward;\n        this.nextFrame();\n    }\n    stop() {\n        this.direction = Direction.Stop;\n        this.activeBand = null;\n        this.centerMarker = null;\n        this.zoomMarker = null;\n        this.prevTimestamp = null;\n        this.elapsedTimeTotal = 0;\n    }\n    toggle() {\n        this.isPlaying() ? this.stop() : this.nextFrame();\n    }\n}\n/* harmony default export */ __webpack_exports__["default"] = (new Animator());\n\n\n//# sourceURL=webpack://Timeline/./src/animator.ts?')},"./src/api.ts":
/*!********************!*\
  !*** ./src/api.ts ***!
  \********************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Api; });\n/* harmony import */ var _animator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./animator */ "./src/animator.ts");\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./constants */ "./src/constants.ts");\n/* harmony import */ var _models_props__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./models/props */ "./src/models/props.ts");\n\n\n\nclass Api {\n    constructor(onChange) {\n        this.onChange = onChange;\n        this.animator = _animator__WEBPACK_IMPORTED_MODULE_0__["default"];\n        this.handleChange = () => {\n            this.onChange({\n                center: _models_props__WEBPACK_IMPORTED_MODULE_2__["default"].center,\n                bands: _models_props__WEBPACK_IMPORTED_MODULE_2__["default"].bands,\n            });\n        };\n        this.resize = () => {\n            _models_props__WEBPACK_IMPORTED_MODULE_2__["default"].resize();\n            for (const band of _models_props__WEBPACK_IMPORTED_MODULE_2__["default"].bands) {\n                band.resize();\n            }\n            for (const view of this.views) {\n                view.resize();\n            }\n            this.animator.nextFrame();\n        };\n        document.addEventListener(\'keydown\', (ev) => {\n            if (ev.keyCode === 189)\n                _models_props__WEBPACK_IMPORTED_MODULE_2__["default"].eventsBands[0].zoomOut();\n            if (ev.keyCode === 187)\n                _models_props__WEBPACK_IMPORTED_MODULE_2__["default"].eventsBands[0].zoomIn();\n        });\n        if (this.onChange != null && typeof this.onChange === \'function\') {\n            document.addEventListener(_constants__WEBPACK_IMPORTED_MODULE_1__["CENTER_CHANGE_DONE"], this.handleChange);\n            document.addEventListener(_constants__WEBPACK_IMPORTED_MODULE_1__["ZOOM_DONE"], this.handleChange);\n        }\n    }\n    reload() {\n        this.resize();\n    }\n}\n\n\n//# sourceURL=webpack://Timeline/./src/api.ts?')},"./src/constants.ts":
/*!**************************!*\
  !*** ./src/constants.ts ***!
  \**************************/
/*! exports provided: EVENT_HEIGHT, EVENT_ROW_HEIGHT, DATE_BAR_HEIGHT, RULER_LABELS_HEIGHT, CENTER_CHANGE_DONE, ZOOM_DONE, SCROLL_DONE, PIXELS_PER_LETTER, RawSegment, colors */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EVENT_HEIGHT", function() { return EVENT_HEIGHT; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EVENT_ROW_HEIGHT", function() { return EVENT_ROW_HEIGHT; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DATE_BAR_HEIGHT", function() { return DATE_BAR_HEIGHT; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RULER_LABELS_HEIGHT", function() { return RULER_LABELS_HEIGHT; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CENTER_CHANGE_DONE", function() { return CENTER_CHANGE_DONE; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ZOOM_DONE", function() { return ZOOM_DONE; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SCROLL_DONE", function() { return SCROLL_DONE; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PIXELS_PER_LETTER", function() { return PIXELS_PER_LETTER; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RawSegment", function() { return RawSegment; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "colors", function() { return colors; });\nconst EVENT_HEIGHT = 14;\nconst EVENT_ROW_HEIGHT = 16;\nconst DATE_BAR_HEIGHT = EVENT_ROW_HEIGHT;\nconst RULER_LABELS_HEIGHT = 60;\nconst CENTER_CHANGE_DONE = \'CENTER_CHANGE_DONE\';\nconst ZOOM_DONE = \'ZOOM_DONE\';\nconst SCROLL_DONE = \'SCROLL_DONE\';\nconst PIXELS_PER_LETTER = 8;\nclass RawSegment {\n}\nconst colors = [\n    \'rgba(211,84,0\',\n    \'rgba(219,10,91\',\n    \'rgba(31,58,147\',\n    \'rgba(0,128,0\'\n].map(color => (opacity = 1) => `${color},${opacity})`);\n\n\n//# sourceURL=webpack://Timeline/./src/constants.ts?')},"./src/event-bus.ts":
/*!**************************!*\
  !*** ./src/event-bus.ts ***!
  \**************************/
/*! exports provided: EventBus, default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EventBus", function() { return EventBus; });\nclass EventBus {\n    constructor() {\n        this.eventsListeners = [];\n    }\n    register(type, listener, target = document) {\n        target.addEventListener(type, listener);\n        this.eventsListeners.push([type, listener, target]);\n    }\n    flush() {\n        this.eventsListeners.forEach((eventListener) => {\n            const [type, listener, target] = eventListener;\n            target.removeEventListener(type, listener);\n        });\n        this.eventsListeners = [];\n    }\n}\n/* harmony default export */ __webpack_exports__["default"] = (new EventBus());\n\n\n//# sourceURL=webpack://Timeline/./src/event-bus.ts?')},"./src/index.ts":
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
/*! exports provided: TimelineConfig, EventsBand, MinimapBand, OrderedEvents, calcPixelsPerMillisecond, formatDate, orderEvents, RawEv3nt, default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Timeline; });\n/* harmony import */ var _models_props__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./models/props */ "./src/models/props.ts");\n/* harmony import */ var _models_config_index__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./models/config/index */ "./src/models/config/index.ts");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TimelineConfig", function() { return _models_config_index__WEBPACK_IMPORTED_MODULE_1__["default"]; });\n\n/* harmony import */ var _views_band__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./views/band */ "./src/views/band/index.ts");\n/* harmony import */ var _utils_create_element__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils/create-element */ "./src/utils/create-element.ts");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./utils */ "./src/utils/index.ts");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "calcPixelsPerMillisecond", function() { return _utils__WEBPACK_IMPORTED_MODULE_4__["calcPixelsPerMillisecond"]; });\n\n/* harmony import */ var _utils_events_worker__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./utils/events.worker */ "./src/utils/events.worker.ts");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "OrderedEvents", function() { return _utils_events_worker__WEBPACK_IMPORTED_MODULE_5__["OrderedEvents"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "orderEvents", function() { return _utils_events_worker__WEBPACK_IMPORTED_MODULE_5__["orderEvents"]; });\n\n/* harmony import */ var _api__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./api */ "./src/api.ts");\n/* harmony import */ var _views_band_events__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./views/band/events */ "./src/views/band/events.ts");\n/* harmony import */ var _views_canvas__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./views/canvas */ "./src/views/canvas/index.ts");\n/* harmony import */ var _views_label__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./views/label */ "./src/views/label.ts");\n/* harmony import */ var _models_band_minimap__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./models/band/minimap */ "./src/models/band/minimap.ts");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MinimapBand", function() { return _models_band_minimap__WEBPACK_IMPORTED_MODULE_10__["default"]; });\n\n/* harmony import */ var _models_band_events__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./models/band/events */ "./src/models/band/events.ts");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EventsBand", function() { return _models_band_events__WEBPACK_IMPORTED_MODULE_11__["default"]; });\n\n/* harmony import */ var _utils_dates__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./utils/dates */ "./src/utils/dates.ts");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "formatDate", function() { return _utils_dates__WEBPACK_IMPORTED_MODULE_12__["formatDate"]; });\n\n/* harmony import */ var _models_event__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./models/event */ "./src/models/event.ts");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RawEv3nt", function() { return _models_event__WEBPACK_IMPORTED_MODULE_13__["RawEv3nt"]; });\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nclass Timeline extends _api__WEBPACK_IMPORTED_MODULE_6__["default"] {\n    constructor(config, onChange, onSelect) {\n        super(onChange);\n        this.config = config;\n        this.onSelect = onSelect;\n        this.appendToWrapper = (child) => {\n            let children = child.render();\n            if (!Array.isArray(children))\n                children = [children];\n            children.forEach(c => this.wrapper.appendChild(c));\n        };\n        _models_props__WEBPACK_IMPORTED_MODULE_0__["default"].init(config);\n        config.rootElement.appendChild(this.render());\n        const debouncedResize = Object(_utils__WEBPACK_IMPORTED_MODULE_4__["debounce"])(this.resize, 600);\n        window.addEventListener(\'resize\', debouncedResize);\n    }\n    render() {\n        this.wrapper = Object(_utils_create_element__WEBPACK_IMPORTED_MODULE_3__["default"])(\'div\', \'wrapper\', [\n            \'box-sizing: border-box\',\n            \'height: 100%\',\n            \'overflow: hidden\',\n            \'position: relative\',\n            \'user-select: none\',\n            \'width: 100%\',\n        ]);\n        this.views = _models_props__WEBPACK_IMPORTED_MODULE_0__["default"].bands\n            .map(band => (band instanceof _models_band_events__WEBPACK_IMPORTED_MODULE_11__["default"]) ?\n            new _views_band_events__WEBPACK_IMPORTED_MODULE_7__["default"](band, this.onSelect) :\n            new _views_band__WEBPACK_IMPORTED_MODULE_2__["default"](band));\n        this.views.push(new _views_canvas__WEBPACK_IMPORTED_MODULE_8__["default"]());\n        this.views.forEach(this.appendToWrapper);\n        this.renderLabels();\n        const redLine = Object(_utils_create_element__WEBPACK_IMPORTED_MODULE_3__["default"])(\'div\', \'red-line\', [\n            \'background-color: rgb(126, 0, 0)\',\n            \'bottom: 0\',\n            \'left: calc(50% - 1px)\',\n            \'position: absolute\',\n            \'top: 0\',\n            \'width: 2px\',\n            \'z-index: 4\'\n        ]);\n        this.wrapper.appendChild(redLine);\n        return this.wrapper;\n    }\n    renderLabels() {\n        _models_props__WEBPACK_IMPORTED_MODULE_0__["default"].bands\n            .filter(band => band instanceof _models_band_events__WEBPACK_IMPORTED_MODULE_11__["default"] && band.config.label != null)\n            .map(band => new _views_label__WEBPACK_IMPORTED_MODULE_9__["default"](band))\n            .forEach(this.appendToWrapper);\n    }\n}\n\n\n//# sourceURL=webpack://Timeline/./src/index.ts?')},"./src/models/band/events.ts":
/*!***********************************!*\
  !*** ./src/models/band/events.ts ***!
  \***********************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return EventsBand; });\n/* harmony import */ var ___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! . */ "./src/models/band/index.ts");\n/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../config */ "./src/models/config/index.ts");\n/* harmony import */ var _animator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../animator */ "./src/animator.ts");\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../constants */ "./src/constants.ts");\n/* harmony import */ var _props__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../props */ "./src/models/props.ts");\n/* harmony import */ var _utils_events_worker__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/events.worker */ "./src/utils/events.worker.ts");\n/* harmony import */ var _utils_dates__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../utils/dates */ "./src/utils/dates.ts");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../utils */ "./src/utils/index.ts");\n\n\n\n\n\n\n\n\nclass EventsBand extends ___WEBPACK_IMPORTED_MODULE_0__["default"] {\n    constructor(config) {\n        super(Object.assign({}, new _config__WEBPACK_IMPORTED_MODULE_1__["EventsBandConfig"](), config));\n        this.events = [];\n        this.rowCount = 0;\n        this.visibleEvents = [];\n        this._offsetY = 0;\n        if (this.config.events != null)\n            this.config.events.sort(_utils_dates__WEBPACK_IMPORTED_MODULE_6__["byDate"]);\n    }\n    get offsetY() { return this._offsetY; }\n    set offsetY(offsetYChange) {\n        this._offsetY += offsetYChange;\n        if (this._offsetY < 0)\n            this._offsetY = 0;\n        const maxOffset = this.height > this.availableHeight ?\n            this.height - this.availableHeight + _constants__WEBPACK_IMPORTED_MODULE_3__["EVENT_ROW_HEIGHT"] :\n            0;\n        if (this._offsetY > maxOffset)\n            this._offsetY = maxOffset;\n        const lowestRow = this._offsetY / _constants__WEBPACK_IMPORTED_MODULE_3__["EVENT_ROW_HEIGHT"];\n        this.lowestVisibleRow = Math.ceil(lowestRow);\n        this.highestVisibleRow = this.lowestVisibleRow + this.visibleRowsCount;\n    }\n    init() {\n        super.init();\n        const pixelsPerMillisecond = Object(_utils__WEBPACK_IMPORTED_MODULE_7__["calcPixelsPerMillisecond"])(_props__WEBPACK_IMPORTED_MODULE_4__["default"].viewportWidth, this.config.zoomLevel || 0, _props__WEBPACK_IMPORTED_MODULE_4__["default"].time);\n        const orderedEvents = this.config.orderedEvents == null ?\n            Object(_utils_events_worker__WEBPACK_IMPORTED_MODULE_5__["orderEvents"])(this.config.events, pixelsPerMillisecond) :\n            this.config.orderedEvents;\n        this.events = orderedEvents.events;\n        this.rowCount = orderedEvents.row_count;\n        this.height = _constants__WEBPACK_IMPORTED_MODULE_3__["EVENT_ROW_HEIGHT"] * this.rowCount;\n        this.offsetY = 0;\n        this.updateEvents();\n    }\n    updateEvents() {\n        this.visibleEvents = this.events\n            .filter(event => !(event.from > this.to || event.to < this.from) &&\n            event.row >= this.lowestVisibleRow && event.row <= this.highestVisibleRow)\n            .map(event => {\n            event.left = this.positionAtTimestamp(event.from);\n            event.width = Math.round((event.time) * this.pixelsPerMillisecond);\n            if (event.time && event.width < 1)\n                event.width = 1;\n            event.padding = Math.round((event.space) * this.pixelsPerMillisecond);\n            event.top = this.top + this.availableHeight - ((event.row + 1) * _constants__WEBPACK_IMPORTED_MODULE_3__["EVENT_ROW_HEIGHT"]) + this.offsetY;\n            return event;\n        });\n    }\n    update() {\n        super.update();\n        this.updateEvents();\n    }\n    getEventByCoordinates(x, y) {\n        const timestamp = this.timestampAtPosition(x);\n        const bottomOfDomain = _props__WEBPACK_IMPORTED_MODULE_4__["default"].viewportOffset + this.top + this.availableHeight + this.offsetY;\n        const clickedRow = Math.floor((bottomOfDomain - y) / _constants__WEBPACK_IMPORTED_MODULE_3__["EVENT_ROW_HEIGHT"]);\n        const event = this.events.find(e => {\n            if (!(e.from < timestamp && e.from + e.time + e.space > timestamp) ||\n                (e.row < this.lowestVisibleRow || e.row > this.highestVisibleRow))\n                return false;\n            return e.row === clickedRow;\n        });\n        return event;\n    }\n    zoomIn() {\n        _animator__WEBPACK_IMPORTED_MODULE_2__["default"].zoomTo(this, this.zoomLevel + 1);\n    }\n    zoomOut() {\n        _animator__WEBPACK_IMPORTED_MODULE_2__["default"].zoomTo(this, this.zoomLevel - 1);\n    }\n}\n\n\n//# sourceURL=webpack://Timeline/./src/models/band/events.ts?')},"./src/models/band/index.ts":
/*!**********************************!*\
  !*** ./src/models/band/index.ts ***!
  \**********************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Band; });\n/* harmony import */ var _utils_dates__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/dates */ "./src/utils/dates.ts");\n/* harmony import */ var _props__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../props */ "./src/models/props.ts");\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../constants */ "./src/constants.ts");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils */ "./src/utils/index.ts");\n/* harmony import */ var _animator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../animator */ "./src/animator.ts");\n\n\n\n\n\nclass Band {\n    constructor(config) {\n        this.config = config;\n        this.defaultZoomLevel = 0;\n    }\n    get offsetX() { return this._offsetX; }\n    set offsetX(left) {\n        this.prevOffsetX = this.offsetX || left;\n        this._offsetX = left;\n    }\n    get zoomLevel() { return this._zoomLevel; }\n    set zoomLevel(zoomLevel) {\n        if (zoomLevel < 0)\n            zoomLevel = 0;\n        this.visibleRatio = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["visibleRatio"])(zoomLevel);\n        this.width = Math.round(_props__WEBPACK_IMPORTED_MODULE_1__["default"].viewportWidth / this.visibleRatio);\n        this.pixelsPerMillisecond = this.width / _props__WEBPACK_IMPORTED_MODULE_1__["default"].time;\n        this.time = this.visibleRatio * _props__WEBPACK_IMPORTED_MODULE_1__["default"].time;\n        this.granularity = Object(_utils_dates__WEBPACK_IMPORTED_MODULE_0__["getGranularity"])(this.pixelsPerMillisecond);\n        this.nextDate = Object(_utils_dates__WEBPACK_IMPORTED_MODULE_0__["subsequentDate"])(this.granularity);\n        this.prevZoomLevel = this.zoomLevel || zoomLevel;\n        this._zoomLevel = zoomLevel;\n        this.setHorizontalProps();\n    }\n    setVerticalProps() {\n        this.visibleHeight = Math.round(this.config.heightRatio * _props__WEBPACK_IMPORTED_MODULE_1__["default"].viewportHeight);\n        this.availableHeight = this.visibleHeight - _constants__WEBPACK_IMPORTED_MODULE_2__["DATE_BAR_HEIGHT"];\n        this.visibleRowsCount = Math.floor(this.availableHeight / _constants__WEBPACK_IMPORTED_MODULE_2__["EVENT_ROW_HEIGHT"]);\n        this.top = Math.round(this.config.topOffsetRatio * _props__WEBPACK_IMPORTED_MODULE_1__["default"].viewportHeight);\n    }\n    setHorizontalProps() {\n        this.from = _props__WEBPACK_IMPORTED_MODULE_1__["default"].center - this.time / 2;\n        this.to = _props__WEBPACK_IMPORTED_MODULE_1__["default"].center + this.time / 2;\n        this.offsetX = (_props__WEBPACK_IMPORTED_MODULE_1__["default"].from - this.from) * this.pixelsPerMillisecond;\n    }\n    init() {\n        this.zoomLevel = this.config.zoomLevel;\n        this.setVerticalProps();\n        _animator__WEBPACK_IMPORTED_MODULE_4__["default"].registerModel(this);\n    }\n    resize() {\n        this.zoomLevel = this.zoomLevel;\n        this.setVerticalProps();\n    }\n    update() {\n        this.setHorizontalProps();\n    }\n    updateConfig(props) {\n        Object.keys(props).forEach(prop => {\n            if (this.config.hasOwnProperty(prop)) {\n                this.config[prop] = props[prop];\n            }\n        });\n    }\n    positionAtTimestamp(timestamp) {\n        return Math.round((timestamp - this.from) * this.pixelsPerMillisecond);\n    }\n    timestampAtProportion(proportion) {\n        return _props__WEBPACK_IMPORTED_MODULE_1__["default"].from + (_props__WEBPACK_IMPORTED_MODULE_1__["default"].time * proportion);\n    }\n    timestampAtPosition(position) {\n        return this.from + (position / this.pixelsPerMillisecond);\n    }\n}\n\n\n//# sourceURL=webpack://Timeline/./src/models/band/index.ts?')},"./src/models/band/minimap.ts":
/*!************************************!*\
  !*** ./src/models/band/minimap.ts ***!
  \************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return MinimapBand; });\n/* harmony import */ var ___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! . */ "./src/models/band/index.ts");\n/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../config */ "./src/models/config/index.ts");\n/* harmony import */ var _props__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../props */ "./src/models/props.ts");\n/* harmony import */ var _utils_create_element__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/create-element */ "./src/utils/create-element.ts");\n\n\n\n\nfunction extendConfig(config) {\n    const extendedConfig = Object.assign({}, new _config__WEBPACK_IMPORTED_MODULE_1__["MinimapBandConfig"](), config);\n    if (!extendedConfig.targets.length)\n        extendedConfig.targets.push(0);\n    return extendedConfig;\n}\nclass MinimapBand extends ___WEBPACK_IMPORTED_MODULE_0__["default"] {\n    constructor(config) {\n        super(extendConfig(config));\n        this.isDrawn = false;\n        this.canvas = Object(_utils_create_element__WEBPACK_IMPORTED_MODULE_3__["default"])(\'canvas\');\n        this.ctx = this.canvas.getContext(\'2d\');\n        this.nextCanvas = Object(_utils_create_element__WEBPACK_IMPORTED_MODULE_3__["default"])(\'canvas\');\n        this.nextCtx = this.nextCanvas.getContext(\'2d\');\n    }\n    init() {\n        super.init();\n        this.maxRowCount = this.config.targets.reduce((prev, curr) => {\n            const { rowCount } = _props__WEBPACK_IMPORTED_MODULE_2__["default"].eventsBands[curr];\n            return Math.max(prev, rowCount);\n        }, 0);\n        const eventHeight = this.availableHeight / this.maxRowCount;\n        this.eventHeight = eventHeight < 1 ? 1 : Math.round(eventHeight);\n        this.canvas.width = _props__WEBPACK_IMPORTED_MODULE_2__["default"].viewportWidth;\n        this.canvas.height = this.maxRowCount * this.eventHeight;\n        this.nextCanvas.width = _props__WEBPACK_IMPORTED_MODULE_2__["default"].viewportWidth;\n        this.nextCanvas.height = this.maxRowCount * this.eventHeight;\n    }\n    resize() {\n        super.resize();\n        this.isDrawn = false;\n    }\n    draw() {\n        if (!this.isDrawn)\n            this.drawEvents();\n        else\n            this.updateNextCanvas();\n        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n        this.ctx.drawImage(this.nextCanvas, 0, 0);\n        return this.canvas;\n    }\n    drawEvents(from = this.from, to = this.to) {\n        this.nextCtx.beginPath();\n        this.config.targets.forEach(targetIndex => {\n            const targetBand = _props__WEBPACK_IMPORTED_MODULE_2__["default"].eventsBands[targetIndex];\n            for (const event of targetBand.events) {\n                if (event.from > to || event.to < from)\n                    continue;\n                const eventWidth = Math.round(event.time * this.pixelsPerMillisecond);\n                const eventLeft = this.positionAtTimestamp(event.date_min != null ? event.date_min : event.date);\n                const y = this.maxRowCount - ((event.row + 1) * this.eventHeight);\n                const width = eventWidth < 1 ? 1 : eventWidth;\n                this.nextCtx.rect(eventLeft, y, width, this.eventHeight);\n            }\n        });\n        this.nextCtx.fillStyle = `rgb(190, 190, 190)`;\n        this.nextCtx.fill();\n    }\n    updateNextCanvas() {\n        const leftOffset = Math.round(this.offsetX - this.prevOffsetX);\n        if (leftOffset === 0)\n            return this.canvas;\n        this.nextCtx.clearRect(0, 0, this.nextCanvas.width, this.nextCanvas.height);\n        this.nextCtx.drawImage(this.canvas, leftOffset, 0);\n        let from, to;\n        if (leftOffset < 0) {\n            from = this.timestampAtPosition(_props__WEBPACK_IMPORTED_MODULE_2__["default"].viewportWidth + leftOffset);\n            to = this.to;\n        }\n        else {\n            from = this.from;\n            to = this.timestampAtPosition(leftOffset);\n        }\n        this.drawEvents(from, to);\n    }\n}\n\n\n//# sourceURL=webpack://Timeline/./src/models/band/minimap.ts?')},"./src/models/config/index.ts":
/*!************************************!*\
  !*** ./src/models/config/index.ts ***!
  \************************************/
/*! exports provided: DomainConfig, BandConfig, MinimapBandConfig, EventsBandConfig, default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DomainConfig", function() { return DomainConfig; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BandConfig", function() { return BandConfig; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MinimapBandConfig", function() { return MinimapBandConfig; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EventsBandConfig", function() { return EventsBandConfig; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Config; });\nclass DomainConfig {\n}\nclass BandConfig {\n    constructor() {\n        this.heightRatio = 1;\n        this.rulers = true;\n        this.rulerLabels = true;\n        this.topOffsetRatio = 0;\n        this.zoomLevel = 0;\n    }\n}\nclass MinimapBandConfig extends BandConfig {\n    constructor() {\n        super(...arguments);\n        this.indicatorFor = 0;\n        this.targets = [];\n    }\n}\nclass EventsBandConfig extends BandConfig {\n}\nclass Config {\n}\n\n\n//# sourceURL=webpack://Timeline/./src/models/config/index.ts?')},"./src/models/event.ts":
/*!*****************************!*\
  !*** ./src/models/event.ts ***!
  \*****************************/
/*! exports provided: RawEv3nt */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RawEv3nt", function() { return RawEv3nt; });\nclass RawEv3nt {\n    constructor() {\n        this.date_granularity = "DAY";\n    }\n}\n\n\n//# sourceURL=webpack://Timeline/./src/models/event.ts?')},"./src/models/props.ts":
/*!*****************************!*\
  !*** ./src/models/props.ts ***!
  \*****************************/
/*! exports provided: Props, default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Props", function() { return Props; });\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../constants */ "./src/constants.ts");\n/* harmony import */ var _band_minimap__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./band/minimap */ "./src/models/band/minimap.ts");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils */ "./src/utils/index.ts");\n/* harmony import */ var _band_events__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./band/events */ "./src/models/band/events.ts");\n\n\n\n\nfunction onEventsBand(band) {\n    return band instanceof _band_events__WEBPACK_IMPORTED_MODULE_3__["default"];\n}\nfunction onMinimapBand(band) {\n    return band instanceof _band_minimap__WEBPACK_IMPORTED_MODULE_1__["default"];\n}\nclass Props {\n    constructor() {\n        this.defaultCenterRatio = .5;\n        this.centerChangeDone = Object(_utils__WEBPACK_IMPORTED_MODULE_2__["debounce"])(() => {\n            document.dispatchEvent(new CustomEvent(_constants__WEBPACK_IMPORTED_MODULE_0__["CENTER_CHANGE_DONE"]));\n        }, 300);\n    }\n    get center() { return this._center; }\n    set center(n) {\n        if ((this._center === this.from && n < this.from) || (this._center === this.to && n > this.to))\n            return;\n        if (n < this.from)\n            this._center = this.from;\n        else if (n > this.to)\n            this._center = this.to;\n        else\n            this._center = n;\n        this.centerChangeDone();\n    }\n    set dimensions(rootElement) {\n        const style = getComputedStyle(rootElement);\n        this.viewportHeight = parseInt(style.getPropertyValue(\'height\'), 10);\n        this.viewportOffset = rootElement.getBoundingClientRect().top;\n        this.viewportWidth = parseInt(style.getPropertyValue(\'width\'), 10);\n    }\n    init(config) {\n        if (config.rootElement == null)\n            console.error(\'[init] No rootElement found\');\n        this.rootElement = config.rootElement;\n        this.dimensions = this.rootElement;\n        const [froms, tos] = config.bands.reduce((prev, curr) => {\n            console.log(curr instanceof _band_minimap__WEBPACK_IMPORTED_MODULE_1__["default"]);\n            console.log(typeof curr);\n            if (curr instanceof _band_minimap__WEBPACK_IMPORTED_MODULE_1__["default"])\n                return prev;\n            const events = curr.config.orderedEvents == null ? curr.config.events : curr.config.orderedEvents.events;\n            prev[0].push(events[0].date_min || events[0].date);\n            prev[1].push(events.reduce((prev, curr) => {\n                return Math.max(prev, curr.end_date || -Infinity, curr.end_date_max || -Infinity);\n            }, -Infinity));\n            return prev;\n        }, [[], []]);\n        this.from = Math.min(...froms);\n        this.to = Math.max(...tos);\n        this.time = this.to - this.from;\n        this.center = (config.center != null) ?\n            config.center :\n            this.from + (this.defaultCenterRatio * this.time);\n        this.bands = config.bands;\n        this.eventsBands = this.bands.filter(onEventsBand);\n        this.minimapBands = this.bands.filter(onMinimapBand);\n        for (const band of this.bands) {\n            band.init();\n        }\n    }\n    resize() {\n        this.dimensions = this.rootElement;\n    }\n}\n/* harmony default export */ __webpack_exports__["default"] = (new Props());\n\n\n//# sourceURL=webpack://Timeline/./src/models/props.ts?')},"./src/utils/create-element.ts":
/*!*************************************!*\
  !*** ./src/utils/create-element.ts ***!
  \*************************************/
/*! exports provided: createSvg, default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createSvg\", function() { return createSvg; });\nconst createSvg = (name, style, attrs = {}) => {\n    const el = document.createElementNS(\"http://www.w3.org/2000/svg\", name);\n    if (style != null)\n        el.setAttribute('style', style.join(';').concat(';'));\n    Object.keys(attrs).forEach(k => el.setAttribute(k, attrs[k]));\n    return el;\n};\nlet sheet;\nif (typeof window !== 'undefined') {\n    const element = document.createElement('style');\n    document.head.appendChild(element);\n    sheet = element.sheet;\n}\nconst rules = {};\n/* harmony default export */ __webpack_exports__[\"default\"] = ((name, className, style, dynamicStyle) => {\n    if (!className)\n        return document.createElement(name);\n    let el;\n    if (rules.hasOwnProperty(className)) {\n        el = rules[className].cloneNode(false);\n    }\n    else {\n        el = document.createElement(name);\n        el.classList.add(className);\n        if (style) {\n            sheet.insertRule(`.${className} { ${style.join(';').concat(';')} }`);\n        }\n        rules[className] = el.cloneNode(false);\n    }\n    if (dynamicStyle)\n        el.setAttribute('style', dynamicStyle.join(';').concat(';'));\n    return el;\n});\n\n\n//# sourceURL=webpack://Timeline/./src/utils/create-element.ts?")},"./src/utils/dates.ts":
/*!****************************!*\
  !*** ./src/utils/dates.ts ***!
  \****************************/
/*! exports provided: formatDate, getGranularity, getStep, subsequentDate, byDate, labelBody */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "formatDate", function() { return formatDate; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getGranularity", function() { return getGranularity; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getStep", function() { return getStep; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "subsequentDate", function() { return subsequentDate; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "byDate", function() { return byDate; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "labelBody", function() { return labelBody; });\nconst days = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];\nconst months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];\nfunction nth(n) { return ["st", "nd", "rd"][((n + 90) % 100 - 10) % 10 - 1] || "th"; }\nfunction formatMonth(d) { return months[d.getUTCMonth()]; }\nfunction formatDateNumber(d) {\n    const dateNumber = d.getUTCDate();\n    const day = days[d.getUTCDay()];\n    return `${day}, ${dateNumber}${nth(dateNumber)}`;\n}\nfunction formatHours(d) { return d.getUTCHours().toString().padStart(2, \'0\'); }\nfunction formatMinutes(d) { return d.getUTCMinutes().toString().padStart(2, \'0\'); }\nfunction formatSeconds(d) { return d.getUTCSeconds().toString().padStart(2, \'0\'); }\nfunction formatMilliseconds(d) { return d.getUTCMilliseconds().toString().padStart(3, \'0\'); }\nfunction isYearOrBigger(granularity) {\n    return granularity === "YEAR" ||\n        granularity === "YEAR_5" ||\n        granularity === "DECADE" ||\n        granularity === "DECADE_5" ||\n        granularity === "CENTURY" ||\n        granularity === "CENTURY_5" ||\n        granularity === "MILLENIUM";\n}\nconst formatDate = (timestamp, granularity) => {\n    if (timestamp == null)\n        return \'\';\n    const date = new Date(timestamp);\n    let label = date.getUTCFullYear().toString();\n    if (isYearOrBigger(granularity))\n        return label;\n    label = `${formatMonth(date)} ${label}`;\n    if (granularity === "MONHT")\n        return label;\n    label = `${formatDateNumber(date)} ${label}`;\n    if (granularity === "DAY")\n        return label;\n    label = `${label} at ${formatHours(date)}:`;\n    if (granularity === "HOUR")\n        return `${label}00`;\n    label = `${label}${formatMinutes(date)}`;\n    if (granularity === "MINUTE")\n        return label;\n    label = `${label}:${formatSeconds(date)}`;\n    if (granularity === "SECOND")\n        return label;\n    return `${label}.${formatMilliseconds(date)}`;\n};\nconst getGranularity = (pixelsPerMillisecond) => {\n    if (pixelsPerMillisecond > 58)\n        return "MILLISECOND";\n    if (pixelsPerMillisecond > 12)\n        return "MILLISECOND_10";\n    if (pixelsPerMillisecond > 2.3)\n        return "MILLISECOND_50";\n    if (pixelsPerMillisecond > 1.5)\n        return "MILLISECOND_100";\n    if (pixelsPerMillisecond > .4)\n        return "MILLISECOND_500";\n    if (pixelsPerMillisecond > 1.12e-3)\n        return "SECOND";\n    if (pixelsPerMillisecond > 1.12e-4)\n        return "MINUTE";\n    if (pixelsPerMillisecond > 1.12e-5)\n        return "HOUR";\n    if (pixelsPerMillisecond > 8e-7)\n        return "DAY";\n    if (pixelsPerMillisecond > 2.6e-7)\n        return "WEEK";\n    if (pixelsPerMillisecond > 2.2e-8)\n        return "MONHT";\n    if (pixelsPerMillisecond > 2.2e-9)\n        return "YEAR";\n    if (pixelsPerMillisecond > 3.3e-10)\n        return "YEAR_5";\n    if (pixelsPerMillisecond > 1.6e-10)\n        return "DECADE";\n    if (pixelsPerMillisecond > 8e-11)\n        return "DECADE_5";\n    if (pixelsPerMillisecond > 1e-11)\n        return "CENTURY";\n    if (pixelsPerMillisecond > 5e-12)\n        return "CENTURY_5";\n    return "MILLENIUM";\n};\nconst getStep = (granularity) => {\n    if (granularity === "YEAR")\n        return 1;\n    if (granularity === "YEAR_5")\n        return 5;\n    if (granularity === "DECADE")\n        return 10;\n    if (granularity === "DECADE_5")\n        return 50;\n    if (granularity === "CENTURY")\n        return 100;\n    if (granularity === "CENTURY_5")\n        return 500;\n    if (granularity === "MILLENIUM")\n        return 1000;\n    if (granularity === "MILLISECOND")\n        return 1;\n    if (granularity === "MILLISECOND_10")\n        return 10;\n    if (granularity === "MILLISECOND_50")\n        return 50;\n    if (granularity === "MILLISECOND_100")\n        return 100;\n    if (granularity === "MILLISECOND_500")\n        return 500;\n    throw new RangeError("[getStep] Only steps with a granularity greater than \'year\' calculated");\n};\nfunction subsequentDate(granularity) {\n    if (isYearOrBigger(granularity)) {\n        return (d) => {\n            let date = new Date(d);\n            let nextYear = date.getUTCFullYear() + 1;\n            if (granularity !== "YEAR") {\n                const step = getStep(granularity);\n                while (nextYear % step !== 0) {\n                    nextYear += 1;\n                }\n            }\n            if (nextYear > -1 && nextYear < 100) {\n                date.setUTCFullYear(nextYear);\n                return date.getTime();\n            }\n            else {\n                return Date.UTC(nextYear, 0, 1);\n            }\n        };\n    }\n    if (granularity === "MONHT") {\n        return (d) => {\n            const date = new Date(d);\n            return Date.UTC(date.getUTCFullYear(), date.getUTCMonth() + 1, 1);\n        };\n    }\n    if (granularity === "WEEK") {\n        return (d) => {\n            const date = new Date(d);\n            return Date.UTC(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate() + 7);\n        };\n    }\n    if (granularity === "DAY") {\n        return (d) => {\n            const date = new Date(d);\n            return Date.UTC(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate() + 1);\n        };\n    }\n    if (granularity === "HOUR") {\n        return (d) => {\n            const date = new Date(d);\n            return Date.UTC(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), date.getUTCHours() + 1);\n        };\n    }\n    if (granularity === "MINUTE") {\n        return (d) => {\n            const date = new Date(d);\n            return Date.UTC(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes() + 1);\n        };\n    }\n    if (granularity === "SECOND") {\n        return (d) => {\n            const date = new Date(d);\n            return Date.UTC(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds() + 1);\n        };\n    }\n    if (granularity.slice(0, "MILLISECOND".length) === "MILLISECOND") {\n        return (d) => {\n            const step = getStep(granularity);\n            const date = new Date(d);\n            let ms = date.getUTCMilliseconds() + 1;\n            if (step > 1)\n                ms = ms + step - (ms % step);\n            return Date.UTC(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds(), ms);\n        };\n    }\n}\nfunction byDate(a, b) {\n    const aFrom = a.date_min != null ? a.date_min : a.date;\n    const bFrom = b.date_min != null ? b.date_min : b.date;\n    if (aFrom < bFrom)\n        return -1;\n    if (aFrom > bFrom)\n        return 1;\n    const aTo = a.end_date_max != null ? a.end_date_max : a.end_date;\n    const bTo = b.end_date_max != null ? b.end_date_max : b.end_date;\n    if (aTo < bTo)\n        return -1;\n    if (aTo > bTo)\n        return 1;\n    return 0;\n}\nconst getWeekNumber = (date) => {\n    const d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));\n    const dayNum = d.getUTCDay() || 7;\n    d.setUTCDate(d.getUTCDate() + 4 - dayNum);\n    const yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));\n    return Math.ceil((((d.getTime() - yearStart.getTime()) / 86400000) + 1) / 7);\n};\nconst labelBody = (d, granularity) => {\n    const date = new Date(d);\n    if (isYearOrBigger(granularity))\n        return date.getUTCFullYear().toString();\n    if (granularity === "MONHT")\n        return formatMonth(date);\n    if (granularity === "WEEK")\n        return `${formatMonth(date)}, week ${getWeekNumber(date)}`;\n    if (granularity === "DAY")\n        return `${formatDateNumber(date)} ${formatMonth(date)}`;\n    if (granularity === "HOUR")\n        return `${formatHours(date)}:00`;\n    if (granularity === "MINUTE")\n        return `${formatHours(date)}:${formatMinutes(date)}`;\n    if (granularity === "SECOND")\n        return `${formatHours(date)}:${formatMinutes(date)}:${formatSeconds(date)}`;\n    if (granularity.slice(0, "MILLISECOND".length) === "MILLISECOND") {\n        return `${formatHours(date)}:${formatMinutes(date)}:${formatSeconds(date)}.${formatMilliseconds(date)}`;\n    }\n};\n\n\n//# sourceURL=webpack://Timeline/./src/utils/dates.ts?')},"./src/utils/events.worker.ts":
/*!************************************!*\
  !*** ./src/utils/events.worker.ts ***!
  \************************************/
/*! exports provided: OrderedEvents, orderEvents */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OrderedEvents", function() { return OrderedEvents; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "orderEvents", function() { return orderEvents; });\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../constants */ "./src/constants.ts");\n\nclass OrderedEvents {\n    constructor() {\n        this.events = [];\n        this.row_count = 0;\n    }\n}\nconst pixelsPerLetter = 8;\nfunction orderEvents(events, pixelsPerMillisecond) {\n    if (!events.length)\n        return new OrderedEvents();\n    let rowCount = 0;\n    const grid = [];\n    const paddingRight = _constants__WEBPACK_IMPORTED_MODULE_0__["EVENT_HEIGHT"] * 2 / pixelsPerMillisecond;\n    const addRow = (event) => {\n        let row;\n        if (event.label == null)\n            event.label = \'NO LABEL\';\n        event.from = event.date_min || event.date;\n        event.to = event.end_date_max || event.end_date;\n        if (event.to == null)\n            event.to = event.from;\n        event.time = event.to == null ? 0 : event.to - event.from;\n        event.space = 0;\n        if (!event.time) {\n            if (event.label == null)\n                event.label = \'NO LABEL\';\n            event.space = ((event.label.length * pixelsPerLetter) / pixelsPerMillisecond) + paddingRight;\n        }\n        let rowIterator = 0;\n        while (row == null && rowIterator < grid.length) {\n            let cellIterator = 0;\n            let hasSpace = true;\n            while (hasSpace && cellIterator < grid[rowIterator].length) {\n                if (event.to < grid[rowIterator][cellIterator][0])\n                    break;\n                hasSpace = event.from > grid[rowIterator][cellIterator][1];\n                cellIterator++;\n            }\n            if (hasSpace) {\n                grid[rowIterator].push([event.from, event.from + event.time + event.space]);\n                row = rowIterator;\n            }\n            rowIterator++;\n        }\n        if (row == null)\n            row = grid.push([[event.from, event.from + event.time + event.space]]) - 1;\n        if (row > rowCount)\n            rowCount = row;\n        event.row = row;\n        return event;\n    };\n    events = events.map(addRow);\n    return {\n        events,\n        row_count: grid.length\n    };\n}\n\n\n//# sourceURL=webpack://Timeline/./src/utils/events.worker.ts?')},"./src/utils/index.ts":
/*!****************************!*\
  !*** ./src/utils/index.ts ***!
  \****************************/
/*! exports provided: debounce, onVisible, visibleRatio, createRange, selectRandom, calcPixelsPerMillisecond, logEvent */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "debounce", function() { return debounce; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "onVisible", function() { return onVisible; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "visibleRatio", function() { return visibleRatio; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createRange", function() { return createRange; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "selectRandom", function() { return selectRandom; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "calcPixelsPerMillisecond", function() { return calcPixelsPerMillisecond; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "logEvent", function() { return logEvent; });\nconst debounce = (func, wait) => {\n    let timeout;\n    return () => {\n        clearTimeout(timeout);\n        timeout = setTimeout(func, wait);\n    };\n};\nconst onVisible = (from, to) => (e) => {\n    const eventFrom = e.date_min || e.date;\n    let eventTo = e.end_date_max || e.end_date;\n    if (eventTo == null)\n        eventTo = eventFrom;\n    if (eventFrom == null && eventTo == null)\n        return false;\n    return !(eventTo < from || eventFrom > to);\n};\nfunction visibleRatio(zoomLevel) {\n    return Math.pow(2, zoomLevel * -1);\n}\nfunction createRange(n) {\n    return Array.apply(null, { length: n }).map(Number.call, Number);\n}\nfunction selectRandom(set, amount) {\n    const selected = [];\n    while (selected.length < amount) {\n        const randomIndex = Math.floor(Math.random() * set.length);\n        const nextItem = set[randomIndex];\n        if (selected.indexOf(nextItem) === -1 || set.length < amount)\n            selected.push(nextItem);\n    }\n    return selected;\n}\nfunction calcPixelsPerMillisecond(viewportWidth, zoomLevel, totalTime) {\n    return (viewportWidth / visibleRatio(zoomLevel)) / totalTime;\n}\nfunction formatDate(ts) {\n    if (ts == null)\n        return null;\n    const d = new Date(ts);\n    return `${d.getFullYear()}-${d.getMonth() + 1}-${d.getDate()}`;\n}\nfunction logEvent(event, ...rest) {\n    console.log(event.label, event, event.left, formatDate(event.from), formatDate(event.to), rest);\n}\n\n\n//# sourceURL=webpack://Timeline/./src/utils/index.ts?')},"./src/views/band/events.ts":
/*!**********************************!*\
  !*** ./src/views/band/events.ts ***!
  \**********************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return EventsBandView; });\n/* harmony import */ var _index__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index */ "./src/views/band/index.ts");\n/* harmony import */ var _event_bus__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../event-bus */ "./src/event-bus.ts");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils */ "./src/utils/index.ts");\n\n\n\nclass EventsBandView extends _index__WEBPACK_IMPORTED_MODULE_0__["default"] {\n    constructor(band, select) {\n        super(band);\n        this.band = band;\n        this.select = select;\n        this.onWheel = (ev) => {\n            if (Math.abs(ev.deltaX) === 0 && ev.deltaY !== 0) {\n                if (ev.deltaY < 0)\n                    this.zoomOut();\n                if (ev.deltaY > 0)\n                    this.zoomIn();\n            }\n        };\n        this.onClick = (ev) => {\n            if (this.lastDragInterval > 175)\n                return;\n            const event = this.band.getEventByCoordinates(ev.clientX, ev.clientY);\n            if (event && this.select) {\n                this.select(event);\n                Object(_utils__WEBPACK_IMPORTED_MODULE_2__["logEvent"])(event);\n            }\n        };\n    }\n    render() {\n        const root = super.render();\n        _event_bus__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'click\', this.onClick, this.rootElement);\n        _event_bus__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'wheel\', this.onWheel, this.rootElement);\n        return root;\n    }\n    zoomIn() {\n        this.band.zoomIn();\n    }\n    zoomOut() {\n        this.band.zoomOut();\n    }\n}\n\n\n//# sourceURL=webpack://Timeline/./src/views/band/events.ts?')},"./src/views/band/index.ts":
/*!*********************************!*\
  !*** ./src/views/band/index.ts ***!
  \*********************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return BandView; });\n/* harmony import */ var _models_props__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../models/props */ "./src/models/props.ts");\n/* harmony import */ var _utils_create_element__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/create-element */ "./src/utils/create-element.ts");\n/* harmony import */ var _event_bus__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../event-bus */ "./src/event-bus.ts");\n/* harmony import */ var _animator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../animator */ "./src/animator.ts");\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../constants */ "./src/constants.ts");\n/* harmony import */ var _models_band_events__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../models/band/events */ "./src/models/band/events.ts");\n\n\n\n\n\n\nclass BandView {\n    constructor(band) {\n        this.band = band;\n        this.onMouseDown = (ev) => {\n            document.addEventListener(\'mouseup\', this.onMouseUp);\n            this.dragStartTime = Date.now();\n            this.dragStartPosition = [ev.clientX, ev.clientY];\n            this.dragOffsetX = ev.clientX;\n            this.dragOffsetY = ev.clientY;\n        };\n        this.onMouseMove = (ev) => {\n            if (this.dragOffsetX == null)\n                return;\n            if (this.band instanceof _models_band_events__WEBPACK_IMPORTED_MODULE_5__["default"]) {\n                this.band.offsetY = ev.clientY - this.dragOffsetY;\n            }\n            const centerChange = (this.dragOffsetX - ev.clientX) / this.band.pixelsPerMillisecond;\n            _models_props__WEBPACK_IMPORTED_MODULE_0__["default"].center += centerChange;\n            _animator__WEBPACK_IMPORTED_MODULE_3__["default"].nextFrame();\n            this.dragOffsetX = ev.clientX;\n            this.dragOffsetY = ev.clientY;\n        };\n        this.onMouseUp = (ev) => {\n            this.lastDragInterval = Date.now() - this.dragStartTime;\n            this.dispatchScrollDoneEvent(ev);\n            this.dragOffsetX = null;\n            this.dragOffsetY = null;\n            document.removeEventListener(\'mouseup\', this.onMouseUp);\n        };\n        this.onDblClick = (ev) => {\n            const nextCenter = this.band.timestampAtPosition(ev.clientX);\n            _animator__WEBPACK_IMPORTED_MODULE_3__["default"].goTo(nextCenter);\n        };\n    }\n    render() {\n        this.rootElement = Object(_utils_create_element__WEBPACK_IMPORTED_MODULE_1__["default"])(\'div\', \'band-wrap\', [\n            \'position: absolute\',\n            \'z-index: 2\',\n        ], [\n            `height: ${this.band.visibleHeight}px`,\n            `top: ${this.band.top}px`,\n            `width: ${_models_props__WEBPACK_IMPORTED_MODULE_0__["default"].viewportWidth}px`,\n        ]);\n        _event_bus__WEBPACK_IMPORTED_MODULE_2__["default"].register(\'mousedown\', this.onMouseDown, this.rootElement);\n        _event_bus__WEBPACK_IMPORTED_MODULE_2__["default"].register(\'mousemove\', this.onMouseMove, this.rootElement);\n        _event_bus__WEBPACK_IMPORTED_MODULE_2__["default"].register(\'dblclick\', this.onDblClick, this.rootElement);\n        return this.rootElement;\n    }\n    dispatchScrollDoneEvent(ev) {\n        const significantDrag = [\n            this.dragStartPosition[0] - ev.clientX,\n            this.dragStartPosition[1] - ev.clientY\n        ]\n            .map(Math.abs)\n            .some(offset => offset > 5);\n        if (this.lastDragInterval > 200 || significantDrag) {\n            document.dispatchEvent(new CustomEvent(_constants__WEBPACK_IMPORTED_MODULE_4__["SCROLL_DONE"]));\n        }\n    }\n    resize() {\n        this.rootElement.style.cssText = `height: ${this.band.visibleHeight}px; top: ${this.band.top}px; width: ${_models_props__WEBPACK_IMPORTED_MODULE_0__["default"].viewportWidth}px;`;\n    }\n}\n\n\n//# sourceURL=webpack://Timeline/./src/views/band/index.ts?')},"./src/views/canvas/index.ts":
/*!***********************************!*\
  !*** ./src/views/canvas/index.ts ***!
  \***********************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Canvas; });\n/* harmony import */ var _utils_create_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/create-element */ "./src/utils/create-element.ts");\n/* harmony import */ var _models_props__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../models/props */ "./src/models/props.ts");\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../constants */ "./src/constants.ts");\n/* harmony import */ var _animator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../animator */ "./src/animator.ts");\n/* harmony import */ var _models_band_events__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../models/band/events */ "./src/models/band/events.ts");\n/* harmony import */ var _rulers__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./rulers */ "./src/views/canvas/rulers.ts");\n\n\n\n\n\n\nclass Canvas {\n    constructor() {\n        this.indicatorsDrawn = false;\n        this.update = () => {\n            _models_props__WEBPACK_IMPORTED_MODULE_1__["default"].bands\n                .forEach(band => {\n                if (band instanceof _models_band_events__WEBPACK_IMPORTED_MODULE_4__["default"])\n                    this.drawEventsBand(band);\n                else\n                    this.drawMinimapBand(band);\n            });\n            this.drawIndicators();\n        };\n        _animator__WEBPACK_IMPORTED_MODULE_3__["default"].registerView(this);\n    }\n    render() {\n        this.canvas = Object(_utils_create_element__WEBPACK_IMPORTED_MODULE_0__["default"])(\'canvas\', \'main\', [\n            \'position: absolute\',\n        ]);\n        this.canvas.width = _models_props__WEBPACK_IMPORTED_MODULE_1__["default"].viewportWidth;\n        this.canvas.height = _models_props__WEBPACK_IMPORTED_MODULE_1__["default"].viewportHeight;\n        this.ctx = this.canvas.getContext(\'2d\');\n        this.indicatorsCanvas = Object(_utils_create_element__WEBPACK_IMPORTED_MODULE_0__["default"])(\'canvas\', \'indicators\', [\n            \'position: absolute\',\n        ], [\'z-index: 1\']);\n        this.indicatorsCanvas.width = _models_props__WEBPACK_IMPORTED_MODULE_1__["default"].viewportWidth;\n        this.indicatorsCanvas.height = _models_props__WEBPACK_IMPORTED_MODULE_1__["default"].viewportHeight;\n        this.indicatorsCtx = this.indicatorsCanvas.getContext(\'2d\');\n        this.update();\n        return [this.canvas, this.indicatorsCanvas];\n    }\n    resize() {\n        this.indicatorsCanvas.width = _models_props__WEBPACK_IMPORTED_MODULE_1__["default"].viewportWidth;\n        this.indicatorsCanvas.height = _models_props__WEBPACK_IMPORTED_MODULE_1__["default"].viewportHeight;\n        this.canvas.width = _models_props__WEBPACK_IMPORTED_MODULE_1__["default"].viewportWidth;\n        this.canvas.height = _models_props__WEBPACK_IMPORTED_MODULE_1__["default"].viewportHeight;\n        this.indicatorsDrawn = false;\n    }\n    clear(band) {\n        this.ctx.clearRect(0, band.top, this.canvas.width, band.visibleHeight);\n    }\n    drawEventsBand(band) {\n        this.clear(band);\n        Object(_rulers__WEBPACK_IMPORTED_MODULE_5__["default"])(this.ctx, band);\n        this.ctx.beginPath();\n        for (const event of band.visibleEvents) {\n            if (!event.time) {\n                this.ctx.moveTo(event.left, event.top + _constants__WEBPACK_IMPORTED_MODULE_2__["EVENT_HEIGHT"] / 2);\n                this.ctx.arc(event.left, event.top + _constants__WEBPACK_IMPORTED_MODULE_2__["EVENT_HEIGHT"] / 2, _constants__WEBPACK_IMPORTED_MODULE_2__["EVENT_HEIGHT"] / 3, 0, 2 * Math.PI);\n            }\n            else {\n                this.ctx.rect(event.left, event.top, event.width, _constants__WEBPACK_IMPORTED_MODULE_2__["EVENT_HEIGHT"]);\n            }\n        }\n        this.ctx.fillStyle = `rgb(216, 178, 178)`;\n        this.ctx.fill();\n        this.drawEventsText(band);\n    }\n    drawEventsText(band) {\n        this.ctx.font = \'11px sans-serif\';\n        this.ctx.fillStyle = `rgb(126, 0, 0)`;\n        for (const event of band.visibleEvents) {\n            let eventWidth = event.time === 0 ? event.padding : event.width;\n            let eventLeft = event.left;\n            if (event.left < 0 && event.time !== 0) {\n                eventWidth = event.width + event.left;\n                eventLeft = 0;\n            }\n            let eventLabelLength = event.label.length * _constants__WEBPACK_IMPORTED_MODULE_2__["PIXELS_PER_LETTER"];\n            if (eventLabelLength <= eventWidth) {\n                const paddingLeft = event.time ? 3 : 8;\n                this.ctx.fillText(event.label, eventLeft + paddingLeft, event.top + _constants__WEBPACK_IMPORTED_MODULE_2__["EVENT_HEIGHT"] - 3);\n            }\n        }\n    }\n    drawMinimapBand(band) {\n        if (band.isDrawn && band.prevOffsetX === band.offsetX && band.prevZoomLevel === band.zoomLevel)\n            return;\n        this.clear(band);\n        Object(_rulers__WEBPACK_IMPORTED_MODULE_5__["default"])(this.ctx, band);\n        const minimapCanvas = band.draw();\n        this.ctx.drawImage(minimapCanvas, 0, band.top, _models_props__WEBPACK_IMPORTED_MODULE_1__["default"].viewportWidth, band.availableHeight);\n        band.isDrawn = true;\n    }\n    drawIndicators() {\n        if (this.indicatorsDrawn && _models_props__WEBPACK_IMPORTED_MODULE_1__["default"].eventsBands.every(b => b.prevZoomLevel === b.zoomLevel))\n            return;\n        this.indicatorsCtx.clearRect(0, 0, _models_props__WEBPACK_IMPORTED_MODULE_1__["default"].viewportWidth, _models_props__WEBPACK_IMPORTED_MODULE_1__["default"].viewportHeight);\n        this.indicatorsCtx.beginPath();\n        for (const band of _models_props__WEBPACK_IMPORTED_MODULE_1__["default"].minimapBands) {\n            const eventsBand = _models_props__WEBPACK_IMPORTED_MODULE_1__["default"].eventsBands[band.config.indicatorFor];\n            const indicatorTOP = Math.round(band.config.topOffsetRatio * _models_props__WEBPACK_IMPORTED_MODULE_1__["default"].viewportHeight);\n            const leftIndicatorRightX = band.positionAtTimestamp(eventsBand.from);\n            this.indicatorsCtx.rect(0, indicatorTOP, leftIndicatorRightX, band.visibleHeight);\n            const rightIndicatorLeftX = band.positionAtTimestamp(eventsBand.to);\n            this.indicatorsCtx.rect(rightIndicatorLeftX, indicatorTOP, _models_props__WEBPACK_IMPORTED_MODULE_1__["default"].viewportWidth, band.visibleHeight);\n            this.indicatorsCtx.rect(leftIndicatorRightX, indicatorTOP + band.visibleHeight - _constants__WEBPACK_IMPORTED_MODULE_2__["DATE_BAR_HEIGHT"], rightIndicatorLeftX - leftIndicatorRightX, _constants__WEBPACK_IMPORTED_MODULE_2__["DATE_BAR_HEIGHT"]);\n        }\n        this.indicatorsCtx.fillStyle = `rgba(0, 0, 0, .04)`;\n        this.indicatorsCtx.fill();\n        this.indicatorsCtx.closePath();\n        this.indicatorsDrawn = true;\n    }\n}\n\n\n//# sourceURL=webpack://Timeline/./src/views/canvas/index.ts?')},"./src/views/canvas/rulers.ts":
/*!************************************!*\
  !*** ./src/views/canvas/rulers.ts ***!
  \************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return drawRulers; });\n/* harmony import */ var _models_props__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../models/props */ "./src/models/props.ts");\n/* harmony import */ var _utils_dates__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/dates */ "./src/utils/dates.ts");\n\n\nconst smallFont = "11px sans-serif";\nconst bigFont = "13px sans-serif";\nfunction isSpecialRuler(date, band) {\n    if (band.granularity === "CENTURY" && new Date(date).getUTCFullYear() % 1000 === 0)\n        return true;\n    if (band.granularity === "YEAR_5" && new Date(date).getUTCFullYear() % 50 === 0)\n        return true;\n    if (band.granularity === "YEAR" && new Date(date).getUTCFullYear() % 5 === 0)\n        return true;\n    return false;\n}\nfunction drawRuler(ctx, band, date, top, bottom) {\n    const left = band.positionAtTimestamp(date);\n    ctx.moveTo(left, top);\n    ctx.lineTo(left, bottom);\n    if (band.config.rulerLabels)\n        ctx.fillText(Object(_utils_dates__WEBPACK_IMPORTED_MODULE_1__["labelBody"])(date, band.granularity), left + 3, bottom - 3);\n}\nfunction drawRulers(ctx, band) {\n    if (!band.config.rulers)\n        return;\n    let date = band.nextDate(band.from);\n    const y = band.config.topOffsetRatio * _models_props__WEBPACK_IMPORTED_MODULE_0__["default"].viewportHeight;\n    const height = band.config.heightRatio * _models_props__WEBPACK_IMPORTED_MODULE_0__["default"].viewportHeight;\n    const normalRulerDates = [];\n    const specialRulerDates = [];\n    while (date < band.to) {\n        if (isSpecialRuler(date, band))\n            specialRulerDates.push(date);\n        else\n            normalRulerDates.push(date);\n        date = band.nextDate(date);\n    }\n    ctx.beginPath();\n    ctx.font = smallFont;\n    ctx.fillStyle = `rgb(205, 205, 205)`;\n    for (const date of normalRulerDates) {\n        drawRuler(ctx, band, date, y, y + height);\n    }\n    ctx.strokeStyle = `rgb(235, 235, 235)`;\n    ctx.stroke();\n    ctx.beginPath();\n    ctx.font = bigFont;\n    ctx.fillStyle = `rgb(120, 120, 120)`;\n    for (const date of specialRulerDates) {\n        drawRuler(ctx, band, date, y, y + height);\n    }\n    ctx.strokeStyle = `rgb(150, 150, 150)`;\n    ctx.stroke();\n}\n\n\n//# sourceURL=webpack://Timeline/./src/views/canvas/rulers.ts?')},"./src/views/label.ts":
/*!****************************!*\
  !*** ./src/views/label.ts ***!
  \****************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Label; });\n/* harmony import */ var _utils_create_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/create-element */ \"./src/utils/create-element.ts\");\n\nclass Label {\n    constructor(band) {\n        this.band = band;\n    }\n    render() {\n        const wrapper = Object(_utils_create_element__WEBPACK_IMPORTED_MODULE_0__[\"default\"])('div', 'events-label-wrapper', [\n            'border-top: 1px solid #CCC',\n            'pointer-events: none',\n            'position: absolute',\n            'width: 100%',\n            'z-index: 3',\n        ], [\n            `top: ${this.band.config.topOffsetRatio * 100}%`\n        ]);\n        const eventsLabel = Object(_utils_create_element__WEBPACK_IMPORTED_MODULE_0__[\"default\"])('div', 'events-label', [\n            'background: white',\n            'border-bottom-right-radius: 4px',\n            'box-shadow: 1px 2px 4px #AAA',\n            'color: #444',\n            'display: inline-block',\n            'font-family: sans-serif',\n            'font-size: .8em',\n            'padding: 4px 8px',\n        ]);\n        eventsLabel.innerText = this.band.config.label;\n        wrapper.appendChild(eventsLabel);\n        return wrapper;\n    }\n    resize() {\n    }\n}\n\n\n//# sourceURL=webpack://Timeline/./src/views/label.ts?")}})})}])});